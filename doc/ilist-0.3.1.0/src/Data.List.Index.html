<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE
CPP,
MagicHash,
ScopedTypeVariables,
BangPatterns
  #-}</span><span>
</span><a name="line-7"></a><span>
</span><a name="line-8"></a><span>
</span><a name="line-9"></a><span class="hs-comment">{- |
Note: a lot of these functions are available for other types (in their respective packages):

  * @&lt;http://hackage.haskell.org/package/vector/docs/Data-Vector.html Data.Vector&gt;@ provides 'indexed' and lots of other functions beginning with &#8220;i&#8221;.

  * @&lt;http://hackage.haskell.org/package/containers/docs/Data-Map-Lazy.html Data.Map&gt;@ and @&lt;http://hackage.haskell.org/package/containers/docs/Data-Sequence.html Data.Sequence&gt;@ provide similar functions, but use a different naming convention (e.g. @&lt;http://hackage.haskell.org/package/containers/docs/Data-Map-Lazy.html#v:mapWithKey mapWithKey&gt;@ for maps and @&lt;http://hackage.haskell.org/package/containers/docs/Data-Sequence.html#v:foldrWithIndex foldrWithIndex&gt;@ for sequences).

  * &lt;http://hackage.haskell.org/package/lens lens&gt; provides several typeclasses for indexed functions that work on maps, lists, vectors, bytestrings, and so on (in @&lt;http://hackage.haskell.org/package/lens/docs/Control-Lens-Indexed.html Control.Lens.Indexed&gt;@), but unfortunately they are pretty slow for lists.
-}</span><span>
</span><a name="line-18"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">List</span><span class="hs-operator">.</span><span class="hs-identifier">Index</span><span>
</span><a name="line-19"></a><span class="hs-special">(</span><span>
</span><a name="line-20"></a><span>  </span><span class="hs-comment">-- * Original functions</span><span>
</span><a name="line-21"></a><span>  </span><a href="Data.List.Index.html#indexed"><span class="hs-identifier hs-var">indexed</span></a><span class="hs-special">,</span><span>
</span><a name="line-22"></a><span>  </span><a href="Data.List.Index.html#deleteAt"><span class="hs-identifier hs-var">deleteAt</span></a><span class="hs-special">,</span><span>
</span><a name="line-23"></a><span>  </span><a href="Data.List.Index.html#setAt"><span class="hs-identifier hs-var">setAt</span></a><span class="hs-special">,</span><span>
</span><a name="line-24"></a><span>  </span><a href="Data.List.Index.html#modifyAt"><span class="hs-identifier hs-var">modifyAt</span></a><span class="hs-special">,</span><span>
</span><a name="line-25"></a><span>  </span><a href="Data.List.Index.html#updateAt"><span class="hs-identifier hs-var">updateAt</span></a><span class="hs-special">,</span><span>
</span><a name="line-26"></a><span>  </span><a href="Data.List.Index.html#insertAt"><span class="hs-identifier hs-var">insertAt</span></a><span class="hs-special">,</span><span>
</span><a name="line-27"></a><span>
</span><a name="line-28"></a><span>  </span><span class="hs-comment">-- * Adapted functions from &quot;Data.List&quot;</span><span>
</span><a name="line-29"></a><span>  </span><span class="hs-comment">-- $adapted</span><span>
</span><a name="line-30"></a><span>
</span><a name="line-31"></a><span>  </span><span class="hs-comment">-- ** Maps</span><span>
</span><a name="line-32"></a><span>  </span><a href="Data.List.Index.html#imap"><span class="hs-identifier hs-var">imap</span></a><span class="hs-special">,</span><span>
</span><a name="line-33"></a><span>  </span><a href="Data.List.Index.html#imapM"><span class="hs-identifier hs-var">imapM</span></a><span class="hs-special">,</span><span> </span><a href="Data.List.Index.html#imapM_"><span class="hs-identifier hs-var">imapM_</span></a><span class="hs-special">,</span><span>
</span><a name="line-34"></a><span>  </span><a href="Data.List.Index.html#ifor"><span class="hs-identifier hs-var">ifor</span></a><span class="hs-special">,</span><span> </span><a href="Data.List.Index.html#ifor_"><span class="hs-identifier hs-var">ifor_</span></a><span class="hs-special">,</span><span>
</span><a name="line-35"></a><span>  </span><span class="hs-comment">-- ** Folds</span><span>
</span><a name="line-36"></a><span>  </span><a href="Data.List.Index.html#ifoldr"><span class="hs-identifier hs-var">ifoldr</span></a><span class="hs-special">,</span><span> </span><a href="Data.List.Index.html#ifoldl"><span class="hs-identifier hs-var">ifoldl</span></a><span class="hs-special">,</span><span> </span><a href="Data.List.Index.html#ifoldl%27"><span class="hs-identifier hs-var">ifoldl'</span></a><span class="hs-special">,</span><span>
</span><a name="line-37"></a><span>  </span><a href="Data.List.Index.html#iall"><span class="hs-identifier hs-var">iall</span></a><span class="hs-special">,</span><span> </span><a href="Data.List.Index.html#iany"><span class="hs-identifier hs-var">iany</span></a><span class="hs-special">,</span><span> </span><a href="Data.List.Index.html#iconcatMap"><span class="hs-identifier hs-var">iconcatMap</span></a><span class="hs-special">,</span><span>
</span><a name="line-38"></a><span>  </span><span class="hs-comment">-- ** Sublists</span><span>
</span><a name="line-39"></a><span>  </span><a href="Data.List.Index.html#ifilter"><span class="hs-identifier hs-var">ifilter</span></a><span class="hs-special">,</span><span> </span><a href="Data.List.Index.html#ipartition"><span class="hs-identifier hs-var">ipartition</span></a><span class="hs-special">,</span><span>
</span><a name="line-40"></a><span>  </span><a href="Data.List.Index.html#itakeWhile"><span class="hs-identifier hs-var">itakeWhile</span></a><span class="hs-special">,</span><span> </span><a href="Data.List.Index.html#idropWhile"><span class="hs-identifier hs-var">idropWhile</span></a><span class="hs-special">,</span><span>
</span><a name="line-41"></a><span>  </span><span class="hs-comment">-- ** Zipping</span><span>
</span><a name="line-42"></a><span>  </span><a href="Data.List.Index.html#izipWith"><span class="hs-identifier hs-var">izipWith</span></a><span class="hs-special">,</span><span>
</span><a name="line-43"></a><span>  </span><a href="Data.List.Index.html#izipWithM"><span class="hs-identifier hs-var">izipWithM</span></a><span class="hs-special">,</span><span> </span><a href="Data.List.Index.html#izipWithM_"><span class="hs-identifier hs-var">izipWithM_</span></a><span class="hs-special">,</span><span>
</span><a name="line-44"></a><span>  </span><span class="hs-comment">-- ** Search</span><span>
</span><a name="line-45"></a><span>  </span><a href="Data.List.Index.html#ifind"><span class="hs-identifier hs-var">ifind</span></a><span class="hs-special">,</span><span>
</span><a name="line-46"></a><span>  </span><a href="Data.List.Index.html#ifindIndex"><span class="hs-identifier hs-var">ifindIndex</span></a><span class="hs-special">,</span><span>
</span><a name="line-47"></a><span>  </span><a href="Data.List.Index.html#ifindIndices"><span class="hs-identifier hs-var">ifindIndices</span></a><span class="hs-special">,</span><span>
</span><a name="line-48"></a><span>
</span><a name="line-49"></a><span>  </span><span class="hs-comment">-- * Less commonly used functions</span><span>
</span><a name="line-50"></a><span>
</span><a name="line-51"></a><span>  </span><span class="hs-comment">-- ** Zipping</span><span>
</span><a name="line-52"></a><span>  </span><a href="Data.List.Index.html#izipWith3"><span class="hs-identifier hs-var">izipWith3</span></a><span class="hs-special">,</span><span>
</span><a name="line-53"></a><span>  </span><a href="Data.List.Index.html#izipWith4"><span class="hs-identifier hs-var">izipWith4</span></a><span class="hs-special">,</span><span>
</span><a name="line-54"></a><span>  </span><a href="Data.List.Index.html#izipWith5"><span class="hs-identifier hs-var">izipWith5</span></a><span class="hs-special">,</span><span>
</span><a name="line-55"></a><span>  </span><a href="Data.List.Index.html#izipWith6"><span class="hs-identifier hs-var">izipWith6</span></a><span class="hs-special">,</span><span>
</span><a name="line-56"></a><span>  </span><a href="Data.List.Index.html#izipWith7"><span class="hs-identifier hs-var">izipWith7</span></a><span class="hs-special">,</span><span>
</span><a name="line-57"></a><span>
</span><a name="line-58"></a><span>  </span><span class="hs-comment">-- ** Monadic functions</span><span>
</span><a name="line-59"></a><span>  </span><a href="Data.List.Index.html#iforM"><span class="hs-identifier hs-var">iforM</span></a><span class="hs-special">,</span><span> </span><a href="Data.List.Index.html#iforM_"><span class="hs-identifier hs-var">iforM_</span></a><span class="hs-special">,</span><span>
</span><a name="line-60"></a><span>  </span><a href="Data.List.Index.html#itraverse"><span class="hs-identifier hs-var">itraverse</span></a><span class="hs-special">,</span><span> </span><a href="Data.List.Index.html#itraverse_"><span class="hs-identifier hs-var">itraverse_</span></a><span class="hs-special">,</span><span>
</span><a name="line-61"></a><span>  </span><a href="Data.List.Index.html#ireplicateM"><span class="hs-identifier hs-var">ireplicateM</span></a><span class="hs-special">,</span><span> </span><a href="Data.List.Index.html#ireplicateM_"><span class="hs-identifier hs-var">ireplicateM_</span></a><span class="hs-special">,</span><span>
</span><a name="line-62"></a><span>  </span><a href="Data.List.Index.html#ifoldrM"><span class="hs-identifier hs-var">ifoldrM</span></a><span class="hs-special">,</span><span>
</span><a name="line-63"></a><span>  </span><a href="Data.List.Index.html#ifoldlM"><span class="hs-identifier hs-var">ifoldlM</span></a><span class="hs-special">,</span><span>
</span><a name="line-64"></a><span>  </span><span>
</span><a name="line-65"></a><span>  </span><span class="hs-comment">-- ** Folds</span><span>
</span><a name="line-66"></a><span>  </span><a href="Data.List.Index.html#ifoldMap"><span class="hs-identifier hs-var">ifoldMap</span></a><span class="hs-special">,</span><span>
</span><a name="line-67"></a><span>  </span><a href="Data.List.Index.html#imapAccumR"><span class="hs-identifier hs-var">imapAccumR</span></a><span class="hs-special">,</span><span>
</span><a name="line-68"></a><span>  </span><a href="Data.List.Index.html#imapAccumL"><span class="hs-identifier hs-var">imapAccumL</span></a><span class="hs-special">,</span><span>
</span><a name="line-69"></a><span class="hs-special">)</span><span>
</span><a name="line-70"></a><span class="hs-keyword">where</span><span>
</span><a name="line-71"></a><span>
</span><a name="line-72"></a><span>
</span><a name="line-73"></a><span class="hs-cpp">#if __GLASGOW_HASKELL__ &gt;= 710</span><span>
</span><a name="line-74"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">GHC</span><span class="hs-operator">.</span><span class="hs-identifier">Base</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">oneShot</span><span class="hs-special">)</span><span>
</span><a name="line-75"></a><span class="hs-cpp">#define ONE_SHOT oneShot</span><span>
</span><a name="line-76"></a><span class="hs-cpp">#else</span><span>
</span><a name="line-77"></a><span class="hs-cpp">#define ONE_SHOT</span><span>
</span><a name="line-78"></a><span class="hs-cpp">#endif</span><span>
</span><a name="line-79"></a><span>
</span><a name="line-80"></a><span class="hs-cpp">#if __GLASGOW_HASKELL__ &lt; 710</span><span>
</span><a name="line-81"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control</span><span class="hs-operator">.</span><span class="hs-identifier">Applicative</span><span>
</span><a name="line-82"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Traversable</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">sequenceA</span><span class="hs-special">)</span><span>
</span><a name="line-83"></a><span class="hs-cpp">#endif</span><span>
</span><a name="line-84"></a><span>
</span><a name="line-85"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Foldable</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">sequenceA_</span><span class="hs-special">)</span><span>
</span><a name="line-86"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Maybe</span><span>
</span><a name="line-87"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Monoid</span><span>
</span><a name="line-88"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">GHC</span><span class="hs-operator">.</span><span class="hs-identifier">Exts</span><span>
</span><a name="line-89"></a><span>
</span><a name="line-90"></a><span class="hs-comment">{- Left to do:

Functions
~~~~~~~~~

alterF or something?

iscanl
iscanl'
iscanl1
iscanr
iscanr1

iiterate?

backpermute?
minIndex/maxIndex?
-}</span><span>
</span><a name="line-108"></a><span>
</span><a name="line-109"></a><span class="hs-comment">{- |
'indexed' pairs each element with its index.

&gt;&gt;&gt; indexed &quot;hello&quot;
[(0,'h'),(1,'e'),(2,'l'),(3,'l'),(4,'o')]

/Subject to fusion./
-}</span><span>
</span><a name="line-117"></a><span class="hs-identifier">indexed</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679020941"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Int</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679020941"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-118"></a><a name="indexed"><a href="Data.List.Index.html#indexed"><span class="hs-identifier">indexed</span></a></a><span> </span><a name="local-6989586621679020942"><a href="#local-6989586621679020942"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679020943"><span class="hs-identifier hs-var">go</span></a><span> </span><span class="hs-number">0</span><span class="hs-operator">#</span><span> </span><a href="#local-6989586621679020942"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-119"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-120"></a><span>    </span><a name="local-6989586621679020943"><a href="#local-6989586621679020943"><span class="hs-identifier">go</span></a></a><span> </span><a name="local-6989586621679020944"><a href="#local-6989586621679020944"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679020945"><a href="#local-6989586621679020945"><span class="hs-identifier">a</span></a></a><span class="hs-glyph">:</span><span class="hs-keyword">as</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">I</span><span class="hs-operator hs-var">#</span><span> </span><a href="#local-6989586621679020944"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679020945"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679020943"><span class="hs-identifier hs-var">go</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679020944"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-operator hs-var">+#</span><span> </span><span class="hs-number">1</span><span class="hs-operator">#</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">as</span><span>
</span><a name="line-121"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-122"></a><span class="hs-pragma">{-# NOINLINE [1] indexed #-}</span><span>
</span><a name="line-123"></a><span>
</span><a name="line-124"></a><span class="hs-identifier">indexedFB</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Int</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679020939"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679020940"><span class="hs-identifier hs-type">t</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679020940"><span class="hs-identifier hs-type">t</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679020939"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Int</span><span class="hs-operator hs-type">#</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679020940"><span class="hs-identifier hs-type">t</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span class="hs-operator hs-type">#</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679020940"><span class="hs-identifier hs-type">t</span></a><span>
</span><a name="line-125"></a><a name="indexedFB"><a href="Data.List.Index.html#indexedFB"><span class="hs-identifier">indexedFB</span></a></a><span> </span><a name="local-6989586621679020947"><a href="#local-6989586621679020947"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679020948"><a href="#local-6989586621679020948"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679020949"><a href="#local-6989586621679020949"><span class="hs-identifier">cont</span></a></a><span> </span><a name="local-6989586621679020950"><a href="#local-6989586621679020950"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">I</span><span class="hs-operator hs-var">#</span><span> </span><a href="#local-6989586621679020950"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679020948"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">`</span><a href="#local-6989586621679020947"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679020949"><span class="hs-identifier hs-var">cont</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679020950"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-operator hs-var">+#</span><span> </span><span class="hs-number">1</span><span class="hs-operator">#</span><span class="hs-special">)</span><span>
</span><a name="line-126"></a><span class="hs-pragma">{-# INLINE [0] indexedFB #-}</span><span>
</span><a name="line-127"></a><span>
</span><a name="line-128"></a><span class="hs-pragma">{-# RULES
&quot;indexed&quot;       [~1] forall xs.    indexed xs = build (\c n -&gt; foldr (indexedFB c) (\_ -&gt; n) xs 0#)
&quot;indexedList&quot;   [1]  forall xs.    foldr (indexedFB (:)) (\_ -&gt; []) xs 0# = indexed xs
  #-}</span><span>
</span><a name="line-132"></a><span>
</span><a name="line-133"></a><span class="hs-comment">{- |
'deleteAt' deletes the element at an index.

If the index is negative or exceeds list length, the original list will be returned.
-}</span><span>
</span><a name="line-138"></a><span class="hs-identifier">deleteAt</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679020938"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679020938"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-139"></a><a name="deleteAt"><a href="Data.List.Index.html#deleteAt"><span class="hs-identifier">deleteAt</span></a></a><span> </span><a name="local-6989586621679020951"><a href="#local-6989586621679020951"><span class="hs-identifier">i</span></a></a><span> </span><a name="local-6989586621679020952"><a href="#local-6989586621679020952"><span class="hs-identifier">ls</span></a></a><span>
</span><a name="line-140"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679020951"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-operator hs-var">&lt;</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679020952"><span class="hs-identifier hs-var">ls</span></a><span>
</span><a name="line-141"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679020953"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679020951"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="#local-6989586621679020952"><span class="hs-identifier hs-var">ls</span></a><span>
</span><a name="line-142"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-143"></a><span>    </span><a name="local-6989586621679020953"><a href="#local-6989586621679020953"><span class="hs-identifier">go</span></a></a><span> </span><span class="hs-number">0</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-glyph">:</span><a name="local-6989586621679020954"><a href="#local-6989586621679020954"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679020954"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-144"></a><span>    </span><span class="hs-identifier">go</span><span> </span><a name="local-6989586621679020955"><a href="#local-6989586621679020955"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679020956"><a href="#local-6989586621679020956"><span class="hs-identifier">x</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679020957"><a href="#local-6989586621679020957"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679020956"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679020953"><span class="hs-identifier hs-var">go</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679020955"><span class="hs-identifier hs-var">n</span></a><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679020957"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-145"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-146"></a><span class="hs-pragma">{-# INLINE deleteAt #-}</span><span>
</span><a name="line-147"></a><span>
</span><a name="line-148"></a><span class="hs-comment">{- |
'setAt' sets the element at the index.

If the index is negative or exceeds list length, the original list will be returned.
-}</span><span>
</span><a name="line-153"></a><span class="hs-identifier">setAt</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679020937"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679020937"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679020937"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-154"></a><a name="setAt"><a href="Data.List.Index.html#setAt"><span class="hs-identifier">setAt</span></a></a><span> </span><a name="local-6989586621679024919"><a href="#local-6989586621679024919"><span class="hs-identifier">i</span></a></a><span> </span><a name="local-6989586621679024920"><a href="#local-6989586621679024920"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679024921"><a href="#local-6989586621679024921"><span class="hs-identifier">ls</span></a></a><span>
</span><a name="line-155"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679024919"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-operator hs-var">&lt;</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679024921"><span class="hs-identifier hs-var">ls</span></a><span>
</span><a name="line-156"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679024922"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679024919"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="#local-6989586621679024921"><span class="hs-identifier hs-var">ls</span></a><span>
</span><a name="line-157"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-158"></a><span>    </span><a name="local-6989586621679024922"><a href="#local-6989586621679024922"><span class="hs-identifier">go</span></a></a><span> </span><span class="hs-number">0</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-glyph">:</span><a name="local-6989586621679024923"><a href="#local-6989586621679024923"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679024920"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679024923"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-159"></a><span>    </span><span class="hs-identifier">go</span><span> </span><a name="local-6989586621679024924"><a href="#local-6989586621679024924"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679024925"><a href="#local-6989586621679024925"><span class="hs-identifier">x</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679024926"><a href="#local-6989586621679024926"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679024925"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679024922"><span class="hs-identifier hs-var">go</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679024924"><span class="hs-identifier hs-var">n</span></a><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679024926"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-160"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-161"></a><span class="hs-pragma">{-# INLINE setAt #-}</span><span>
</span><a name="line-162"></a><span>
</span><a name="line-163"></a><span class="hs-comment">{- |
'modifyAt' applies a function to the element at the index.

If the index is negative or exceeds list length, the original list will be returned.
-}</span><span>
</span><a name="line-168"></a><span class="hs-identifier">modifyAt</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679020936"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679020936"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679020936"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679020936"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-169"></a><a name="modifyAt"><a href="Data.List.Index.html#modifyAt"><span class="hs-identifier">modifyAt</span></a></a><span> </span><a name="local-6989586621679024927"><a href="#local-6989586621679024927"><span class="hs-identifier">i</span></a></a><span> </span><a name="local-6989586621679024928"><a href="#local-6989586621679024928"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679024929"><a href="#local-6989586621679024929"><span class="hs-identifier">ls</span></a></a><span>
</span><a name="line-170"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679024927"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-operator hs-var">&lt;</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679024929"><span class="hs-identifier hs-var">ls</span></a><span>
</span><a name="line-171"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679024930"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679024927"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="#local-6989586621679024929"><span class="hs-identifier hs-var">ls</span></a><span>
</span><a name="line-172"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-173"></a><span>    </span><a name="local-6989586621679024930"><a href="#local-6989586621679024930"><span class="hs-identifier">go</span></a></a><span> </span><span class="hs-number">0</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679024931"><a href="#local-6989586621679024931"><span class="hs-identifier">x</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679024932"><a href="#local-6989586621679024932"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679024928"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679024931"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679024932"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-174"></a><span>    </span><span class="hs-identifier">go</span><span> </span><a name="local-6989586621679024933"><a href="#local-6989586621679024933"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679024934"><a href="#local-6989586621679024934"><span class="hs-identifier">x</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679024935"><a href="#local-6989586621679024935"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679024934"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679024930"><span class="hs-identifier hs-var">go</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679024933"><span class="hs-identifier hs-var">n</span></a><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679024935"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-175"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-176"></a><span class="hs-pragma">{-# INLINE modifyAt #-}</span><span>
</span><a name="line-177"></a><span>
</span><a name="line-178"></a><span class="hs-comment">{- |
'updateAt' applies a function to the element at the index, and then either replaces the element or deletes it (if the function has returned 'Nothing').

If the index is negative or exceeds list length, the original list will be returned.
-}</span><span>
</span><a name="line-183"></a><span class="hs-identifier">updateAt</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679020935"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621679020935"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679020935"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679020935"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-184"></a><a name="updateAt"><a href="Data.List.Index.html#updateAt"><span class="hs-identifier">updateAt</span></a></a><span> </span><a name="local-6989586621679024936"><a href="#local-6989586621679024936"><span class="hs-identifier">i</span></a></a><span> </span><a name="local-6989586621679024937"><a href="#local-6989586621679024937"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679024938"><a href="#local-6989586621679024938"><span class="hs-identifier">ls</span></a></a><span>
</span><a name="line-185"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679024936"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-operator hs-var">&lt;</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679024938"><span class="hs-identifier hs-var">ls</span></a><span>
</span><a name="line-186"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679024939"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679024936"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="#local-6989586621679024938"><span class="hs-identifier hs-var">ls</span></a><span>
</span><a name="line-187"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-188"></a><span>    </span><a name="local-6989586621679024939"><a href="#local-6989586621679024939"><span class="hs-identifier">go</span></a></a><span> </span><span class="hs-number">0</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679024940"><a href="#local-6989586621679024940"><span class="hs-identifier">x</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679024941"><a href="#local-6989586621679024941"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679024937"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679024940"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-189"></a><span>      </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679024941"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-190"></a><span>      </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679024942"><a href="#local-6989586621679024942"><span class="hs-identifier">x'</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679024942"><span class="hs-identifier hs-var">x'</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679024941"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-191"></a><span>    </span><span class="hs-identifier">go</span><span> </span><a name="local-6989586621679024943"><a href="#local-6989586621679024943"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679024944"><a href="#local-6989586621679024944"><span class="hs-identifier">x</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679024945"><a href="#local-6989586621679024945"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679024944"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679024939"><span class="hs-identifier hs-var">go</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679024943"><span class="hs-identifier hs-var">n</span></a><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679024945"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-192"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-193"></a><span class="hs-pragma">{-# INLINE updateAt #-}</span><span>
</span><a name="line-194"></a><span>
</span><a name="line-195"></a><span class="hs-comment">{- |
'insertAt' inserts an element at the given position:

@
(insertAt i x xs) !! i == x
@

If the index is negative or exceeds list length, the original list will be returned. (If the index is equal to the list length, the insertion can be carried out.)
-}</span><span>
</span><a name="line-204"></a><span class="hs-identifier">insertAt</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679020934"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679020934"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679020934"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-205"></a><a name="insertAt"><a href="Data.List.Index.html#insertAt"><span class="hs-identifier">insertAt</span></a></a><span> </span><a name="local-6989586621679024946"><a href="#local-6989586621679024946"><span class="hs-identifier">i</span></a></a><span> </span><a name="local-6989586621679024947"><a href="#local-6989586621679024947"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679024948"><a href="#local-6989586621679024948"><span class="hs-identifier">ls</span></a></a><span>
</span><a name="line-206"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679024946"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-operator hs-var">&lt;</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679024948"><span class="hs-identifier hs-var">ls</span></a><span>
</span><a name="line-207"></a><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679024949"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679024946"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="#local-6989586621679024948"><span class="hs-identifier hs-var">ls</span></a><span>
</span><a name="line-208"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-209"></a><span>    </span><a name="local-6989586621679024949"><a href="#local-6989586621679024949"><span class="hs-identifier">go</span></a></a><span> </span><span class="hs-number">0</span><span> </span><a name="local-6989586621679024950"><a href="#local-6989586621679024950"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679024947"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679024950"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-210"></a><span>    </span><span class="hs-identifier">go</span><span> </span><a name="local-6989586621679024951"><a href="#local-6989586621679024951"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679024952"><a href="#local-6989586621679024952"><span class="hs-identifier">x</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679024953"><a href="#local-6989586621679024953"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679024952"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679024949"><span class="hs-identifier hs-var">go</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679024951"><span class="hs-identifier hs-var">n</span></a><span class="hs-glyph">-</span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679024953"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-211"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-212"></a><span class="hs-pragma">{-# INLINE insertAt #-}</span><span>
</span><a name="line-213"></a><span>
</span><a name="line-214"></a><span class="hs-comment">{-

David Feuer says that drop-like functions tend to have problems when implemented with folds: &lt;http://ircbrowse.net/browse/haskell?id=22794495&amp;timestamp=1463607633#t1463607633&gt;. I haven't been able to observe this, but since Data.List defines drop/dropWhile/etc that don't fuse, let's do it here as well &#8211; just in case. The original version (that does fuse) is below.

-- The plan is that if it does inline, it'll be fast; and if it doesn't
-- inline, the former definition will be used and sharing will be preserved
-- (i.e. if i == 0, it won't rebuild the whole list).
deleteAtFB :: Int -&gt; (a -&gt; t -&gt; t) -&gt; a -&gt; (Int# -&gt; t) -&gt; Int# -&gt; t
deleteAtFB (I# i) c = \x r k -&gt;
  case k ==# i of
    0# -&gt; x `c` r (k +# 1#)
    _  -&gt; r (k +# 1#)
{-# INLINE [0] deleteAtFB #-}

{-# RULES
&quot;deleteAt&quot;       [~1] forall i xs.    deleteAt i xs = build (\c n -&gt; foldr (deleteAtFB i c) (\_ -&gt; n) xs 0#)
&quot;deleteAtList&quot;   [1]  forall i xs.    foldr (deleteAtFB i (:)) (\_ -&gt; []) xs 0# = deleteAt i xs
  #-}

-}</span><span>
</span><a name="line-234"></a><span>
</span><a name="line-235"></a><span class="hs-comment">{- $adapted

These functions mimic their counterparts in &quot;Data.List&quot; &#8211; 'imap', for instance, works like 'map' but gives the index of the element to the modifying function.

Note that left folds have the index argument /after/ the accumulator argument &#8211; that's the convention adopted by containers and vector (but not lens).
-}</span><span>
</span><a name="line-241"></a><span>
</span><a name="line-242"></a><span class="hs-comment">{- |
/Subject to fusion./
-}</span><span>
</span><a name="line-245"></a><span class="hs-identifier">imap</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679020932"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679020933"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679020932"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679020933"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">]</span><span>
</span><a name="line-246"></a><a name="imap"><a href="Data.List.Index.html#imap"><span class="hs-identifier">imap</span></a></a><span> </span><a name="local-6989586621679024954"><a href="#local-6989586621679024954"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679024955"><a href="#local-6989586621679024955"><span class="hs-identifier">ls</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679024956"><span class="hs-identifier hs-var">go</span></a><span> </span><span class="hs-number">0</span><span class="hs-operator">#</span><span> </span><a href="#local-6989586621679024955"><span class="hs-identifier hs-var">ls</span></a><span>
</span><a name="line-247"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-248"></a><span>    </span><a name="local-6989586621679024956"><a href="#local-6989586621679024956"><span class="hs-identifier">go</span></a></a><span> </span><a name="local-6989586621679024957"><a href="#local-6989586621679024957"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679024958"><a href="#local-6989586621679024958"><span class="hs-identifier">x</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679024959"><a href="#local-6989586621679024959"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679024954"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">I</span><span class="hs-operator hs-var">#</span><span> </span><a href="#local-6989586621679024957"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679024958"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679024956"><span class="hs-identifier hs-var">go</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679024957"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-operator hs-var">+#</span><span> </span><span class="hs-number">1</span><span class="hs-operator">#</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679024959"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-249"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-250"></a><span class="hs-pragma">{-# NOINLINE [1] imap #-}</span><span>
</span><a name="line-251"></a><span>
</span><a name="line-252"></a><span class="hs-identifier">imapFB</span><span>
</span><a name="line-253"></a><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679020929"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679020930"><span class="hs-identifier hs-type">t</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679020930"><span class="hs-identifier hs-type">t</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679020931"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679020929"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679020931"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Int</span><span class="hs-operator hs-type">#</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679020930"><span class="hs-identifier hs-type">t</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span class="hs-operator hs-type">#</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679020930"><span class="hs-identifier hs-type">t</span></a><span>
</span><a name="line-254"></a><a name="imapFB"><a href="Data.List.Index.html#imapFB"><span class="hs-identifier">imapFB</span></a></a><span> </span><a name="local-6989586621679024960"><a href="#local-6989586621679024960"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679024961"><a href="#local-6989586621679024961"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679024962"><a href="#local-6989586621679024962"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679024963"><a href="#local-6989586621679024963"><span class="hs-identifier">r</span></a></a><span> </span><a name="local-6989586621679024964"><a href="#local-6989586621679024964"><span class="hs-identifier">k</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679024961"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">I</span><span class="hs-operator hs-var">#</span><span> </span><a href="#local-6989586621679024964"><span class="hs-identifier hs-var">k</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679024962"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">`</span><a href="#local-6989586621679024960"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679024963"><span class="hs-identifier hs-var">r</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679024964"><span class="hs-identifier hs-var">k</span></a><span> </span><span class="hs-operator hs-var">+#</span><span> </span><span class="hs-number">1</span><span class="hs-operator">#</span><span class="hs-special">)</span><span>
</span><a name="line-255"></a><span class="hs-pragma">{-# INLINE [0] imapFB #-}</span><span>
</span><a name="line-256"></a><span>
</span><a name="line-257"></a><span class="hs-pragma">{-# RULES
&quot;imap&quot;       [~1] forall f xs.    imap f xs = build (\c n -&gt; foldr (imapFB c f) (\_ -&gt; n) xs 0#)
&quot;imapList&quot;   [1]  forall f xs.    foldr (imapFB (:) f) (\_ -&gt; []) xs 0# = imap f xs
  #-}</span><span>
</span><a name="line-261"></a><span>
</span><a name="line-262"></a><span class="hs-comment">{-
Note: we don't apply the *FB transformation to 'iconcatMap' because it uses 'ifoldr' instead of 'foldr', and 'ifoldr' might get inlined itself, and rewriting 'iconcatMap' with 'foldr' instead of 'ifoldr' is annoying. So, in theory it's a small optimisation possibility (in practice I'm not so sure, given that functions with 'build' don't seem to perform worse than functions without it).
-}</span><span>
</span><a name="line-265"></a><span class="hs-identifier">iconcatMap</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679020927"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679020928"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679020927"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679020928"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">]</span><span>
</span><a name="line-266"></a><a name="iconcatMap"><a href="Data.List.Index.html#iconcatMap"><span class="hs-identifier">iconcatMap</span></a></a><span> </span><a name="local-6989586621679024965"><a href="#local-6989586621679024965"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679024966"><a href="#local-6989586621679024966"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">build</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679024967"><a href="#local-6989586621679024967"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679024968"><a href="#local-6989586621679024968"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-267"></a><span>  </span><a href="Data.List.Index.html#ifoldr"><span class="hs-identifier hs-var">ifoldr</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679024969"><a href="#local-6989586621679024969"><span class="hs-identifier">i</span></a></a><span> </span><a name="local-6989586621679024970"><a href="#local-6989586621679024970"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679024971"><a href="#local-6989586621679024971"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">foldr</span><span> </span><a href="#local-6989586621679024967"><span class="hs-identifier hs-var">c</span></a><span> </span><a href="#local-6989586621679024971"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679024965"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679024969"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="#local-6989586621679024970"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679024968"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621679024966"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-268"></a><span class="hs-pragma">{-# INLINE iconcatMap #-}</span><span>
</span><a name="line-269"></a><span>
</span><a name="line-270"></a><span class="hs-identifier">ifoldMap</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Monoid</span><span> </span><a href="#local-6989586621679020925"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679020926"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679020925"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679020926"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679020925"><span class="hs-identifier hs-type">m</span></a><span>
</span><a name="line-271"></a><a name="ifoldMap"><a href="Data.List.Index.html#ifoldMap"><span class="hs-identifier">ifoldMap</span></a></a><span> </span><a name="local-6989586621679024972"><a href="#local-6989586621679024972"><span class="hs-identifier">p</span></a></a><span> </span><a name="local-6989586621679024973"><a href="#local-6989586621679024973"><span class="hs-identifier">ls</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">foldr</span><span> </span><a href="#local-6989586621679024974"><span class="hs-identifier hs-var">go</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">mempty</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679024973"><span class="hs-identifier hs-var">ls</span></a><span> </span><span class="hs-number">0</span><span class="hs-operator">#</span><span>
</span><a name="line-272"></a><span>  </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679024974"><a href="#local-6989586621679024974"><span class="hs-identifier">go</span></a></a><span> </span><a name="local-6989586621679024975"><a href="#local-6989586621679024975"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679024976"><a href="#local-6989586621679024976"><span class="hs-identifier">r</span></a></a><span> </span><a name="local-6989586621679024977"><a href="#local-6989586621679024977"><span class="hs-identifier">k</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679024972"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">I</span><span class="hs-operator hs-var">#</span><span> </span><a href="#local-6989586621679024977"><span class="hs-identifier hs-var">k</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679024975"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><a href="#local-6989586621679024976"><span class="hs-identifier hs-var">r</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679024977"><span class="hs-identifier hs-var">k</span></a><span> </span><span class="hs-operator hs-var">+#</span><span> </span><span class="hs-number">1</span><span class="hs-operator">#</span><span class="hs-special">)</span><span>
</span><a name="line-273"></a><span class="hs-pragma">{-# INLINE ifoldMap #-}</span><span>
</span><a name="line-274"></a><span>
</span><a name="line-275"></a><span class="hs-comment">{- |
/Subject to fusion./
-}</span><span>
</span><a name="line-278"></a><span class="hs-identifier">iall</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679020924"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679020924"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-279"></a><a name="iall"><a href="Data.List.Index.html#iall"><span class="hs-identifier">iall</span></a></a><span> </span><a name="local-6989586621679024978"><a href="#local-6989586621679024978"><span class="hs-identifier">p</span></a></a><span> </span><a name="local-6989586621679024979"><a href="#local-6989586621679024979"><span class="hs-identifier">ls</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">foldr</span><span> </span><a href="#local-6989586621679024980"><span class="hs-identifier hs-var">go</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">True</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679024979"><span class="hs-identifier hs-var">ls</span></a><span> </span><span class="hs-number">0</span><span class="hs-operator">#</span><span>
</span><a name="line-280"></a><span>  </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679024980"><a href="#local-6989586621679024980"><span class="hs-identifier">go</span></a></a><span> </span><a name="local-6989586621679024981"><a href="#local-6989586621679024981"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679024982"><a href="#local-6989586621679024982"><span class="hs-identifier">r</span></a></a><span> </span><a name="local-6989586621679024983"><a href="#local-6989586621679024983"><span class="hs-identifier">k</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679024978"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">I</span><span class="hs-operator hs-var">#</span><span> </span><a href="#local-6989586621679024983"><span class="hs-identifier hs-var">k</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679024981"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><a href="#local-6989586621679024982"><span class="hs-identifier hs-var">r</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679024983"><span class="hs-identifier hs-var">k</span></a><span> </span><span class="hs-operator hs-var">+#</span><span> </span><span class="hs-number">1</span><span class="hs-operator">#</span><span class="hs-special">)</span><span>
</span><a name="line-281"></a><span class="hs-pragma">{-# INLINE iall #-}</span><span>
</span><a name="line-282"></a><span>
</span><a name="line-283"></a><span class="hs-comment">{- |
/Subject to fusion./
-}</span><span>
</span><a name="line-286"></a><span class="hs-identifier">iany</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679020923"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679020923"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-287"></a><a name="iany"><a href="Data.List.Index.html#iany"><span class="hs-identifier">iany</span></a></a><span> </span><a name="local-6989586621679024984"><a href="#local-6989586621679024984"><span class="hs-identifier">p</span></a></a><span> </span><a name="local-6989586621679024985"><a href="#local-6989586621679024985"><span class="hs-identifier">ls</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">foldr</span><span> </span><a href="#local-6989586621679024986"><span class="hs-identifier hs-var">go</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">False</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679024985"><span class="hs-identifier hs-var">ls</span></a><span> </span><span class="hs-number">0</span><span class="hs-operator">#</span><span>
</span><a name="line-288"></a><span>  </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679024986"><a href="#local-6989586621679024986"><span class="hs-identifier">go</span></a></a><span> </span><a name="local-6989586621679024987"><a href="#local-6989586621679024987"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679024988"><a href="#local-6989586621679024988"><span class="hs-identifier">r</span></a></a><span> </span><a name="local-6989586621679024989"><a href="#local-6989586621679024989"><span class="hs-identifier">k</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679024984"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">I</span><span class="hs-operator hs-var">#</span><span> </span><a href="#local-6989586621679024989"><span class="hs-identifier hs-var">k</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679024987"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">||</span><span> </span><a href="#local-6989586621679024988"><span class="hs-identifier hs-var">r</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679024989"><span class="hs-identifier hs-var">k</span></a><span> </span><span class="hs-operator hs-var">+#</span><span> </span><span class="hs-number">1</span><span class="hs-operator">#</span><span class="hs-special">)</span><span>
</span><a name="line-289"></a><span class="hs-pragma">{-# INLINE iany #-}</span><span>
</span><a name="line-290"></a><span>
</span><a name="line-291"></a><span class="hs-identifier">imapM</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="#local-6989586621679020920"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679020921"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679020920"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679020922"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679020921"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679020920"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679020922"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">]</span><span>
</span><a name="line-292"></a><a name="imapM"><a href="Data.List.Index.html#imapM"><span class="hs-identifier">imapM</span></a></a><span> </span><a name="local-6989586621679024990"><a href="#local-6989586621679024990"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.List.Index.html#ifoldr"><span class="hs-identifier hs-var">ifoldr</span></a><span> </span><a href="#local-6989586621679024992"><span class="hs-identifier hs-var">k</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">as</span><span>
</span><a name="line-293"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-294"></a><span>    </span><a name="local-6989586621679024992"><a href="#local-6989586621679024992"><span class="hs-identifier">k</span></a></a><span> </span><a name="local-6989586621679024993"><a href="#local-6989586621679024993"><span class="hs-identifier">i</span></a></a><span> </span><a name="local-6989586621679024994"><a href="#local-6989586621679024994"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679024995"><a href="#local-6989586621679024995"><span class="hs-identifier">r</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-295"></a><span>      </span><a name="local-6989586621679024996"><a href="#local-6989586621679024996"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679024990"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679024993"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="#local-6989586621679024994"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-296"></a><span>      </span><a name="local-6989586621679024997"><a href="#local-6989586621679024997"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679024995"><span class="hs-identifier hs-var">r</span></a><span>
</span><a name="line-297"></a><span>      </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679024996"><span class="hs-identifier hs-var">x</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679024997"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">)</span><span>
</span><a name="line-298"></a><span class="hs-pragma">{-# INLINE imapM #-}</span><span>
</span><a name="line-299"></a><span>
</span><a name="line-300"></a><span class="hs-identifier">iforM</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="#local-6989586621679020917"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679020918"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679020918"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679020917"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679020919"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679020917"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679020919"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">]</span><span>
</span><a name="line-301"></a><a name="iforM"><a href="Data.List.Index.html#iforM"><span class="hs-identifier">iforM</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">flip</span><span> </span><a href="Data.List.Index.html#imapM"><span class="hs-identifier hs-var">imapM</span></a><span>
</span><a name="line-302"></a><span class="hs-pragma">{-# INLINE iforM #-}</span><span>
</span><a name="line-303"></a><span>
</span><a name="line-304"></a><span class="hs-identifier">itraverse</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Applicative</span><span> </span><a href="#local-6989586621679020914"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679020915"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679020914"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679020916"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679020915"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679020914"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679020916"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">]</span><span>
</span><a name="line-305"></a><a name="itraverse"><a href="Data.List.Index.html#itraverse"><span class="hs-identifier">itraverse</span></a></a><span> </span><a name="local-6989586621679024998"><a href="#local-6989586621679024998"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.List.Index.html#ifoldr"><span class="hs-identifier hs-var">ifoldr</span></a><span> </span><a href="#local-6989586621679025000"><span class="hs-identifier hs-var">k</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">pure</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">as</span><span>
</span><a name="line-306"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-307"></a><span>    </span><a name="local-6989586621679025000"><a href="#local-6989586621679025000"><span class="hs-identifier">k</span></a></a><span> </span><a name="local-6989586621679025001"><a href="#local-6989586621679025001"><span class="hs-identifier">i</span></a></a><span> </span><a name="local-6989586621679025002"><a href="#local-6989586621679025002"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679025003"><a href="#local-6989586621679025003"><span class="hs-identifier">r</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">:</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="#local-6989586621679024998"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679025001"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="#local-6989586621679025002"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-operator hs-var">&lt;*&gt;</span><span> </span><a href="#local-6989586621679025003"><span class="hs-identifier hs-var">r</span></a><span>
</span><a name="line-308"></a><span class="hs-pragma">{-# INLINE itraverse #-}</span><span>
</span><a name="line-309"></a><span>
</span><a name="line-310"></a><span class="hs-identifier">ifor</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Applicative</span><span> </span><a href="#local-6989586621679020911"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679020912"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679020912"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679020911"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679020913"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679020911"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679020913"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">]</span><span>
</span><a name="line-311"></a><a name="ifor"><a href="Data.List.Index.html#ifor"><span class="hs-identifier">ifor</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">flip</span><span> </span><a href="Data.List.Index.html#itraverse"><span class="hs-identifier hs-var">itraverse</span></a><span>
</span><a name="line-312"></a><span class="hs-pragma">{-# INLINE ifor #-}</span><span>
</span><a name="line-313"></a><span>
</span><a name="line-314"></a><span class="hs-comment">{- |
/Subject to fusion./
-}</span><span>
</span><a name="line-317"></a><span class="hs-identifier">imapM_</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="#local-6989586621679020908"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679020909"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679020908"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679020910"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679020909"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679020908"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-318"></a><a name="imapM_"><a href="Data.List.Index.html#imapM_"><span class="hs-identifier">imapM_</span></a></a><span> </span><a name="local-6989586621679025017"><a href="#local-6989586621679025017"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.List.Index.html#ifoldr"><span class="hs-identifier hs-var">ifoldr</span></a><span> </span><a href="#local-6989586621679025019"><span class="hs-identifier hs-var">k</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">as</span><span>
</span><a name="line-319"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-320"></a><span>    </span><a name="local-6989586621679025019"><a href="#local-6989586621679025019"><span class="hs-identifier">k</span></a></a><span> </span><a name="local-6989586621679025020"><a href="#local-6989586621679025020"><span class="hs-identifier">i</span></a></a><span> </span><a name="local-6989586621679025021"><a href="#local-6989586621679025021"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679025022"><a href="#local-6989586621679025022"><span class="hs-identifier">r</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679025017"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679025020"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="#local-6989586621679025021"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><a href="#local-6989586621679025022"><span class="hs-identifier hs-var">r</span></a><span>
</span><a name="line-321"></a><span class="hs-pragma">{-# INLINE imapM_ #-}</span><span>
</span><a name="line-322"></a><span>
</span><a name="line-323"></a><span class="hs-comment">{- |
/Subject to fusion./
-}</span><span>
</span><a name="line-326"></a><span class="hs-identifier">iforM_</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="#local-6989586621679020905"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679020906"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679020906"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679020905"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679020907"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679020905"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-327"></a><a name="iforM_"><a href="Data.List.Index.html#iforM_"><span class="hs-identifier">iforM_</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">flip</span><span> </span><a href="Data.List.Index.html#imapM_"><span class="hs-identifier hs-var">imapM_</span></a><span>
</span><a name="line-328"></a><span class="hs-pragma">{-# INLINE iforM_ #-}</span><span>
</span><a name="line-329"></a><span>
</span><a name="line-330"></a><span class="hs-comment">{- |
/Subject to fusion./
-}</span><span>
</span><a name="line-333"></a><span class="hs-identifier">itraverse_</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Applicative</span><span> </span><a href="#local-6989586621679020902"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679020903"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679020902"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679020904"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679020903"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679020902"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-334"></a><a name="itraverse_"><a href="Data.List.Index.html#itraverse_"><span class="hs-identifier">itraverse_</span></a></a><span> </span><a name="local-6989586621679025023"><a href="#local-6989586621679025023"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.List.Index.html#ifoldr"><span class="hs-identifier hs-var">ifoldr</span></a><span> </span><a href="#local-6989586621679025025"><span class="hs-identifier hs-var">k</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">pure</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">as</span><span>
</span><a name="line-335"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-336"></a><span>    </span><a name="local-6989586621679025025"><a href="#local-6989586621679025025"><span class="hs-identifier">k</span></a></a><span> </span><a name="local-6989586621679025026"><a href="#local-6989586621679025026"><span class="hs-identifier">i</span></a></a><span> </span><a name="local-6989586621679025027"><a href="#local-6989586621679025027"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679025028"><a href="#local-6989586621679025028"><span class="hs-identifier">r</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679025023"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679025026"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="#local-6989586621679025027"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-operator hs-var">*&gt;</span><span> </span><a href="#local-6989586621679025028"><span class="hs-identifier hs-var">r</span></a><span>
</span><a name="line-337"></a><span class="hs-pragma">{-# INLINE itraverse_ #-}</span><span>
</span><a name="line-338"></a><span>
</span><a name="line-339"></a><span class="hs-comment">{- |
/Subject to fusion./
-}</span><span>
</span><a name="line-342"></a><span class="hs-identifier">ifor_</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Applicative</span><span> </span><a href="#local-6989586621679020899"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679020900"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679020900"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679020899"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679020901"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679020899"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-343"></a><a name="ifor_"><a href="Data.List.Index.html#ifor_"><span class="hs-identifier">ifor_</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">flip</span><span> </span><a href="Data.List.Index.html#itraverse_"><span class="hs-identifier hs-var">itraverse_</span></a><span>
</span><a name="line-344"></a><span class="hs-pragma">{-# INLINE ifor_ #-}</span><span>
</span><a name="line-345"></a><span>
</span><a name="line-346"></a><span class="hs-comment">{- |
Perform a given action @n@ times. Behaves like @for_ [0..n-1]@, but avoids &lt;https://ghc.haskell.org/trac/ghc/ticket/12620 space leaks&gt;.

If you want more complicated loops (e.g. counting downwards), consider the &lt;https://hackage.haskell.org/package/loop loop&gt; package.
-}</span><span>
</span><a name="line-351"></a><span class="hs-identifier">ireplicateM</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Applicative</span><span> </span><a href="#local-6989586621679020897"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679020897"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679020898"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679020897"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679020898"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-352"></a><a name="ireplicateM"><a href="Data.List.Index.html#ireplicateM"><span class="hs-identifier">ireplicateM</span></a></a><span> </span><a name="local-6989586621679025029"><a href="#local-6989586621679025029"><span class="hs-identifier">cnt</span></a></a><span> </span><a name="local-6989586621679025030"><a href="#local-6989586621679025030"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679025031"><span class="hs-identifier hs-var">go</span></a><span> </span><span class="hs-number">0</span><span>
</span><a name="line-353"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-354"></a><span>    </span><a name="local-6989586621679025031"><a href="#local-6989586621679025031"><span class="hs-identifier">go</span></a></a><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679025032"><a href="#local-6989586621679025032"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679025032"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-operator hs-var">&gt;=</span><span> </span><a href="#local-6989586621679025029"><span class="hs-identifier hs-var">cnt</span></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">pure</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-355"></a><span>          </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">:</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="#local-6989586621679025030"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679025032"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-operator hs-var">&lt;*&gt;</span><span> </span><a href="#local-6989586621679025031"><span class="hs-identifier hs-var">go</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679025032"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span>
</span><a name="line-356"></a><span class="hs-pragma">{-# INLINE ireplicateM #-}</span><span>
</span><a name="line-357"></a><span>
</span><a name="line-358"></a><span class="hs-comment">{- |
NB. This function intentionally uses 'Monad' even though 'Applicative' is enough. That's because the @transformers@ package didn't have an optimized definition of ('*&gt;') for 'StateT' prior to 0.5.3.0, so for a common case of 'StateT' this function would be 40 times slower with the 'Applicative' constraint.
-}</span><span>
</span><a name="line-361"></a><span class="hs-identifier">ireplicateM_</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="#local-6989586621679020895"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679020895"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679020896"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679020895"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-362"></a><a name="ireplicateM_"><a href="Data.List.Index.html#ireplicateM_"><span class="hs-identifier">ireplicateM_</span></a></a><span> </span><a name="local-6989586621679025033"><a href="#local-6989586621679025033"><span class="hs-identifier">cnt</span></a></a><span> </span><a name="local-6989586621679025034"><a href="#local-6989586621679025034"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679025033"><span class="hs-identifier hs-var">cnt</span></a><span> </span><span class="hs-operator hs-var">&gt;</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-keyword">then</span><span> </span><a href="#local-6989586621679025036"><span class="hs-identifier hs-var">go</span></a><span> </span><span class="hs-number">0</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-363"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-364"></a><span>    </span><span class="hs-comment">-- this is 30% faster for Maybe than the simpler</span><span>
</span><a name="line-365"></a><span>    </span><span class="hs-comment">--     go i | i == cnt  = return ()</span><span>
</span><a name="line-366"></a><span>    </span><span class="hs-comment">--          | otherwise = f i &gt;&gt; go (i + 1)</span><span>
</span><a name="line-367"></a><span>    </span><a name="local-6989586621679025035"><a href="#local-6989586621679025035"><span class="hs-identifier">cnt_</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679025033"><span class="hs-identifier hs-var">cnt</span></a><span class="hs-glyph">-</span><span class="hs-number">1</span><span>
</span><a name="line-368"></a><span>    </span><a name="local-6989586621679025036"><a href="#local-6989586621679025036"><span class="hs-identifier">go</span></a></a><span> </span><span class="hs-glyph">!</span><a name="local-6989586621679025037"><a href="#local-6989586621679025037"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679025037"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679025035"><span class="hs-identifier hs-var">cnt_</span></a><span> </span><span class="hs-keyword">then</span><span> </span><a href="#local-6989586621679025034"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679025037"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">else</span><span> </span><a href="#local-6989586621679025034"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679025037"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;</span><span> </span><a href="#local-6989586621679025036"><span class="hs-identifier hs-var">go</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679025037"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span>
</span><a name="line-369"></a><span class="hs-pragma">{-# INLINE ireplicateM_ #-}</span><span>
</span><a name="line-370"></a><span>
</span><a name="line-371"></a><span class="hs-comment">-- Using unboxed ints here doesn't seem to result in any benefit</span><span>
</span><a name="line-372"></a><span class="hs-identifier">ifoldr</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679020893"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679020894"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679020894"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679020894"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679020893"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679020894"><span class="hs-identifier hs-type">b</span></a><span>
</span><a name="line-373"></a><a name="ifoldr"><a href="Data.List.Index.html#ifoldr"><span class="hs-identifier">ifoldr</span></a></a><span> </span><a name="local-6989586621679025038"><a href="#local-6989586621679025038"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679025039"><a href="#local-6989586621679025039"><span class="hs-identifier">z</span></a></a><span> </span><a name="local-6989586621679025040"><a href="#local-6989586621679025040"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">foldr</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679025041"><a href="#local-6989586621679025041"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679025042"><a href="#local-6989586621679025042"><span class="hs-identifier">g</span></a></a><span> </span><a name="local-6989586621679025043"><a href="#local-6989586621679025043"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679025038"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679025043"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="#local-6989586621679025041"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679025042"><span class="hs-identifier hs-var">g</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679025043"><span class="hs-identifier hs-var">i</span></a><span class="hs-operator hs-var">+</span><span class="hs-number">1</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">const</span><span> </span><a href="#local-6989586621679025039"><span class="hs-identifier hs-var">z</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679025040"><span class="hs-identifier hs-var">xs</span></a><span> </span><span class="hs-number">0</span><span>
</span><a name="line-374"></a><span class="hs-pragma">{-# INLINE ifoldr #-}</span><span>
</span><a name="line-375"></a><span>
</span><a name="line-376"></a><span class="hs-identifier">ifoldrM</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="#local-6989586621679020890"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679020891"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679020892"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679020890"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679020892"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679020892"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679020891"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679020890"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679020892"><span class="hs-identifier hs-type">b</span></a><span>
</span><a name="line-377"></a><a name="ifoldrM"><a href="Data.List.Index.html#ifoldrM"><span class="hs-identifier">ifoldrM</span></a></a><span> </span><a name="local-6989586621679025044"><a href="#local-6989586621679025044"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679025045"><a href="#local-6989586621679025045"><span class="hs-identifier">z</span></a></a><span> </span><a name="local-6989586621679025046"><a href="#local-6989586621679025046"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.List.Index.html#ifoldr"><span class="hs-identifier hs-var">ifoldr</span></a><span> </span><a href="#local-6989586621679025047"><span class="hs-identifier hs-var">k</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-6989586621679025045"><span class="hs-identifier hs-var">z</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679025046"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-378"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-379"></a><span>    </span><a name="local-6989586621679025047"><a href="#local-6989586621679025047"><span class="hs-identifier">k</span></a></a><span> </span><a name="local-6989586621679025048"><a href="#local-6989586621679025048"><span class="hs-identifier">i</span></a></a><span> </span><a name="local-6989586621679025049"><a href="#local-6989586621679025049"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679025050"><a href="#local-6989586621679025050"><span class="hs-identifier">r</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679025044"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679025048"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="#local-6989586621679025049"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-operator hs-var">=&lt;&lt;</span><span> </span><a href="#local-6989586621679025050"><span class="hs-identifier hs-var">r</span></a><span>
</span><a name="line-380"></a><span class="hs-pragma">{-# INLINE ifoldrM #-}</span><span>
</span><a name="line-381"></a><span>
</span><a name="line-382"></a><span class="hs-identifier">imapAccumR</span><span>
</span><a name="line-383"></a><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679020887"><span class="hs-identifier hs-type">acc</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679020888"><span class="hs-identifier hs-type">x</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679020887"><span class="hs-identifier hs-type">acc</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679020889"><span class="hs-identifier hs-type">y</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-384"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679020887"><span class="hs-identifier hs-type">acc</span></a><span>
</span><a name="line-385"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679020888"><span class="hs-identifier hs-type">x</span></a><span class="hs-special">]</span><span>
</span><a name="line-386"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679020887"><span class="hs-identifier hs-type">acc</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679020889"><span class="hs-identifier hs-type">y</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-387"></a><a name="imapAccumR"><a href="Data.List.Index.html#imapAccumR"><span class="hs-identifier">imapAccumR</span></a></a><span> </span><a name="local-6989586621679025051"><a href="#local-6989586621679025051"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679025052"><a href="#local-6989586621679025052"><span class="hs-identifier">z</span></a></a><span> </span><a name="local-6989586621679025053"><a href="#local-6989586621679025053"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-388"></a><span>  </span><span class="hs-identifier hs-var">foldr</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679025054"><a href="#local-6989586621679025054"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679025055"><a href="#local-6989586621679025055"><span class="hs-identifier">g</span></a></a><span> </span><a name="local-6989586621679025056"><a href="#local-6989586621679025056"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679025057"><a href="#local-6989586621679025057"><span class="hs-identifier">a</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679025058"><a href="#local-6989586621679025058"><span class="hs-identifier">ys</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679025055"><span class="hs-identifier hs-var">g</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679025056"><span class="hs-identifier hs-var">i</span></a><span class="hs-operator hs-var">+</span><span class="hs-number">1</span><span class="hs-special">)</span><span>
</span><a name="line-389"></a><span>                       </span><span class="hs-special">(</span><a name="local-6989586621679025059"><a href="#local-6989586621679025059"><span class="hs-identifier">a'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679025060"><a href="#local-6989586621679025060"><span class="hs-identifier">y</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679025051"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679025057"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679025056"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="#local-6989586621679025054"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-390"></a><span>                   </span><span class="hs-keyword">in</span><span>  </span><span class="hs-special">(</span><a href="#local-6989586621679025059"><span class="hs-identifier hs-var">a'</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679025060"><span class="hs-identifier hs-var">y</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679025058"><span class="hs-identifier hs-var">ys</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-391"></a><span>        </span><span class="hs-special">(</span><span class="hs-identifier hs-var">const</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679025052"><span class="hs-identifier hs-var">z</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679025053"><span class="hs-identifier hs-var">xs</span></a><span> </span><span class="hs-number">0</span><span>
</span><a name="line-392"></a><span class="hs-pragma">{-# INLINE imapAccumR #-}</span><span>
</span><a name="line-393"></a><span>
</span><a name="line-394"></a><span class="hs-comment">{-

ifoldr1 :: (Int -&gt; a -&gt; a -&gt; a) -&gt; [a] -&gt; a
ifoldr1 f = go 0#
  where go _ [x]    = x
        go i (x:xs) = f (I# i) x (go (i +# 1#) xs)
        go _ []     = errorEmptyList &quot;ifoldr1&quot;
{-# INLINE [0] ifoldr1 #-}

-}</span><span>
</span><a name="line-404"></a><span>
</span><a name="line-405"></a><span class="hs-comment">{- |
The index isn't the first argument of the function because that's the convention adopted by containers and vector (but not lens).

/Subject to fusion./
-}</span><span>
</span><a name="line-410"></a><span class="hs-identifier">ifoldl</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><a name="local-6989586621679020885"><a href="#local-6989586621679020885"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679020886"><a href="#local-6989586621679020886"><span class="hs-identifier">b</span></a></a><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679020886"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679020885"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679020886"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679020886"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679020885"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679020886"><span class="hs-identifier hs-type">b</span></a><span>
</span><a name="line-411"></a><a name="ifoldl"><a href="Data.List.Index.html#ifoldl"><span class="hs-identifier">ifoldl</span></a></a><span> </span><a name="local-6989586621679025061"><a href="#local-6989586621679025061"><span class="hs-identifier">k</span></a></a><span> </span><a name="local-6989586621679025062"><a href="#local-6989586621679025062"><span class="hs-identifier">z0</span></a></a><span> </span><a name="local-6989586621679025063"><a href="#local-6989586621679025063"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-412"></a><span>  </span><span class="hs-identifier hs-var">foldr</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><a name="local-6989586621679025064"><a href="#local-6989586621679025064"><span class="hs-identifier">v</span></a></a><span class="hs-glyph">::</span><a href="#local-6989586621679020885"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679025065"><a href="#local-6989586621679025065"><span class="hs-identifier">fn</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Int</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679020886"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679020886"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-413"></a><span>          </span><span class="hs-identifier">ONE_SHOT</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-glyph">!</span><span class="hs-identifier">i</span><span class="hs-special">)</span><span class="hs-glyph">::</span><span class="hs-identifier">Int</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">z</span><span class="hs-glyph">::</span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">fn</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">i</span><span class="hs-operator">+</span><span class="hs-number">1</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">k</span><span> </span><span class="hs-identifier">z</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-identifier">v</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-414"></a><span>        </span><span class="hs-special">(</span><span class="hs-identifier hs-var">snd</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Int</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679020886"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679020886"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-415"></a><span>        </span><a href="#local-6989586621679025063"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-416"></a><span>        </span><span class="hs-special">(</span><span class="hs-number">0</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679025062"><span class="hs-identifier hs-var">z0</span></a><span class="hs-special">)</span><span>
</span><a name="line-417"></a><span class="hs-pragma">{-# INLINE ifoldl #-}</span><span>
</span><a name="line-418"></a><span>
</span><a name="line-419"></a><span class="hs-comment">{- |
/Subject to fusion./
-}</span><span>
</span><a name="line-422"></a><span class="hs-identifier">ifoldl'</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><a name="local-6989586621679020883"><a href="#local-6989586621679020883"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679020884"><a href="#local-6989586621679020884"><span class="hs-identifier">b</span></a></a><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679020884"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679020883"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679020884"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679020884"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679020883"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679020884"><span class="hs-identifier hs-type">b</span></a><span>
</span><a name="line-423"></a><a name="ifoldl%27"><a href="Data.List.Index.html#ifoldl%27"><span class="hs-identifier">ifoldl'</span></a></a><span> </span><a name="local-6989586621679025094"><a href="#local-6989586621679025094"><span class="hs-identifier">k</span></a></a><span> </span><a name="local-6989586621679025095"><a href="#local-6989586621679025095"><span class="hs-identifier">z0</span></a></a><span> </span><a name="local-6989586621679025096"><a href="#local-6989586621679025096"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-424"></a><span>  </span><span class="hs-identifier hs-var">foldr</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><a name="local-6989586621679025097"><a href="#local-6989586621679025097"><span class="hs-identifier">v</span></a></a><span class="hs-glyph">::</span><a href="#local-6989586621679020883"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679025098"><a href="#local-6989586621679025098"><span class="hs-identifier">fn</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Int</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679020884"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679020884"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-425"></a><span>          </span><span class="hs-identifier">ONE_SHOT</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-glyph">!</span><span class="hs-identifier">i</span><span class="hs-special">)</span><span class="hs-glyph">::</span><span class="hs-identifier">Int</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">z</span><span class="hs-glyph">::</span><span class="hs-identifier">b</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">z</span><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">seq</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">fn</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">i</span><span class="hs-operator">+</span><span class="hs-number">1</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">k</span><span> </span><span class="hs-identifier">z</span><span> </span><span class="hs-identifier">i</span><span> </span><span class="hs-identifier">v</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-426"></a><span>        </span><span class="hs-special">(</span><span class="hs-identifier hs-var">snd</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Int</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679020884"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679020884"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-427"></a><span>        </span><a href="#local-6989586621679025096"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-428"></a><span>        </span><span class="hs-special">(</span><span class="hs-number">0</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679025095"><span class="hs-identifier hs-var">z0</span></a><span class="hs-special">)</span><span>
</span><a name="line-429"></a><span class="hs-pragma">{-# INLINE ifoldl' #-}</span><span>
</span><a name="line-430"></a><span>
</span><a name="line-431"></a><span class="hs-comment">{- |
/Subject to fusion./
-}</span><span>
</span><a name="line-434"></a><span class="hs-identifier">ifoldlM</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="#local-6989586621679020880"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679020881"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679020882"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679020880"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679020881"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679020881"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679020882"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679020880"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679020881"><span class="hs-identifier hs-type">b</span></a><span>
</span><a name="line-435"></a><a name="ifoldlM"><a href="Data.List.Index.html#ifoldlM"><span class="hs-identifier">ifoldlM</span></a></a><span> </span><a name="local-6989586621679025101"><a href="#local-6989586621679025101"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679025102"><a href="#local-6989586621679025102"><span class="hs-identifier">z</span></a></a><span> </span><a name="local-6989586621679025103"><a href="#local-6989586621679025103"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.List.Index.html#ifoldl"><span class="hs-identifier hs-var">ifoldl</span></a><span> </span><a href="#local-6989586621679025104"><span class="hs-identifier hs-var">k</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-6989586621679025102"><span class="hs-identifier hs-var">z</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679025103"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-436"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-437"></a><span>    </span><a name="local-6989586621679025104"><a href="#local-6989586621679025104"><span class="hs-identifier">k</span></a></a><span> </span><a name="local-6989586621679025105"><a href="#local-6989586621679025105"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679025106"><a href="#local-6989586621679025106"><span class="hs-identifier">i</span></a></a><span> </span><a name="local-6989586621679025107"><a href="#local-6989586621679025107"><span class="hs-identifier">r</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621679025108"><a href="#local-6989586621679025108"><span class="hs-identifier">a'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679025105"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">;</span><span> </span><a href="#local-6989586621679025101"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679025108"><span class="hs-identifier hs-var">a'</span></a><span> </span><a href="#local-6989586621679025106"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="#local-6989586621679025107"><span class="hs-identifier hs-var">r</span></a><span>
</span><a name="line-438"></a><span class="hs-pragma">{-# INLINE ifoldlM #-}</span><span>
</span><a name="line-439"></a><span>
</span><a name="line-440"></a><span class="hs-identifier">imapAccumL</span><span>
</span><a name="line-441"></a><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679020877"><span class="hs-identifier hs-type">acc</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679020878"><span class="hs-identifier hs-type">x</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679020877"><span class="hs-identifier hs-type">acc</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679020879"><span class="hs-identifier hs-type">y</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-442"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679020877"><span class="hs-identifier hs-type">acc</span></a><span>
</span><a name="line-443"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679020878"><span class="hs-identifier hs-type">x</span></a><span class="hs-special">]</span><span>
</span><a name="line-444"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679020877"><span class="hs-identifier hs-type">acc</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679020879"><span class="hs-identifier hs-type">y</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-445"></a><a name="imapAccumL"><a href="Data.List.Index.html#imapAccumL"><span class="hs-identifier">imapAccumL</span></a></a><span> </span><a name="local-6989586621679025109"><a href="#local-6989586621679025109"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679025110"><a href="#local-6989586621679025110"><span class="hs-identifier">z</span></a></a><span> </span><a name="local-6989586621679025111"><a href="#local-6989586621679025111"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-446"></a><span>  </span><span class="hs-identifier hs-var">foldr</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><a name="local-6989586621679025113"><a href="#local-6989586621679025113"><span class="hs-identifier">x</span></a></a><span class="hs-glyph">::</span><a href="#local-6989586621679025112"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679025116"><a href="#local-6989586621679025116"><span class="hs-identifier">r</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Int</span><span class="hs-special">,</span><a href="#local-6989586621679025114"><span class="hs-identifier hs-type">acc</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679025114"><span class="hs-identifier hs-type">acc</span></a><span class="hs-special">,</span><span class="hs-special">[</span><a href="#local-6989586621679025115"><span class="hs-identifier hs-type">y</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-447"></a><span>          </span><span class="hs-identifier">ONE_SHOT</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-glyph">!</span><span class="hs-identifier">i</span><span class="hs-special">)</span><span class="hs-glyph">::</span><span class="hs-identifier">Int</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">s</span><span class="hs-glyph">::</span><span class="hs-identifier">acc</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-448"></a><span>            </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679025119"><a href="#local-6989586621679025119"><span class="hs-identifier">s'</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679025120"><a href="#local-6989586621679025120"><span class="hs-identifier">y</span></a></a><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679025109"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679025118"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="#local-6989586621679025117"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="#local-6989586621679025113"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-449"></a><span>                </span><span class="hs-special">(</span><a name="local-6989586621679025121"><a href="#local-6989586621679025121"><span class="hs-identifier">s''</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679025122"><a href="#local-6989586621679025122"><span class="hs-identifier">ys</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679025116"><span class="hs-identifier hs-var">r</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679025117"><span class="hs-identifier hs-var">i</span></a><span class="hs-operator hs-var">+</span><span class="hs-number">1</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679025119"><span class="hs-identifier hs-var">s'</span></a><span class="hs-special">)</span><span>
</span><a name="line-450"></a><span>            </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679025121"><span class="hs-identifier hs-var">s''</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679025120"><span class="hs-identifier hs-var">y</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679025122"><span class="hs-identifier hs-var">ys</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-451"></a><span>        </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a name="local-6989586621679025125"><a href="#local-6989586621679025125"><span class="hs-identifier">a</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679025125"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Int</span><span class="hs-special">,</span><a href="#local-6989586621679025123"><span class="hs-identifier hs-type">acc</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679025123"><span class="hs-identifier hs-type">acc</span></a><span class="hs-special">,</span><span class="hs-special">[</span><a href="#local-6989586621679025124"><span class="hs-identifier hs-type">y</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-452"></a><span>        </span><a href="#local-6989586621679025111"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-453"></a><span>        </span><span class="hs-special">(</span><span class="hs-number">0</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679025110"><span class="hs-identifier hs-var">z</span></a><span class="hs-special">)</span><span>
</span><a name="line-454"></a><span class="hs-pragma">{-# INLINE imapAccumL #-}</span><span>
</span><a name="line-455"></a><span>
</span><a name="line-456"></a><span class="hs-comment">{-

ifoldl1 :: (a -&gt; Int -&gt; a -&gt; a) -&gt; [a] -&gt; a
ifoldl1 f (x:xs) = ifoldl f x xs
ifoldl1 _ []     = errorEmptyList &quot;ifoldl1&quot;

ifoldl1' :: (a -&gt; Int -&gt; a -&gt; a) -&gt; [a] -&gt; a
ifoldl1' f (x:xs) = ifoldl' f x xs
ifoldl1' _ []     = errorEmptyList &quot;ifoldl1'&quot;

-}</span><span>
</span><a name="line-467"></a><span>
</span><a name="line-468"></a><span class="hs-identifier">ifilter</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679020876"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679020876"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679020876"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-469"></a><a name="ifilter"><a href="Data.List.Index.html#ifilter"><span class="hs-identifier">ifilter</span></a></a><span> </span><a name="local-6989586621679025126"><a href="#local-6989586621679025126"><span class="hs-identifier">p</span></a></a><span> </span><a name="local-6989586621679025127"><a href="#local-6989586621679025127"><span class="hs-identifier">ls</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679025128"><span class="hs-identifier hs-var">go</span></a><span> </span><span class="hs-number">0</span><span class="hs-operator">#</span><span> </span><a href="#local-6989586621679025127"><span class="hs-identifier hs-var">ls</span></a><span>
</span><a name="line-470"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-471"></a><span>    </span><a name="local-6989586621679025128"><a href="#local-6989586621679025128"><span class="hs-identifier">go</span></a></a><span> </span><a name="local-6989586621679025129"><a href="#local-6989586621679025129"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679025130"><a href="#local-6989586621679025130"><span class="hs-identifier">x</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679025131"><a href="#local-6989586621679025131"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679025126"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">I</span><span class="hs-operator hs-var">#</span><span> </span><a href="#local-6989586621679025129"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679025130"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679025130"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679025128"><span class="hs-identifier hs-var">go</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679025129"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-operator hs-var">+#</span><span> </span><span class="hs-number">1</span><span class="hs-operator">#</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679025131"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-472"></a><span>                </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679025128"><span class="hs-identifier hs-var">go</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679025129"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-operator hs-var">+#</span><span> </span><span class="hs-number">1</span><span class="hs-operator">#</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679025131"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-473"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-474"></a><span class="hs-pragma">{-# NOINLINE [1] ifilter #-}</span><span>
</span><a name="line-475"></a><span>
</span><a name="line-476"></a><span class="hs-identifier">ifilterFB</span><span>
</span><a name="line-477"></a><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679020874"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679020875"><span class="hs-identifier hs-type">t</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679020875"><span class="hs-identifier hs-type">t</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679020874"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679020874"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Int</span><span class="hs-operator hs-type">#</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679020875"><span class="hs-identifier hs-type">t</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span class="hs-operator hs-type">#</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679020875"><span class="hs-identifier hs-type">t</span></a><span>
</span><a name="line-478"></a><a name="ifilterFB"><a href="Data.List.Index.html#ifilterFB"><span class="hs-identifier">ifilterFB</span></a></a><span> </span><a name="local-6989586621679025132"><a href="#local-6989586621679025132"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679025133"><a href="#local-6989586621679025133"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679025134"><a href="#local-6989586621679025134"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679025135"><a href="#local-6989586621679025135"><span class="hs-identifier">r</span></a></a><span> </span><a name="local-6989586621679025136"><a href="#local-6989586621679025136"><span class="hs-identifier">k</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-479"></a><span>  </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679025133"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">I</span><span class="hs-operator hs-var">#</span><span> </span><a href="#local-6989586621679025136"><span class="hs-identifier hs-var">k</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679025134"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-keyword">then</span><span> </span><a href="#local-6989586621679025134"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">`</span><a href="#local-6989586621679025132"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679025135"><span class="hs-identifier hs-var">r</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679025136"><span class="hs-identifier hs-var">k</span></a><span> </span><span class="hs-operator hs-var">+#</span><span> </span><span class="hs-number">1</span><span class="hs-operator">#</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">else</span><span> </span><a href="#local-6989586621679025135"><span class="hs-identifier hs-var">r</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679025136"><span class="hs-identifier hs-var">k</span></a><span> </span><span class="hs-operator hs-var">+#</span><span> </span><span class="hs-number">1</span><span class="hs-operator">#</span><span class="hs-special">)</span><span>
</span><a name="line-480"></a><span class="hs-pragma">{-# INLINE [0] ifilterFB #-}</span><span>
</span><a name="line-481"></a><span>
</span><a name="line-482"></a><span class="hs-pragma">{-# RULES
&quot;ifilter&quot;       [~1] forall p xs.    ifilter p xs = build (\c n -&gt; foldr (ifilterFB c p) (\_ -&gt; n) xs 0#)
&quot;ifilterList&quot;   [1]  forall p xs.    foldr (ifilterFB (:) p) (\_ -&gt; []) xs 0# = ifilter p xs
  #-}</span><span>
</span><a name="line-486"></a><span>
</span><a name="line-487"></a><span class="hs-identifier">itakeWhile</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679020873"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679020873"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679020873"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-488"></a><a name="itakeWhile"><a href="Data.List.Index.html#itakeWhile"><span class="hs-identifier">itakeWhile</span></a></a><span> </span><a name="local-6989586621679025137"><a href="#local-6989586621679025137"><span class="hs-identifier">p</span></a></a><span> </span><a name="local-6989586621679025138"><a href="#local-6989586621679025138"><span class="hs-identifier">ls</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679025139"><span class="hs-identifier hs-var">go</span></a><span> </span><span class="hs-number">0</span><span class="hs-operator">#</span><span> </span><a href="#local-6989586621679025138"><span class="hs-identifier hs-var">ls</span></a><span>
</span><a name="line-489"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-490"></a><span>    </span><a name="local-6989586621679025139"><a href="#local-6989586621679025139"><span class="hs-identifier">go</span></a></a><span> </span><a name="local-6989586621679025140"><a href="#local-6989586621679025140"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679025141"><a href="#local-6989586621679025141"><span class="hs-identifier">x</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679025142"><a href="#local-6989586621679025142"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679025137"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">I</span><span class="hs-operator hs-var">#</span><span> </span><a href="#local-6989586621679025140"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679025141"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679025141"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679025139"><span class="hs-identifier hs-var">go</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679025140"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-operator hs-var">+#</span><span> </span><span class="hs-number">1</span><span class="hs-operator">#</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679025142"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-491"></a><span>                </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-492"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-493"></a><span class="hs-pragma">{-# NOINLINE [1] itakeWhile #-}</span><span>
</span><a name="line-494"></a><span>
</span><a name="line-495"></a><span class="hs-identifier">itakeWhileFB</span><span>
</span><a name="line-496"></a><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679020871"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679020872"><span class="hs-identifier hs-type">t</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679020872"><span class="hs-identifier hs-type">t</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679020871"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679020872"><span class="hs-identifier hs-type">t</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679020871"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Int</span><span class="hs-operator hs-type">#</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679020872"><span class="hs-identifier hs-type">t</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span class="hs-operator hs-type">#</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679020872"><span class="hs-identifier hs-type">t</span></a><span>
</span><a name="line-497"></a><a name="itakeWhileFB"><a href="Data.List.Index.html#itakeWhileFB"><span class="hs-identifier">itakeWhileFB</span></a></a><span> </span><a name="local-6989586621679025143"><a href="#local-6989586621679025143"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679025144"><a href="#local-6989586621679025144"><span class="hs-identifier">p</span></a></a><span> </span><a name="local-6989586621679025145"><a href="#local-6989586621679025145"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679025146"><a href="#local-6989586621679025146"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679025147"><a href="#local-6989586621679025147"><span class="hs-identifier">r</span></a></a><span> </span><a name="local-6989586621679025148"><a href="#local-6989586621679025148"><span class="hs-identifier">k</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-498"></a><span>  </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679025144"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">I</span><span class="hs-operator hs-var">#</span><span> </span><a href="#local-6989586621679025148"><span class="hs-identifier hs-var">k</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679025146"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-keyword">then</span><span> </span><a href="#local-6989586621679025146"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">`</span><a href="#local-6989586621679025143"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679025147"><span class="hs-identifier hs-var">r</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679025148"><span class="hs-identifier hs-var">k</span></a><span> </span><span class="hs-operator hs-var">+#</span><span> </span><span class="hs-number">1</span><span class="hs-operator">#</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">else</span><span> </span><a href="#local-6989586621679025145"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-499"></a><span class="hs-pragma">{-# INLINE [0] itakeWhileFB #-}</span><span>
</span><a name="line-500"></a><span>
</span><a name="line-501"></a><span class="hs-pragma">{-# RULES
&quot;itakeWhile&quot;       [~1] forall p xs.    itakeWhile p xs = build (\c n -&gt; foldr (itakeWhileFB c p n) (\_ -&gt; n) xs 0#)
&quot;itakeWhileList&quot;   [1]  forall p xs.    foldr (itakeWhileFB (:) p []) (\_ -&gt; []) xs 0# = itakeWhile p xs
  #-}</span><span>
</span><a name="line-505"></a><span>
</span><a name="line-506"></a><span class="hs-identifier">idropWhile</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679020870"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679020870"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679020870"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-507"></a><a name="idropWhile"><a href="Data.List.Index.html#idropWhile"><span class="hs-identifier">idropWhile</span></a></a><span> </span><a name="local-6989586621679025149"><a href="#local-6989586621679025149"><span class="hs-identifier">p</span></a></a><span> </span><a name="local-6989586621679025150"><a href="#local-6989586621679025150"><span class="hs-identifier">ls</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679025151"><span class="hs-identifier hs-var">go</span></a><span> </span><span class="hs-number">0</span><span class="hs-operator">#</span><span> </span><a href="#local-6989586621679025150"><span class="hs-identifier hs-var">ls</span></a><span>
</span><a name="line-508"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-509"></a><span>    </span><a name="local-6989586621679025151"><a href="#local-6989586621679025151"><span class="hs-identifier">go</span></a></a><span> </span><a name="local-6989586621679025152"><a href="#local-6989586621679025152"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679025153"><a href="#local-6989586621679025153"><span class="hs-identifier">x</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679025154"><a href="#local-6989586621679025154"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679025149"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">I</span><span class="hs-operator hs-var">#</span><span> </span><a href="#local-6989586621679025152"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679025153"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679025151"><span class="hs-identifier hs-var">go</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679025152"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-operator hs-var">+#</span><span> </span><span class="hs-number">1</span><span class="hs-operator">#</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679025154"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-510"></a><span>                </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679025153"><span class="hs-identifier hs-var">x</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679025154"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-511"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-512"></a><span class="hs-pragma">{-# INLINE idropWhile #-}</span><span>
</span><a name="line-513"></a><span>
</span><a name="line-514"></a><span class="hs-identifier">ipartition</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679020869"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679020869"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="#local-6989586621679020869"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">[</span><a href="#local-6989586621679020869"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-515"></a><a name="ipartition"><a href="Data.List.Index.html#ipartition"><span class="hs-identifier">ipartition</span></a></a><span> </span><a name="local-6989586621679025155"><a href="#local-6989586621679025155"><span class="hs-identifier">p</span></a></a><span> </span><a name="local-6989586621679025156"><a href="#local-6989586621679025156"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.List.Index.html#ifoldr"><span class="hs-identifier hs-var">ifoldr</span></a><span> </span><span class="hs-special">(</span><a href="Data.List.Index.html#iselect"><span class="hs-identifier hs-var">iselect</span></a><span> </span><a href="#local-6989586621679025155"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679025156"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-516"></a><span class="hs-pragma">{-# INLINE ipartition #-}</span><span>
</span><a name="line-517"></a><span>
</span><a name="line-518"></a><span class="hs-identifier">iselect</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679020868"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679020868"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="#local-6989586621679020868"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679020868"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="#local-6989586621679020868"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679020868"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-519"></a><a name="iselect"><a href="Data.List.Index.html#iselect"><span class="hs-identifier">iselect</span></a></a><span> </span><a name="local-6989586621679025157"><a href="#local-6989586621679025157"><span class="hs-identifier">p</span></a></a><span> </span><a name="local-6989586621679025158"><a href="#local-6989586621679025158"><span class="hs-identifier">i</span></a></a><span> </span><a name="local-6989586621679025159"><a href="#local-6989586621679025159"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">~</span><span class="hs-special">(</span><a name="local-6989586621679025160"><a href="#local-6989586621679025160"><span class="hs-identifier">ts</span></a></a><span class="hs-special">,</span><a name="local-6989586621679025161"><a href="#local-6989586621679025161"><span class="hs-identifier">fs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679025157"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-6989586621679025158"><span class="hs-identifier hs-var">i</span></a><span> </span><a href="#local-6989586621679025159"><span class="hs-identifier hs-var">x</span></a><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679025159"><span class="hs-identifier hs-var">x</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679025160"><span class="hs-identifier hs-var">ts</span></a><span class="hs-special">,</span><a href="#local-6989586621679025161"><span class="hs-identifier hs-var">fs</span></a><span class="hs-special">)</span><span>
</span><a name="line-520"></a><span>                       </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679025160"><span class="hs-identifier hs-var">ts</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679025159"><span class="hs-identifier hs-var">x</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679025161"><span class="hs-identifier hs-var">fs</span></a><span class="hs-special">)</span><span>
</span><a name="line-521"></a><span>
</span><a name="line-522"></a><span class="hs-identifier">ifind</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679020867"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679020867"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Int</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679020867"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-523"></a><a name="ifind"><a href="Data.List.Index.html#ifind"><span class="hs-identifier">ifind</span></a></a><span> </span><a name="local-6989586621679025162"><a href="#local-6989586621679025162"><span class="hs-identifier">p</span></a></a><span> </span><a name="local-6989586621679025163"><a href="#local-6989586621679025163"><span class="hs-identifier">ls</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679025164"><span class="hs-identifier hs-var">go</span></a><span> </span><span class="hs-number">0</span><span class="hs-operator">#</span><span> </span><a href="#local-6989586621679025163"><span class="hs-identifier hs-var">ls</span></a><span>
</span><a name="line-524"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-525"></a><span>    </span><a name="local-6989586621679025164"><a href="#local-6989586621679025164"><span class="hs-identifier">go</span></a></a><span> </span><a name="local-6989586621679025165"><a href="#local-6989586621679025165"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679025166"><a href="#local-6989586621679025166"><span class="hs-identifier">x</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679025167"><a href="#local-6989586621679025167"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679025162"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">I</span><span class="hs-operator hs-var">#</span><span> </span><a href="#local-6989586621679025165"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679025166"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">I</span><span class="hs-operator hs-var">#</span><span> </span><a href="#local-6989586621679025165"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679025166"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span>
</span><a name="line-526"></a><span>                </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679025164"><span class="hs-identifier hs-var">go</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679025165"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-operator hs-var">+#</span><span> </span><span class="hs-number">1</span><span class="hs-operator">#</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679025167"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-527"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-528"></a><span class="hs-pragma">{-# INLINE ifind #-}</span><span>
</span><a name="line-529"></a><span>
</span><a name="line-530"></a><span class="hs-identifier">ifindIndex</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679020866"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679020866"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-531"></a><a name="ifindIndex"><a href="Data.List.Index.html#ifindIndex"><span class="hs-identifier">ifindIndex</span></a></a><span> </span><a name="local-6989586621679025168"><a href="#local-6989586621679025168"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">listToMaybe</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Data.List.Index.html#ifindIndices"><span class="hs-identifier hs-var">ifindIndices</span></a><span> </span><a href="#local-6989586621679025168"><span class="hs-identifier hs-var">p</span></a><span>
</span><a name="line-532"></a><span>
</span><a name="line-533"></a><span class="hs-identifier">ifindIndices</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679020865"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679020865"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Int</span><span class="hs-special">]</span><span>
</span><a name="line-534"></a><a name="ifindIndices"><a href="Data.List.Index.html#ifindIndices"><span class="hs-identifier">ifindIndices</span></a></a><span> </span><a name="local-6989586621679025169"><a href="#local-6989586621679025169"><span class="hs-identifier">p</span></a></a><span> </span><a name="local-6989586621679025170"><a href="#local-6989586621679025170"><span class="hs-identifier">ls</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679025171"><span class="hs-identifier hs-var">go</span></a><span> </span><span class="hs-number">0</span><span class="hs-operator">#</span><span> </span><a href="#local-6989586621679025170"><span class="hs-identifier hs-var">ls</span></a><span>
</span><a name="line-535"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-536"></a><span>    </span><a name="local-6989586621679025171"><a href="#local-6989586621679025171"><span class="hs-identifier">go</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-537"></a><span>    </span><span class="hs-identifier">go</span><span> </span><a name="local-6989586621679025172"><a href="#local-6989586621679025172"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679025173"><a href="#local-6989586621679025173"><span class="hs-identifier">x</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679025174"><a href="#local-6989586621679025174"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679025169"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">I</span><span class="hs-operator hs-var">#</span><span> </span><a href="#local-6989586621679025172"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679025173"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">I</span><span class="hs-operator hs-var">#</span><span> </span><a href="#local-6989586621679025172"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679025171"><span class="hs-identifier hs-var">go</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679025172"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-operator hs-var">+#</span><span> </span><span class="hs-number">1</span><span class="hs-operator">#</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679025174"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-538"></a><span>                </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679025171"><span class="hs-identifier hs-var">go</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679025172"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-operator hs-var">+#</span><span> </span><span class="hs-number">1</span><span class="hs-operator">#</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679025174"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-539"></a><span class="hs-pragma">{-# NOINLINE [1] ifindIndices #-}</span><span>
</span><a name="line-540"></a><span>
</span><a name="line-541"></a><span class="hs-identifier">ifindIndicesFB</span><span>
</span><a name="line-542"></a><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679020863"><span class="hs-identifier hs-type">t</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679020863"><span class="hs-identifier hs-type">t</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679020864"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679020864"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Int</span><span class="hs-operator hs-type">#</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679020863"><span class="hs-identifier hs-type">t</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span class="hs-operator hs-type">#</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679020863"><span class="hs-identifier hs-type">t</span></a><span>
</span><a name="line-543"></a><a name="ifindIndicesFB"><a href="Data.List.Index.html#ifindIndicesFB"><span class="hs-identifier">ifindIndicesFB</span></a></a><span> </span><a name="local-6989586621679025175"><a href="#local-6989586621679025175"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679025176"><a href="#local-6989586621679025176"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679025177"><a href="#local-6989586621679025177"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679025178"><a href="#local-6989586621679025178"><span class="hs-identifier">r</span></a></a><span> </span><a name="local-6989586621679025179"><a href="#local-6989586621679025179"><span class="hs-identifier">k</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-544"></a><span>  </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679025176"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">I</span><span class="hs-operator hs-var">#</span><span> </span><a href="#local-6989586621679025179"><span class="hs-identifier hs-var">k</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679025177"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier hs-var">I</span><span class="hs-operator hs-var">#</span><span> </span><a href="#local-6989586621679025179"><span class="hs-identifier hs-var">k</span></a><span> </span><span class="hs-special">`</span><a href="#local-6989586621679025175"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679025178"><span class="hs-identifier hs-var">r</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679025179"><span class="hs-identifier hs-var">k</span></a><span> </span><span class="hs-operator hs-var">+#</span><span> </span><span class="hs-number">1</span><span class="hs-operator">#</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">else</span><span> </span><a href="#local-6989586621679025178"><span class="hs-identifier hs-var">r</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679025179"><span class="hs-identifier hs-var">k</span></a><span> </span><span class="hs-operator hs-var">+#</span><span> </span><span class="hs-number">1</span><span class="hs-operator">#</span><span class="hs-special">)</span><span>
</span><a name="line-545"></a><span class="hs-pragma">{-# INLINE [0] ifindIndicesFB #-}</span><span>
</span><a name="line-546"></a><span>
</span><a name="line-547"></a><span class="hs-pragma">{-# RULES
&quot;ifindIndices&quot;       [~1] forall p xs.    ifindIndices p xs = build (\c n -&gt; foldr (ifindIndicesFB c p) (\_ -&gt; n) xs 0#)
&quot;ifindIndicesList&quot;   [1]  forall p xs.    foldr (ifindIndicesFB (:) p) (\_ -&gt; []) xs 0# = ifindIndices p xs
  #-}</span><span>
</span><a name="line-551"></a><span>
</span><a name="line-552"></a><span class="hs-comment">{-

errorEmptyList :: String -&gt; a
errorEmptyList fun = error (&quot;Data.List.Index.&quot; ++ fun ++ &quot;: empty list&quot;)

-}</span><span>
</span><a name="line-558"></a><span>
</span><a name="line-559"></a><span class="hs-comment">{- |
/Subject to fusion in the first argument./
-}</span><span>
</span><a name="line-562"></a><span class="hs-identifier">izipWith</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679020860"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679020861"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679020862"><span class="hs-identifier hs-type">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679020860"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679020861"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679020862"><span class="hs-identifier hs-type">c</span></a><span class="hs-special">]</span><span>
</span><a name="line-563"></a><a name="izipWith"><a href="Data.List.Index.html#izipWith"><span class="hs-identifier">izipWith</span></a></a><span> </span><a name="local-6989586621679025180"><a href="#local-6989586621679025180"><span class="hs-identifier">fun</span></a></a><span> </span><a name="local-6989586621679025181"><a href="#local-6989586621679025181"><span class="hs-identifier">xs</span></a></a><span> </span><a name="local-6989586621679025182"><a href="#local-6989586621679025182"><span class="hs-identifier">ys</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679025183"><span class="hs-identifier hs-var">go</span></a><span> </span><span class="hs-number">0</span><span class="hs-operator">#</span><span> </span><a href="#local-6989586621679025181"><span class="hs-identifier hs-var">xs</span></a><span> </span><a href="#local-6989586621679025182"><span class="hs-identifier hs-var">ys</span></a><span>
</span><a name="line-564"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-565"></a><span>    </span><a name="local-6989586621679025183"><a href="#local-6989586621679025183"><span class="hs-identifier">go</span></a></a><span> </span><a name="local-6989586621679025184"><a href="#local-6989586621679025184"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679025185"><a href="#local-6989586621679025185"><span class="hs-identifier">a</span></a></a><span class="hs-glyph">:</span><span class="hs-keyword">as</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679025187"><a href="#local-6989586621679025187"><span class="hs-identifier">b</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679025188"><a href="#local-6989586621679025188"><span class="hs-identifier">bs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679025180"><span class="hs-identifier hs-var">fun</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">I</span><span class="hs-operator hs-var">#</span><span> </span><a href="#local-6989586621679025184"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679025185"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679025187"><span class="hs-identifier hs-var">b</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679025183"><span class="hs-identifier hs-var">go</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679025184"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-operator hs-var">+#</span><span> </span><span class="hs-number">1</span><span class="hs-operator">#</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">as</span><span> </span><a href="#local-6989586621679025188"><span class="hs-identifier hs-var">bs</span></a><span>
</span><a name="line-566"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-567"></a><span class="hs-pragma">{-# NOINLINE [1] izipWith #-}</span><span>
</span><a name="line-568"></a><span>
</span><a name="line-569"></a><span class="hs-identifier">izipWithFB</span><span>
</span><a name="line-570"></a><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679020856"><span class="hs-identifier hs-type">c</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679020857"><span class="hs-identifier hs-type">t</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679020857"><span class="hs-identifier hs-type">t</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679020858"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679020859"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679020856"><span class="hs-identifier hs-type">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679020858"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679020859"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Int</span><span class="hs-operator hs-type">#</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679020857"><span class="hs-identifier hs-type">t</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span class="hs-operator hs-type">#</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679020857"><span class="hs-identifier hs-type">t</span></a><span>
</span><a name="line-571"></a><a name="izipWithFB"><a href="Data.List.Index.html#izipWithFB"><span class="hs-identifier">izipWithFB</span></a></a><span> </span><a name="local-6989586621679025189"><a href="#local-6989586621679025189"><span class="hs-identifier">c</span></a></a><span> </span><a name="local-6989586621679025190"><a href="#local-6989586621679025190"><span class="hs-identifier">fun</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679025191"><a href="#local-6989586621679025191"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679025192"><a href="#local-6989586621679025192"><span class="hs-identifier">y</span></a></a><span> </span><a name="local-6989586621679025193"><a href="#local-6989586621679025193"><span class="hs-identifier">cont</span></a></a><span> </span><a name="local-6989586621679025194"><a href="#local-6989586621679025194"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679025190"><span class="hs-identifier hs-var">fun</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">I</span><span class="hs-operator hs-var">#</span><span> </span><a href="#local-6989586621679025194"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679025191"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679025192"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-special">`</span><a href="#local-6989586621679025189"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679025193"><span class="hs-identifier hs-var">cont</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679025194"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-operator hs-var">+#</span><span> </span><span class="hs-number">1</span><span class="hs-operator">#</span><span class="hs-special">)</span><span>
</span><a name="line-572"></a><span class="hs-pragma">{-# INLINE [0] izipWithFB #-}</span><span>
</span><a name="line-573"></a><span>
</span><a name="line-574"></a><span class="hs-pragma">{-# RULES
&quot;izipWith&quot;       [~1] forall f xs ys.    izipWith f xs ys = build (\c n -&gt; foldr2 (izipWithFB c f) (\_ -&gt; n) xs ys 0#)
&quot;izipWithList&quot;   [1]  forall f xs ys.    foldr2 (izipWithFB (:) f) (\_ -&gt; []) xs ys 0# = izipWith f xs ys
  #-}</span><span>
</span><a name="line-578"></a><span>
</span><a name="line-579"></a><span class="hs-comment">-- Copied from GHC.List</span><span>
</span><a name="line-580"></a><span>
</span><a name="line-581"></a><span class="hs-identifier">foldr2</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679020853"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679020854"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679020855"><span class="hs-identifier hs-type">c</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679020855"><span class="hs-identifier hs-type">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679020855"><span class="hs-identifier hs-type">c</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679020853"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679020854"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679020855"><span class="hs-identifier hs-type">c</span></a><span>
</span><a name="line-582"></a><a name="foldr2"><a href="Data.List.Index.html#foldr2"><span class="hs-identifier">foldr2</span></a></a><span> </span><a name="local-6989586621679025195"><a href="#local-6989586621679025195"><span class="hs-identifier">k</span></a></a><span> </span><a name="local-6989586621679025196"><a href="#local-6989586621679025196"><span class="hs-identifier">z</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679025197"><span class="hs-identifier hs-var">go</span></a><span>
</span><a name="line-583"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-584"></a><span>        </span><a name="local-6989586621679025197"><a href="#local-6989586621679025197"><span class="hs-identifier">go</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>    </span><a name="local-6989586621679025198"><a href="#local-6989586621679025198"><span class="hs-identifier">_ys</span></a></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679025196"><span class="hs-identifier hs-var">z</span></a><span>
</span><a name="line-585"></a><span>        </span><span class="hs-identifier">go</span><span> </span><a name="local-6989586621679025199"><a href="#local-6989586621679025199"><span class="hs-identifier">_xs</span></a></a><span>   </span><span class="hs-special">[</span><span class="hs-special">]</span><span>      </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679025196"><span class="hs-identifier hs-var">z</span></a><span>
</span><a name="line-586"></a><span>        </span><span class="hs-identifier">go</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679025200"><a href="#local-6989586621679025200"><span class="hs-identifier">x</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679025201"><a href="#local-6989586621679025201"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679025202"><a href="#local-6989586621679025202"><span class="hs-identifier">y</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679025203"><a href="#local-6989586621679025203"><span class="hs-identifier">ys</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679025195"><span class="hs-identifier hs-var">k</span></a><span> </span><a href="#local-6989586621679025200"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679025202"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679025197"><span class="hs-identifier hs-var">go</span></a><span> </span><a href="#local-6989586621679025201"><span class="hs-identifier hs-var">xs</span></a><span> </span><a href="#local-6989586621679025203"><span class="hs-identifier hs-var">ys</span></a><span class="hs-special">)</span><span>
</span><a name="line-587"></a><span class="hs-pragma">{-# INLINE [0] foldr2 #-}</span><span>
</span><a name="line-588"></a><span>
</span><a name="line-589"></a><span class="hs-identifier">foldr2_left</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679020849"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679020850"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679020851"><span class="hs-identifier hs-type">c</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679020852"><span class="hs-identifier hs-type">d</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679020852"><span class="hs-identifier hs-type">d</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679020849"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="#local-6989586621679020850"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679020851"><span class="hs-identifier hs-type">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679020850"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679020852"><span class="hs-identifier hs-type">d</span></a><span>
</span><a name="line-590"></a><a name="foldr2_left"><a href="Data.List.Index.html#foldr2_left"><span class="hs-identifier">foldr2_left</span></a></a><span> </span><a name="local-6989586621679025204"><a href="#local-6989586621679025204"><span class="hs-identifier">_k</span></a></a><span>  </span><a name="local-6989586621679025205"><a href="#local-6989586621679025205"><span class="hs-identifier">z</span></a></a><span> </span><a name="local-6989586621679025206"><a href="#local-6989586621679025206"><span class="hs-identifier">_x</span></a></a><span> </span><a name="local-6989586621679025207"><a href="#local-6989586621679025207"><span class="hs-identifier">_r</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>     </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679025205"><span class="hs-identifier hs-var">z</span></a><span>
</span><a name="line-591"></a><span class="hs-identifier">foldr2_left</span><span>  </span><a name="local-6989586621679025208"><a href="#local-6989586621679025208"><span class="hs-identifier">k</span></a></a><span> </span><a name="local-6989586621679025209"><a href="#local-6989586621679025209"><span class="hs-identifier">_z</span></a></a><span>  </span><a name="local-6989586621679025210"><a href="#local-6989586621679025210"><span class="hs-identifier">x</span></a></a><span>  </span><a name="local-6989586621679025211"><a href="#local-6989586621679025211"><span class="hs-identifier">r</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679025212"><a href="#local-6989586621679025212"><span class="hs-identifier">y</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679025213"><a href="#local-6989586621679025213"><span class="hs-identifier">ys</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679025208"><span class="hs-identifier hs-var">k</span></a><span> </span><a href="#local-6989586621679025210"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679025212"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679025211"><span class="hs-identifier hs-var">r</span></a><span> </span><a href="#local-6989586621679025213"><span class="hs-identifier hs-var">ys</span></a><span class="hs-special">)</span><span>
</span><a name="line-592"></a><span>
</span><a name="line-593"></a><span class="hs-pragma">{-# RULES
&quot;foldr2/left&quot;   forall k z ys (g::forall b.(a-&gt;b-&gt;b)-&gt;b-&gt;b) .
                  foldr2 k z (build g) ys = g (foldr2_left  k z) (\_ -&gt; z) ys
 #-}</span><span>
</span><a name="line-597"></a><span>
</span><a name="line-598"></a><span class="hs-identifier">izipWith3</span><span>
</span><a name="line-599"></a><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679020845"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679020846"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679020847"><span class="hs-identifier hs-type">c</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679020848"><span class="hs-identifier hs-type">d</span></a><span class="hs-special">)</span><span>
</span><a name="line-600"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679020845"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679020846"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679020847"><span class="hs-identifier hs-type">c</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679020848"><span class="hs-identifier hs-type">d</span></a><span class="hs-special">]</span><span>
</span><a name="line-601"></a><a name="izipWith3"><a href="Data.List.Index.html#izipWith3"><span class="hs-identifier">izipWith3</span></a></a><span> </span><a name="local-6989586621679025214"><a href="#local-6989586621679025214"><span class="hs-identifier">fun</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679025215"><span class="hs-identifier hs-var">go</span></a><span> </span><span class="hs-number">0</span><span class="hs-operator">#</span><span>
</span><a name="line-602"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-603"></a><span>    </span><a name="local-6989586621679025215"><a href="#local-6989586621679025215"><span class="hs-identifier">go</span></a></a><span> </span><a name="local-6989586621679025216"><a href="#local-6989586621679025216"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679025217"><a href="#local-6989586621679025217"><span class="hs-identifier">a</span></a></a><span class="hs-glyph">:</span><span class="hs-keyword">as</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679025219"><a href="#local-6989586621679025219"><span class="hs-identifier">b</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679025220"><a href="#local-6989586621679025220"><span class="hs-identifier">bs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679025221"><a href="#local-6989586621679025221"><span class="hs-identifier">c</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679025222"><a href="#local-6989586621679025222"><span class="hs-identifier">cs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-604"></a><span>      </span><a href="#local-6989586621679025214"><span class="hs-identifier hs-var">fun</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">I</span><span class="hs-operator hs-var">#</span><span> </span><a href="#local-6989586621679025216"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679025217"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679025219"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679025221"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679025215"><span class="hs-identifier hs-var">go</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679025216"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-operator hs-var">+#</span><span> </span><span class="hs-number">1</span><span class="hs-operator">#</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">as</span><span> </span><a href="#local-6989586621679025220"><span class="hs-identifier hs-var">bs</span></a><span> </span><a href="#local-6989586621679025222"><span class="hs-identifier hs-var">cs</span></a><span>
</span><a name="line-605"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-606"></a><span class="hs-pragma">{-# INLINE izipWith3 #-}</span><span>
</span><a name="line-607"></a><span>
</span><a name="line-608"></a><span class="hs-identifier">izipWith4</span><span>
</span><a name="line-609"></a><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679020840"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679020841"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679020842"><span class="hs-identifier hs-type">c</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679020843"><span class="hs-identifier hs-type">d</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679020844"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span>
</span><a name="line-610"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679020840"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679020841"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679020842"><span class="hs-identifier hs-type">c</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679020843"><span class="hs-identifier hs-type">d</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679020844"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">]</span><span>
</span><a name="line-611"></a><a name="izipWith4"><a href="Data.List.Index.html#izipWith4"><span class="hs-identifier">izipWith4</span></a></a><span> </span><a name="local-6989586621679025223"><a href="#local-6989586621679025223"><span class="hs-identifier">fun</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679025224"><span class="hs-identifier hs-var">go</span></a><span> </span><span class="hs-number">0</span><span class="hs-operator">#</span><span>
</span><a name="line-612"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-613"></a><span>    </span><a name="local-6989586621679025224"><a href="#local-6989586621679025224"><span class="hs-identifier">go</span></a></a><span> </span><a name="local-6989586621679025225"><a href="#local-6989586621679025225"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679025226"><a href="#local-6989586621679025226"><span class="hs-identifier">a</span></a></a><span class="hs-glyph">:</span><span class="hs-keyword">as</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679025228"><a href="#local-6989586621679025228"><span class="hs-identifier">b</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679025229"><a href="#local-6989586621679025229"><span class="hs-identifier">bs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679025230"><a href="#local-6989586621679025230"><span class="hs-identifier">c</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679025231"><a href="#local-6989586621679025231"><span class="hs-identifier">cs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679025232"><a href="#local-6989586621679025232"><span class="hs-identifier">d</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679025233"><a href="#local-6989586621679025233"><span class="hs-identifier">ds</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-614"></a><span>      </span><a href="#local-6989586621679025223"><span class="hs-identifier hs-var">fun</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">I</span><span class="hs-operator hs-var">#</span><span> </span><a href="#local-6989586621679025225"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679025226"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679025228"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679025230"><span class="hs-identifier hs-var">c</span></a><span> </span><a href="#local-6989586621679025232"><span class="hs-identifier hs-var">d</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679025224"><span class="hs-identifier hs-var">go</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679025225"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-operator hs-var">+#</span><span> </span><span class="hs-number">1</span><span class="hs-operator">#</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">as</span><span> </span><a href="#local-6989586621679025229"><span class="hs-identifier hs-var">bs</span></a><span> </span><a href="#local-6989586621679025231"><span class="hs-identifier hs-var">cs</span></a><span> </span><a href="#local-6989586621679025233"><span class="hs-identifier hs-var">ds</span></a><span>
</span><a name="line-615"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-616"></a><span class="hs-pragma">{-# INLINE izipWith4 #-}</span><span>
</span><a name="line-617"></a><span>
</span><a name="line-618"></a><span class="hs-identifier">izipWith5</span><span>
</span><a name="line-619"></a><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679020834"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679020835"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679020836"><span class="hs-identifier hs-type">c</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679020837"><span class="hs-identifier hs-type">d</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679020838"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679020839"><span class="hs-identifier hs-type">f</span></a><span class="hs-special">)</span><span>
</span><a name="line-620"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679020834"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679020835"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679020836"><span class="hs-identifier hs-type">c</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679020837"><span class="hs-identifier hs-type">d</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679020838"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679020839"><span class="hs-identifier hs-type">f</span></a><span class="hs-special">]</span><span>
</span><a name="line-621"></a><a name="izipWith5"><a href="Data.List.Index.html#izipWith5"><span class="hs-identifier">izipWith5</span></a></a><span> </span><a name="local-6989586621679025234"><a href="#local-6989586621679025234"><span class="hs-identifier">fun</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679025235"><span class="hs-identifier hs-var">go</span></a><span> </span><span class="hs-number">0</span><span class="hs-operator">#</span><span>
</span><a name="line-622"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-623"></a><span>    </span><a name="local-6989586621679025235"><a href="#local-6989586621679025235"><span class="hs-identifier">go</span></a></a><span> </span><a name="local-6989586621679025236"><a href="#local-6989586621679025236"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679025237"><a href="#local-6989586621679025237"><span class="hs-identifier">a</span></a></a><span class="hs-glyph">:</span><span class="hs-keyword">as</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679025239"><a href="#local-6989586621679025239"><span class="hs-identifier">b</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679025240"><a href="#local-6989586621679025240"><span class="hs-identifier">bs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679025241"><a href="#local-6989586621679025241"><span class="hs-identifier">c</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679025242"><a href="#local-6989586621679025242"><span class="hs-identifier">cs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679025243"><a href="#local-6989586621679025243"><span class="hs-identifier">d</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679025244"><a href="#local-6989586621679025244"><span class="hs-identifier">ds</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679025245"><a href="#local-6989586621679025245"><span class="hs-identifier">e</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679025246"><a href="#local-6989586621679025246"><span class="hs-identifier">es</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-624"></a><span>      </span><a href="#local-6989586621679025234"><span class="hs-identifier hs-var">fun</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">I</span><span class="hs-operator hs-var">#</span><span> </span><a href="#local-6989586621679025236"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679025237"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679025239"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679025241"><span class="hs-identifier hs-var">c</span></a><span> </span><a href="#local-6989586621679025243"><span class="hs-identifier hs-var">d</span></a><span> </span><a href="#local-6989586621679025245"><span class="hs-identifier hs-var">e</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679025235"><span class="hs-identifier hs-var">go</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679025236"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-operator hs-var">+#</span><span> </span><span class="hs-number">1</span><span class="hs-operator">#</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">as</span><span> </span><a href="#local-6989586621679025240"><span class="hs-identifier hs-var">bs</span></a><span> </span><a href="#local-6989586621679025242"><span class="hs-identifier hs-var">cs</span></a><span> </span><a href="#local-6989586621679025244"><span class="hs-identifier hs-var">ds</span></a><span> </span><a href="#local-6989586621679025246"><span class="hs-identifier hs-var">es</span></a><span>
</span><a name="line-625"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-626"></a><span class="hs-pragma">{-# INLINE izipWith5 #-}</span><span>
</span><a name="line-627"></a><span>
</span><a name="line-628"></a><span class="hs-identifier">izipWith6</span><span>
</span><a name="line-629"></a><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679020827"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679020828"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679020829"><span class="hs-identifier hs-type">c</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679020830"><span class="hs-identifier hs-type">d</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679020831"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679020832"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679020833"><span class="hs-identifier hs-type">g</span></a><span class="hs-special">)</span><span>
</span><a name="line-630"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679020827"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679020828"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679020829"><span class="hs-identifier hs-type">c</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679020830"><span class="hs-identifier hs-type">d</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679020831"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679020832"><span class="hs-identifier hs-type">f</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679020833"><span class="hs-identifier hs-type">g</span></a><span class="hs-special">]</span><span>
</span><a name="line-631"></a><a name="izipWith6"><a href="Data.List.Index.html#izipWith6"><span class="hs-identifier">izipWith6</span></a></a><span> </span><a name="local-6989586621679025247"><a href="#local-6989586621679025247"><span class="hs-identifier">fun</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679025248"><span class="hs-identifier hs-var">go</span></a><span> </span><span class="hs-number">0</span><span class="hs-operator">#</span><span>
</span><a name="line-632"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-633"></a><span>    </span><a name="local-6989586621679025248"><a href="#local-6989586621679025248"><span class="hs-identifier">go</span></a></a><span> </span><a name="local-6989586621679025249"><a href="#local-6989586621679025249"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679025250"><a href="#local-6989586621679025250"><span class="hs-identifier">a</span></a></a><span class="hs-glyph">:</span><span class="hs-keyword">as</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679025252"><a href="#local-6989586621679025252"><span class="hs-identifier">b</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679025253"><a href="#local-6989586621679025253"><span class="hs-identifier">bs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679025254"><a href="#local-6989586621679025254"><span class="hs-identifier">c</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679025255"><a href="#local-6989586621679025255"><span class="hs-identifier">cs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679025256"><a href="#local-6989586621679025256"><span class="hs-identifier">d</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679025257"><a href="#local-6989586621679025257"><span class="hs-identifier">ds</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679025258"><a href="#local-6989586621679025258"><span class="hs-identifier">e</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679025259"><a href="#local-6989586621679025259"><span class="hs-identifier">es</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679025260"><a href="#local-6989586621679025260"><span class="hs-identifier">f</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679025261"><a href="#local-6989586621679025261"><span class="hs-identifier">fs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-634"></a><span>      </span><a href="#local-6989586621679025247"><span class="hs-identifier hs-var">fun</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">I</span><span class="hs-operator hs-var">#</span><span> </span><a href="#local-6989586621679025249"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679025250"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679025252"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679025254"><span class="hs-identifier hs-var">c</span></a><span> </span><a href="#local-6989586621679025256"><span class="hs-identifier hs-var">d</span></a><span> </span><a href="#local-6989586621679025258"><span class="hs-identifier hs-var">e</span></a><span> </span><a href="#local-6989586621679025260"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679025248"><span class="hs-identifier hs-var">go</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679025249"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-operator hs-var">+#</span><span> </span><span class="hs-number">1</span><span class="hs-operator">#</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">as</span><span> </span><a href="#local-6989586621679025253"><span class="hs-identifier hs-var">bs</span></a><span> </span><a href="#local-6989586621679025255"><span class="hs-identifier hs-var">cs</span></a><span> </span><a href="#local-6989586621679025257"><span class="hs-identifier hs-var">ds</span></a><span> </span><a href="#local-6989586621679025259"><span class="hs-identifier hs-var">es</span></a><span> </span><a href="#local-6989586621679025261"><span class="hs-identifier hs-var">fs</span></a><span>
</span><a name="line-635"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-636"></a><span class="hs-pragma">{-# INLINE izipWith6 #-}</span><span>
</span><a name="line-637"></a><span>
</span><a name="line-638"></a><span class="hs-identifier">izipWith7</span><span>
</span><a name="line-639"></a><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679020819"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679020820"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679020821"><span class="hs-identifier hs-type">c</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679020822"><span class="hs-identifier hs-type">d</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679020823"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679020824"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679020825"><span class="hs-identifier hs-type">g</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679020826"><span class="hs-identifier hs-type">h</span></a><span class="hs-special">)</span><span>
</span><a name="line-640"></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679020819"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679020820"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679020821"><span class="hs-identifier hs-type">c</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679020822"><span class="hs-identifier hs-type">d</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679020823"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679020824"><span class="hs-identifier hs-type">f</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679020825"><span class="hs-identifier hs-type">g</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679020826"><span class="hs-identifier hs-type">h</span></a><span class="hs-special">]</span><span>
</span><a name="line-641"></a><a name="izipWith7"><a href="Data.List.Index.html#izipWith7"><span class="hs-identifier">izipWith7</span></a></a><span> </span><a name="local-6989586621679025262"><a href="#local-6989586621679025262"><span class="hs-identifier">fun</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679025263"><span class="hs-identifier hs-var">go</span></a><span> </span><span class="hs-number">0</span><span class="hs-operator">#</span><span>
</span><a name="line-642"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-643"></a><span>    </span><a name="local-6989586621679025263"><a href="#local-6989586621679025263"><span class="hs-identifier">go</span></a></a><span> </span><a name="local-6989586621679025264"><a href="#local-6989586621679025264"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679025265"><a href="#local-6989586621679025265"><span class="hs-identifier">a</span></a></a><span class="hs-glyph">:</span><span class="hs-keyword">as</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679025267"><a href="#local-6989586621679025267"><span class="hs-identifier">b</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679025268"><a href="#local-6989586621679025268"><span class="hs-identifier">bs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679025269"><a href="#local-6989586621679025269"><span class="hs-identifier">c</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679025270"><a href="#local-6989586621679025270"><span class="hs-identifier">cs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679025271"><a href="#local-6989586621679025271"><span class="hs-identifier">d</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679025272"><a href="#local-6989586621679025272"><span class="hs-identifier">ds</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679025273"><a href="#local-6989586621679025273"><span class="hs-identifier">e</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679025274"><a href="#local-6989586621679025274"><span class="hs-identifier">es</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679025275"><a href="#local-6989586621679025275"><span class="hs-identifier">f</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679025276"><a href="#local-6989586621679025276"><span class="hs-identifier">fs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679025277"><a href="#local-6989586621679025277"><span class="hs-identifier">g</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679025278"><a href="#local-6989586621679025278"><span class="hs-identifier">gs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-644"></a><span>      </span><a href="#local-6989586621679025262"><span class="hs-identifier hs-var">fun</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">I</span><span class="hs-operator hs-var">#</span><span> </span><a href="#local-6989586621679025264"><span class="hs-identifier hs-var">i</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679025265"><span class="hs-identifier hs-var">a</span></a><span> </span><a href="#local-6989586621679025267"><span class="hs-identifier hs-var">b</span></a><span> </span><a href="#local-6989586621679025269"><span class="hs-identifier hs-var">c</span></a><span> </span><a href="#local-6989586621679025271"><span class="hs-identifier hs-var">d</span></a><span> </span><a href="#local-6989586621679025273"><span class="hs-identifier hs-var">e</span></a><span> </span><a href="#local-6989586621679025275"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679025277"><span class="hs-identifier hs-var">g</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679025263"><span class="hs-identifier hs-var">go</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679025264"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-operator hs-var">+#</span><span> </span><span class="hs-number">1</span><span class="hs-operator">#</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">as</span><span> </span><a href="#local-6989586621679025268"><span class="hs-identifier hs-var">bs</span></a><span> </span><a href="#local-6989586621679025270"><span class="hs-identifier hs-var">cs</span></a><span> </span><a href="#local-6989586621679025272"><span class="hs-identifier hs-var">ds</span></a><span> </span><a href="#local-6989586621679025274"><span class="hs-identifier hs-var">es</span></a><span> </span><a href="#local-6989586621679025276"><span class="hs-identifier hs-var">fs</span></a><span> </span><a href="#local-6989586621679025278"><span class="hs-identifier hs-var">gs</span></a><span>
</span><a name="line-645"></a><span>    </span><span class="hs-identifier">go</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-646"></a><span class="hs-pragma">{-# INLINE izipWith7 #-}</span><span>
</span><a name="line-647"></a><span>
</span><a name="line-648"></a><span class="hs-identifier">izipWithM</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Applicative</span><span> </span><a href="#local-6989586621679020815"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679020816"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679020817"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679020815"><span class="hs-identifier hs-type">f</span></a><span> </span><a href="#local-6989586621679020818"><span class="hs-identifier hs-type">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679020816"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679020817"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679020815"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679020818"><span class="hs-identifier hs-type">c</span></a><span class="hs-special">]</span><span>
</span><a name="line-649"></a><a name="izipWithM"><a href="Data.List.Index.html#izipWithM"><span class="hs-identifier">izipWithM</span></a></a><span> </span><a name="local-6989586621679025279"><a href="#local-6989586621679025279"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-keyword">as</span><span> </span><a name="local-6989586621679025281"><a href="#local-6989586621679025281"><span class="hs-identifier">bs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">sequenceA</span><span> </span><span class="hs-special">(</span><a href="Data.List.Index.html#izipWith"><span class="hs-identifier hs-var">izipWith</span></a><span> </span><a href="#local-6989586621679025279"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-keyword">as</span><span> </span><a href="#local-6989586621679025281"><span class="hs-identifier hs-var">bs</span></a><span class="hs-special">)</span><span>
</span><a name="line-650"></a><span class="hs-pragma">{-# INLINE izipWithM #-}</span><span>
</span><a name="line-651"></a><span>
</span><a name="line-652"></a><span class="hs-identifier">izipWithM_</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Applicative</span><span> </span><a href="#local-6989586621679018984"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679018985"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679018986"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679018984"><span class="hs-identifier hs-type">f</span></a><span> </span><a href="#local-6989586621679018987"><span class="hs-identifier hs-type">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679018985"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679018986"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679018984"><span class="hs-identifier hs-type">f</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-653"></a><a name="izipWithM_"><a href="Data.List.Index.html#izipWithM_"><span class="hs-identifier">izipWithM_</span></a></a><span> </span><a name="local-6989586621679025660"><a href="#local-6989586621679025660"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-keyword">as</span><span> </span><a name="local-6989586621679025662"><a href="#local-6989586621679025662"><span class="hs-identifier">bs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">sequenceA_</span><span> </span><span class="hs-special">(</span><a href="Data.List.Index.html#izipWith"><span class="hs-identifier hs-var">izipWith</span></a><span> </span><a href="#local-6989586621679025660"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-keyword">as</span><span> </span><a href="#local-6989586621679025662"><span class="hs-identifier hs-var">bs</span></a><span class="hs-special">)</span><span>
</span><a name="line-654"></a><span class="hs-pragma">{-# INLINE izipWithM_ #-}</span><span>
</span><a name="line-655"></a></pre></body></html>