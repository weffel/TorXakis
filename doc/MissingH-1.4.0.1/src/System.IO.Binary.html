<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">{- arch-tag: I/O utilities, binary tools
Copyright (c) 2004-2011 John Goerzen &lt;jgoerzen@complete.org&gt;

All rights reserved.

For license and copyright information, see the file LICENSE
-}</span><span>
</span><a name="line-8"></a><span>
</span><a name="line-9"></a><span class="hs-comment">{- |
   Module     : System.IO.Binary
   Copyright  : Copyright (C) 2004-2011 John Goerzen
   License    : BSD3

   Maintainer : John Goerzen &lt;jgoerzen@complete.org&gt;
   Stability  : provisional
   Portability: portable to platforms supporting binary I\/O

This module provides various helpful utilities for dealing with binary
input and output.

You can use this module to deal with binary blocks of data as either Strings
or lists of Word8.  The BinaryConvertible class provides this abstraction.

Wherever you see HVIO, you can transparently substite a regular Handle.
This module can work with any HVIO object, however.  See
&quot;System.IO.HVIO&quot; for more details.

Versions of MissingH prior 0.11.6 lacked the 'BinaryConvertible' class
and worked only with Strings and Handles.

Important note: /binary functions are not supported in all Haskell
implementations/.  Do not import or use this module unless you know you
are using an implementation that supports them.  At this time, here
is the support status:

 * GHC 6.2 and above: yes

 * GHC 6.x, earlier versions: unknown

 * GHC 5.x: no

 * nhc98: no

 * Hugs: partial (maybe complete; needs more testing)

Non-binary functions may be found in &quot;System.IO&quot;.

See also: &quot;System.IO.BlockIO&quot;

Written by John Goerzen, jgoerzen\@complete.org
-}</span><span>
</span><a name="line-52"></a><span>
</span><a name="line-53"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">System</span><span class="hs-operator">.</span><span class="hs-identifier">IO</span><span class="hs-operator">.</span><span class="hs-identifier">Binary</span><span class="hs-special">(</span><span>
</span><a name="line-54"></a><span>                       </span><span class="hs-comment">-- * Support for different types of blocks</span><span>
</span><a name="line-55"></a><span>                       </span><a href="System.IO.Binary.html#BinaryConvertible"><span class="hs-identifier hs-type">BinaryConvertible</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-56"></a><span>                       </span><span class="hs-comment">-- * Entire File\/Handle Utilities</span><span>
</span><a name="line-57"></a><span>                       </span><span class="hs-comment">-- ** Opened Handle Data Copying</span><span>
</span><a name="line-58"></a><span>                       </span><a href="System.IO.Binary.html#hBlockCopy"><span class="hs-identifier hs-var">hBlockCopy</span></a><span class="hs-special">,</span><span> </span><a href="System.IO.Binary.html#blockCopy"><span class="hs-identifier hs-var">blockCopy</span></a><span class="hs-special">,</span><span>
</span><a name="line-59"></a><span>                       </span><span class="hs-comment">-- ** Disk File Data Copying</span><span>
</span><a name="line-60"></a><span>                       </span><a href="System.IO.Binary.html#copyFileBlocksToFile"><span class="hs-identifier hs-var">copyFileBlocksToFile</span></a><span class="hs-special">,</span><span>
</span><a name="line-61"></a><span>                       </span><span class="hs-comment">-- * Binary Single-Block I\/O</span><span>
</span><a name="line-62"></a><span>                       </span><a href="System.IO.Binary.html#hPutBufStr"><span class="hs-identifier hs-var">hPutBufStr</span></a><span class="hs-special">,</span><span> </span><a href="System.IO.Binary.html#putBufStr"><span class="hs-identifier hs-var">putBufStr</span></a><span class="hs-special">,</span><span> </span><a href="System.IO.Binary.html#hGetBufStr"><span class="hs-identifier hs-var">hGetBufStr</span></a><span class="hs-special">,</span><span> </span><a href="System.IO.Binary.html#getBufStr"><span class="hs-identifier hs-var">getBufStr</span></a><span class="hs-special">,</span><span>
</span><a name="line-63"></a><span>                       </span><a href="System.IO.Binary.html#hFullGetBufStr"><span class="hs-identifier hs-var">hFullGetBufStr</span></a><span class="hs-special">,</span><span> </span><a href="System.IO.Binary.html#fullGetBufStr"><span class="hs-identifier hs-var">fullGetBufStr</span></a><span class="hs-special">,</span><span>
</span><a name="line-64"></a><span>                       </span><span class="hs-comment">-- * Binary Multi-Block I\/O</span><span>
</span><a name="line-65"></a><span>                       </span><a href="System.IO.Binary.html#hGetBlocks"><span class="hs-identifier hs-var">hGetBlocks</span></a><span class="hs-special">,</span><span> </span><a href="System.IO.Binary.html#getBlocks"><span class="hs-identifier hs-var">getBlocks</span></a><span class="hs-special">,</span><span> </span><a href="System.IO.Binary.html#hFullGetBlocks"><span class="hs-identifier hs-var">hFullGetBlocks</span></a><span class="hs-special">,</span><span> </span><a href="System.IO.Binary.html#fullGetBlocks"><span class="hs-identifier hs-var">fullGetBlocks</span></a><span class="hs-special">,</span><span>
</span><a name="line-66"></a><span>                       </span><span class="hs-comment">-- * Lazy Interaction</span><span>
</span><a name="line-67"></a><span>                       </span><a href="System.IO.Binary.html#readBinaryFile"><span class="hs-identifier hs-var">readBinaryFile</span></a><span class="hs-special">,</span><span> </span><a href="System.IO.Binary.html#writeBinaryFile"><span class="hs-identifier hs-var">writeBinaryFile</span></a><span class="hs-special">,</span><span>
</span><a name="line-68"></a><span>                       </span><span class="hs-comment">-- ** Binary Block-based</span><span>
</span><a name="line-69"></a><span>                       </span><a href="System.IO.Binary.html#hBlockInteract"><span class="hs-identifier hs-var">hBlockInteract</span></a><span class="hs-special">,</span><span> </span><a href="System.IO.Binary.html#blockInteract"><span class="hs-identifier hs-var">blockInteract</span></a><span class="hs-special">,</span><span>
</span><a name="line-70"></a><span>                       </span><a href="System.IO.Binary.html#hFullBlockInteract"><span class="hs-identifier hs-var">hFullBlockInteract</span></a><span class="hs-special">,</span><span> </span><a href="System.IO.Binary.html#fullBlockInteract"><span class="hs-identifier hs-var">fullBlockInteract</span></a><span>
</span><a name="line-71"></a><span>                        </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-72"></a><span>
</span><a name="line-73"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Word</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Word8</span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-74"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Foreign</span><span class="hs-operator">.</span><span class="hs-identifier">C</span><span class="hs-operator">.</span><span class="hs-identifier">String</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">peekCStringLen</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">withCString</span><span class="hs-special">)</span><span>
</span><a name="line-75"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Foreign</span><span class="hs-operator">.</span><span class="hs-identifier">C</span><span class="hs-operator">.</span><span class="hs-identifier">Types</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">CChar</span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-76"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Foreign</span><span class="hs-operator">.</span><span class="hs-identifier">ForeignPtr</span><span>
</span><a name="line-77"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Foreign</span><span class="hs-operator">.</span><span class="hs-identifier">Marshal</span><span class="hs-operator">.</span><span class="hs-identifier">Array</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">peekArray</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">withArray</span><span class="hs-special">)</span><span>
</span><a name="line-78"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Foreign</span><span class="hs-operator">.</span><span class="hs-identifier">Ptr</span><span>
</span><a name="line-79"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">System</span><span class="hs-operator">.</span><span class="hs-identifier">IO</span><span>
</span><a name="line-80"></a><span class="hs-keyword">import</span><span> </span><a href="System.IO.HVFS.html"><span class="hs-identifier">System</span><span class="hs-operator">.</span><span class="hs-identifier">IO</span><span class="hs-operator">.</span><span class="hs-identifier">HVFS</span></a><span>
</span><a name="line-81"></a><span class="hs-keyword">import</span><span> </span><a href="System.IO.HVIO.html"><span class="hs-identifier">System</span><span class="hs-operator">.</span><span class="hs-identifier">IO</span><span class="hs-operator">.</span><span class="hs-identifier">HVIO</span></a><span>
</span><a name="line-82"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">System</span><span class="hs-operator">.</span><span class="hs-identifier">IO</span><span class="hs-operator">.</span><span class="hs-identifier">Unsafe</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">unsafeInterleaveIO</span><span class="hs-special">)</span><span>
</span><a name="line-83"></a><span>
</span><a name="line-84"></a><span class="hs-comment">{- | Provides support for handling binary blocks with convenient
types.

This module provides implementations for Strings and for [Word8] (lists of
Word8s). -}</span><span>
</span><a name="line-89"></a><span class="hs-keyword">class</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="#local-6989586621679097082"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><a href="#local-6989586621679097082"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a name="BinaryConvertible"><a href="System.IO.Binary.html#BinaryConvertible"><span class="hs-identifier">BinaryConvertible</span></a></a><span> </span><a name="local-6989586621679097082"><a href="#local-6989586621679097082"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-90"></a><span>    </span><span class="hs-identifier">toBuf</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679097082"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Ptr</span><span> </span><span class="hs-identifier hs-type">CChar</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><a href="#local-6989586621679097083"><span class="hs-identifier hs-type">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><a href="#local-6989586621679097083"><span class="hs-identifier hs-type">c</span></a><span>
</span><a name="line-91"></a><span>    </span><span class="hs-identifier">fromBuf</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Ptr</span><span> </span><span class="hs-identifier hs-type">CChar</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-identifier hs-type">Int</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679097082"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-92"></a><span>
</span><a name="line-93"></a><span class="hs-keyword">instance</span><span> </span><a href="System.IO.Binary.html#BinaryConvertible"><span class="hs-identifier hs-type">BinaryConvertible</span></a><span> </span><span class="hs-identifier hs-type">Char</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-94"></a><span>    </span><a name="local-8214565720323871967"><a href="System.IO.Binary.html#toBuf"><span class="hs-identifier">toBuf</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">withCString</span><span>
</span><a name="line-95"></a><span>    </span><a name="local-8214565720323871968"><a href="System.IO.Binary.html#fromBuf"><span class="hs-identifier">fromBuf</span></a></a><span> </span><a name="local-6989586621679097345"><a href="#local-6989586621679097345"><span class="hs-identifier">len</span></a></a><span> </span><a name="local-6989586621679097346"><a href="#local-6989586621679097346"><span class="hs-identifier">func</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-96"></a><span>        </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621679097350"><a href="#local-6989586621679097350"><span class="hs-identifier">fbuf</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">mallocForeignPtrArray</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679097345"><span class="hs-identifier hs-var">len</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span>
</span><a name="line-97"></a><span>           </span><span class="hs-identifier hs-var">withForeignPtr</span><span> </span><a href="#local-6989586621679097350"><span class="hs-identifier hs-var">fbuf</span></a><span> </span><a href="#local-6989586621679097347"><span class="hs-identifier hs-var">handler</span></a><span>
</span><a name="line-98"></a><span>        </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679097347"><a href="#local-6989586621679097347"><span class="hs-identifier">handler</span></a></a><span> </span><a name="local-6989586621679097348"><a href="#local-6989586621679097348"><span class="hs-identifier">ptr</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-99"></a><span>                  </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621679097349"><a href="#local-6989586621679097349"><span class="hs-identifier">bytesread</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679097346"><span class="hs-identifier hs-var">func</span></a><span> </span><a href="#local-6989586621679097348"><span class="hs-identifier hs-var">ptr</span></a><span>
</span><a name="line-100"></a><span>                     </span><span class="hs-identifier hs-var">peekCStringLen</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679097348"><span class="hs-identifier hs-var">ptr</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679097349"><span class="hs-identifier hs-var">bytesread</span></a><span class="hs-special">)</span><span>
</span><a name="line-101"></a><span>
</span><a name="line-102"></a><span class="hs-keyword">instance</span><span> </span><a href="System.IO.Binary.html#BinaryConvertible"><span class="hs-identifier hs-type">BinaryConvertible</span></a><span> </span><span class="hs-identifier hs-type">Word8</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-103"></a><span>    </span><a name="local-8214565720323871967"><a href="System.IO.Binary.html#toBuf"><span class="hs-identifier">toBuf</span></a></a><span> </span><a name="local-6989586621679097084"><a href="#local-6989586621679097084"><span class="hs-identifier">hslist</span></a></a><span> </span><a name="local-6989586621679097085"><a href="#local-6989586621679097085"><span class="hs-identifier">func</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">withArray</span><span> </span><a href="#local-6989586621679097084"><span class="hs-identifier hs-var">hslist</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679097086"><a href="#local-6989586621679097086"><span class="hs-identifier">ptr</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679097085"><span class="hs-identifier hs-var">func</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">castPtr</span><span> </span><a href="#local-6989586621679097086"><span class="hs-identifier hs-var">ptr</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-104"></a><span>    </span><a name="local-8214565720323871968"><a href="System.IO.Binary.html#fromBuf"><span class="hs-identifier">fromBuf</span></a></a><span> </span><a name="local-6989586621679097087"><a href="#local-6989586621679097087"><span class="hs-identifier">len</span></a></a><span> </span><a name="local-6989586621679097088"><a href="#local-6989586621679097088"><span class="hs-identifier">func</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-105"></a><span>        </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679097344"><a href="#local-6989586621679097344"><span class="hs-identifier">fbuf</span></a></a><span class="hs-glyph">::</span><span class="hs-special">(</span><span class="hs-identifier hs-type">ForeignPtr</span><span> </span><span class="hs-identifier hs-type">Word8</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">mallocForeignPtrArray</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679097087"><span class="hs-identifier hs-var">len</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span>
</span><a name="line-106"></a><span>           </span><span class="hs-identifier hs-var">withForeignPtr</span><span> </span><a href="#local-6989586621679097344"><span class="hs-identifier hs-var">fbuf</span></a><span> </span><a href="#local-6989586621679097089"><span class="hs-identifier hs-var">handler</span></a><span>
</span><a name="line-107"></a><span>        </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679097089"><a href="#local-6989586621679097089"><span class="hs-identifier">handler</span></a></a><span> </span><a name="local-6989586621679097090"><a href="#local-6989586621679097090"><span class="hs-identifier">ptr</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-108"></a><span>                  </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621679097091"><a href="#local-6989586621679097091"><span class="hs-identifier">bytesread</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679097088"><span class="hs-identifier hs-var">func</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">castPtr</span><span> </span><a href="#local-6989586621679097090"><span class="hs-identifier hs-var">ptr</span></a><span class="hs-special">)</span><span>
</span><a name="line-109"></a><span>                     </span><span class="hs-identifier hs-var">peekArray</span><span> </span><a href="#local-6989586621679097091"><span class="hs-identifier hs-var">bytesread</span></a><span> </span><a href="#local-6989586621679097090"><span class="hs-identifier hs-var">ptr</span></a><span>
</span><a name="line-110"></a><span>
</span><a name="line-111"></a><span>
</span><a name="line-112"></a><span class="hs-comment">--  **************************************************</span><span>
</span><a name="line-113"></a><span class="hs-comment">--  Binary Files</span><span>
</span><a name="line-114"></a><span class="hs-comment">--  **************************************************</span><span>
</span><a name="line-115"></a><span>
</span><a name="line-116"></a><span class="hs-comment">{- | As a wrapper around the standard function 'System.IO.hPutBuf',
this function takes a standard Haskell 'String' instead of the far less
convenient @Ptr a@.  The entire contents of the string will be written
as a binary buffer using 'hPutBuf'.  The length of the output will be
the length of the passed String or list.

If it helps, you can thing of this function as being of type
@Handle -&gt; String -&gt; IO ()@ -}</span><span>
</span><a name="line-124"></a><span class="hs-identifier">hPutBufStr</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="System.IO.HVIO.html#HVIO"><span class="hs-identifier hs-type">HVIO</span></a><span> </span><a href="#local-6989586621679097388"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="System.IO.Binary.html#BinaryConvertible"><span class="hs-identifier hs-type">BinaryConvertible</span></a><span> </span><a href="#local-6989586621679097389"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679097388"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679097389"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-125"></a><a name="hPutBufStr"><a href="System.IO.Binary.html#hPutBufStr"><span class="hs-identifier">hPutBufStr</span></a></a><span> </span><a name="local-6989586621679097390"><a href="#local-6989586621679097390"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679097391"><a href="#local-6989586621679097391"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.IO.Binary.html#toBuf"><span class="hs-identifier hs-var">toBuf</span></a><span> </span><a href="#local-6989586621679097391"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679097392"><a href="#local-6989586621679097392"><span class="hs-identifier">cs</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="System.IO.HVIO.html#vPutBuf"><span class="hs-identifier hs-var">vPutBuf</span></a><span> </span><a href="#local-6989586621679097390"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679097392"><span class="hs-identifier hs-var">cs</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">length</span><span> </span><a href="#local-6989586621679097391"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-126"></a><span>
</span><a name="line-127"></a><span class="hs-comment">-- | An alias for 'hPutBufStr' 'stdout'</span><span>
</span><a name="line-128"></a><span class="hs-identifier">putBufStr</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="System.IO.Binary.html#BinaryConvertible"><span class="hs-identifier hs-type">BinaryConvertible</span></a><span> </span><a href="#local-6989586621679097387"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679097387"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-129"></a><a name="putBufStr"><a href="System.IO.Binary.html#putBufStr"><span class="hs-identifier">putBufStr</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.IO.Binary.html#hPutBufStr"><span class="hs-identifier hs-var">hPutBufStr</span></a><span> </span><span class="hs-identifier hs-var">stdout</span><span>
</span><a name="line-130"></a><span>
</span><a name="line-131"></a><span class="hs-comment">{- | Acts a wrapper around the standard function 'System.IO.hGetBuf',
this function returns a standard Haskell String (or [Word8]) instead of
modifying
a 'Ptr a' buffer.  The length is the maximum length to read and the
semantice are the same as with 'hGetBuf'; namely, the empty string
is returned with EOF is reached, and any given read may read fewer
bytes than the given length.

(Actually, it's a wrapper around 'System.IO.HVIO.vGetBuf') -}</span><span>
</span><a name="line-140"></a><span class="hs-identifier">hGetBufStr</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="System.IO.HVIO.html#HVIO"><span class="hs-identifier hs-type">HVIO</span></a><span> </span><a href="#local-6989586621679097385"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="System.IO.Binary.html#BinaryConvertible"><span class="hs-identifier hs-type">BinaryConvertible</span></a><span> </span><a href="#local-6989586621679097386"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679097385"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679097386"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">]</span><span>
</span><a name="line-141"></a><a name="hGetBufStr"><a href="System.IO.Binary.html#hGetBufStr"><span class="hs-identifier">hGetBufStr</span></a></a><span> </span><a name="local-6989586621679097393"><a href="#local-6989586621679097393"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679097394"><a href="#local-6989586621679097394"><span class="hs-identifier">count</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.IO.Binary.html#fromBuf"><span class="hs-identifier hs-var">fromBuf</span></a><span> </span><a href="#local-6989586621679097394"><span class="hs-identifier hs-var">count</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679097395"><a href="#local-6989586621679097395"><span class="hs-identifier">buf</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="System.IO.HVIO.html#vGetBuf"><span class="hs-identifier hs-var">vGetBuf</span></a><span> </span><a href="#local-6989586621679097393"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679097395"><span class="hs-identifier hs-var">buf</span></a><span> </span><a href="#local-6989586621679097394"><span class="hs-identifier hs-var">count</span></a><span class="hs-special">)</span><span>
</span><a name="line-142"></a><span>
</span><a name="line-143"></a><span class="hs-comment">-- | An alias for 'hGetBufStr' 'stdin'</span><span>
</span><a name="line-144"></a><span class="hs-identifier">getBufStr</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="System.IO.Binary.html#BinaryConvertible"><span class="hs-identifier hs-type">BinaryConvertible</span></a><span> </span><a href="#local-6989586621679097384"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679097384"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">]</span><span>
</span><a name="line-145"></a><a name="getBufStr"><a href="System.IO.Binary.html#getBufStr"><span class="hs-identifier">getBufStr</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.IO.Binary.html#hGetBufStr"><span class="hs-identifier hs-var">hGetBufStr</span></a><span> </span><span class="hs-identifier hs-var">stdin</span><span>
</span><a name="line-146"></a><span>
</span><a name="line-147"></a><span class="hs-comment">{- | Like 'hGetBufStr', but guarantees that it will only return fewer than
the requested number of bytes when EOF is encountered. -}</span><span>
</span><a name="line-149"></a><span class="hs-identifier">hFullGetBufStr</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="System.IO.HVIO.html#HVIO"><span class="hs-identifier hs-type">HVIO</span></a><span> </span><a href="#local-6989586621679097382"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="System.IO.Binary.html#BinaryConvertible"><span class="hs-identifier hs-type">BinaryConvertible</span></a><span> </span><a href="#local-6989586621679097383"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679097382"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679097383"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">]</span><span>
</span><a name="line-150"></a><a name="hFullGetBufStr"><a href="System.IO.Binary.html#hFullGetBufStr"><span class="hs-identifier">hFullGetBufStr</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-151"></a><span class="hs-identifier">hFullGetBufStr</span><span> </span><a name="local-6989586621679097396"><a href="#local-6989586621679097396"><span class="hs-identifier">f</span></a></a><span> </span><a name="local-6989586621679097397"><a href="#local-6989586621679097397"><span class="hs-identifier">count</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-152"></a><span>                         </span><a name="local-6989586621679097398"><a href="#local-6989586621679097398"><span class="hs-identifier">thisstr</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="System.IO.Binary.html#hGetBufStr"><span class="hs-identifier hs-var">hGetBufStr</span></a><span> </span><a href="#local-6989586621679097396"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679097397"><span class="hs-identifier hs-var">count</span></a><span>
</span><a name="line-153"></a><span>                         </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679097398"><span class="hs-identifier hs-var">thisstr</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-154"></a><span>                            </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-155"></a><span>                            </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-156"></a><span>                                 </span><a name="local-6989586621679097399"><a href="#local-6989586621679097399"><span class="hs-identifier">remainder</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="System.IO.Binary.html#hFullGetBufStr"><span class="hs-identifier hs-var">hFullGetBufStr</span></a><span> </span><a href="#local-6989586621679097396"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679097397"><span class="hs-identifier hs-var">count</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">length</span><span> </span><a href="#local-6989586621679097398"><span class="hs-identifier hs-var">thisstr</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-157"></a><span>                                 </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679097398"><span class="hs-identifier hs-var">thisstr</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679097399"><span class="hs-identifier hs-var">remainder</span></a><span class="hs-special">)</span><span>
</span><a name="line-158"></a><span>
</span><a name="line-159"></a><span class="hs-comment">-- | An alias for 'hFullGetBufStr' 'stdin'</span><span>
</span><a name="line-160"></a><span class="hs-identifier">fullGetBufStr</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="System.IO.Binary.html#BinaryConvertible"><span class="hs-identifier hs-type">BinaryConvertible</span></a><span> </span><a href="#local-6989586621679097381"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679097381"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">]</span><span>
</span><a name="line-161"></a><a name="fullGetBufStr"><a href="System.IO.Binary.html#fullGetBufStr"><span class="hs-identifier">fullGetBufStr</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.IO.Binary.html#hFullGetBufStr"><span class="hs-identifier hs-var">hFullGetBufStr</span></a><span> </span><span class="hs-identifier hs-var">stdin</span><span>
</span><a name="line-162"></a><span>
</span><a name="line-163"></a><span class="hs-comment">{- | Writes the list of blocks to the given file handle -- a wrapper around
'hPutBufStr'.

Think of this function as:

&gt;Handle -&gt; [String] -&gt; IO ()

(You can use it that way) -}</span><span>
</span><a name="line-171"></a><span class="hs-identifier">hPutBlocks</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="System.IO.HVIO.html#HVIO"><span class="hs-identifier hs-type">HVIO</span></a><span> </span><a href="#local-6989586621679097379"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="System.IO.Binary.html#BinaryConvertible"><span class="hs-identifier hs-type">BinaryConvertible</span></a><span> </span><a href="#local-6989586621679097380"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679097379"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><a href="#local-6989586621679097380"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-172"></a><a name="hPutBlocks"><a href="System.IO.Binary.html#hPutBlocks"><span class="hs-identifier">hPutBlocks</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-173"></a><span class="hs-identifier">hPutBlocks</span><span> </span><a name="local-6989586621679097400"><a href="#local-6989586621679097400"><span class="hs-identifier">h</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679097401"><a href="#local-6989586621679097401"><span class="hs-identifier">x</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679097402"><a href="#local-6989586621679097402"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-174"></a><span>                      </span><a href="System.IO.Binary.html#hPutBufStr"><span class="hs-identifier hs-var">hPutBufStr</span></a><span> </span><a href="#local-6989586621679097400"><span class="hs-identifier hs-var">h</span></a><span> </span><a href="#local-6989586621679097401"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-175"></a><span>                      </span><a href="System.IO.Binary.html#hPutBlocks"><span class="hs-identifier hs-var">hPutBlocks</span></a><span> </span><a href="#local-6989586621679097400"><span class="hs-identifier hs-var">h</span></a><span> </span><a href="#local-6989586621679097402"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-176"></a><span>
</span><a name="line-177"></a><span class="hs-comment">{- | An alias for 'hPutBlocks' 'stdout'
putBlocks :: (BinaryConvertible b) =&gt; [[b]] -&gt; IO ()
putBlocks = hPutBlocks stdout -}</span><span>
</span><a name="line-180"></a><span>
</span><a name="line-181"></a><span class="hs-comment">{- | Returns a lazily-evaluated list of all blocks in the input file,
as read by 'hGetBufStr'.  There will be no 0-length block in this list.
The list simply ends at EOF. -}</span><span>
</span><a name="line-184"></a><span class="hs-identifier">hGetBlocks</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="System.IO.HVIO.html#HVIO"><span class="hs-identifier hs-type">HVIO</span></a><span> </span><a href="#local-6989586621679097377"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="System.IO.Binary.html#BinaryConvertible"><span class="hs-identifier hs-type">BinaryConvertible</span></a><span> </span><a href="#local-6989586621679097378"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679097377"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><a href="#local-6989586621679097378"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-185"></a><a name="hGetBlocks"><a href="System.IO.Binary.html#hGetBlocks"><span class="hs-identifier">hGetBlocks</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.IO.Binary.html#hGetBlocksUtil"><span class="hs-identifier hs-var">hGetBlocksUtil</span></a><span> </span><a href="System.IO.Binary.html#hGetBufStr"><span class="hs-identifier hs-var">hGetBufStr</span></a><span>
</span><a name="line-186"></a><span>
</span><a name="line-187"></a><span class="hs-comment">-- | An alias for 'hGetBlocks' 'stdin'</span><span>
</span><a name="line-188"></a><span class="hs-identifier">getBlocks</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="System.IO.Binary.html#BinaryConvertible"><span class="hs-identifier hs-type">BinaryConvertible</span></a><span> </span><a href="#local-6989586621679097376"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><a href="#local-6989586621679097376"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-189"></a><a name="getBlocks"><a href="System.IO.Binary.html#getBlocks"><span class="hs-identifier">getBlocks</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.IO.Binary.html#hGetBlocks"><span class="hs-identifier hs-var">hGetBlocks</span></a><span> </span><span class="hs-identifier hs-var">stdin</span><span>
</span><a name="line-190"></a><span>
</span><a name="line-191"></a><span class="hs-comment">{- | Same as 'hGetBlocks', but using 'hFullGetBufStr' underneath. -}</span><span>
</span><a name="line-192"></a><span class="hs-identifier">hFullGetBlocks</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="System.IO.HVIO.html#HVIO"><span class="hs-identifier hs-type">HVIO</span></a><span> </span><a href="#local-6989586621679097374"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="System.IO.Binary.html#BinaryConvertible"><span class="hs-identifier hs-type">BinaryConvertible</span></a><span> </span><a href="#local-6989586621679097375"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679097374"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><a href="#local-6989586621679097375"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-193"></a><a name="hFullGetBlocks"><a href="System.IO.Binary.html#hFullGetBlocks"><span class="hs-identifier">hFullGetBlocks</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.IO.Binary.html#hGetBlocksUtil"><span class="hs-identifier hs-var">hGetBlocksUtil</span></a><span> </span><a href="System.IO.Binary.html#hFullGetBufStr"><span class="hs-identifier hs-var">hFullGetBufStr</span></a><span>
</span><a name="line-194"></a><span>
</span><a name="line-195"></a><span class="hs-comment">-- | An alias for 'hFullGetBlocks' 'stdin'</span><span>
</span><a name="line-196"></a><span class="hs-identifier">fullGetBlocks</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="System.IO.Binary.html#BinaryConvertible"><span class="hs-identifier hs-type">BinaryConvertible</span></a><span> </span><a href="#local-6989586621679097373"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><a href="#local-6989586621679097373"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-197"></a><a name="fullGetBlocks"><a href="System.IO.Binary.html#fullGetBlocks"><span class="hs-identifier">fullGetBlocks</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.IO.Binary.html#hFullGetBlocks"><span class="hs-identifier hs-var">hFullGetBlocks</span></a><span> </span><span class="hs-identifier hs-var">stdin</span><span>
</span><a name="line-198"></a><span>
</span><a name="line-199"></a><span class="hs-identifier">hGetBlocksUtil</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="System.IO.HVIO.html#HVIO"><span class="hs-identifier hs-type">HVIO</span></a><span> </span><a href="#local-6989586621679097371"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="System.IO.Binary.html#BinaryConvertible"><span class="hs-identifier hs-type">BinaryConvertible</span></a><span> </span><a href="#local-6989586621679097372"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679097371"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679097372"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679097371"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><a href="#local-6989586621679097372"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-200"></a><a name="hGetBlocksUtil"><a href="System.IO.Binary.html#hGetBlocksUtil"><span class="hs-identifier">hGetBlocksUtil</span></a></a><span> </span><a name="local-6989586621679097403"><a href="#local-6989586621679097403"><span class="hs-identifier">readfunc</span></a></a><span> </span><a name="local-6989586621679097404"><a href="#local-6989586621679097404"><span class="hs-identifier">h</span></a></a><span> </span><a name="local-6989586621679097405"><a href="#local-6989586621679097405"><span class="hs-identifier">count</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-201"></a><span>    </span><span class="hs-identifier hs-var">unsafeInterleaveIO</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-202"></a><span>                       </span><a name="local-6989586621679097406"><a href="#local-6989586621679097406"><span class="hs-identifier">block</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679097403"><span class="hs-identifier hs-var">readfunc</span></a><span> </span><a href="#local-6989586621679097404"><span class="hs-identifier hs-var">h</span></a><span> </span><a href="#local-6989586621679097405"><span class="hs-identifier hs-var">count</span></a><span>
</span><a name="line-203"></a><span>                       </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679097406"><span class="hs-identifier hs-var">block</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-204"></a><span>                          </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-205"></a><span>                          </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-206"></a><span>                               </span><a name="local-6989586621679097407"><a href="#local-6989586621679097407"><span class="hs-identifier">remainder</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="System.IO.Binary.html#hGetBlocksUtil"><span class="hs-identifier hs-var">hGetBlocksUtil</span></a><span> </span><a href="#local-6989586621679097403"><span class="hs-identifier hs-var">readfunc</span></a><span> </span><a href="#local-6989586621679097404"><span class="hs-identifier hs-var">h</span></a><span> </span><a href="#local-6989586621679097405"><span class="hs-identifier hs-var">count</span></a><span>
</span><a name="line-207"></a><span>                               </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679097406"><span class="hs-identifier hs-var">block</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679097407"><span class="hs-identifier hs-var">remainder</span></a><span class="hs-special">)</span><span>
</span><a name="line-208"></a><span>
</span><a name="line-209"></a><span class="hs-comment">{- | Binary block-based interaction.  This is useful for scenarios that
take binary blocks, manipulate them in some way, and then write them
out.  Take a look at 'hBlockCopy' for an example.  The integer argument
is the size of input binary blocks.  This function uses 'hGetBlocks'
internally.
-}</span><span>
</span><a name="line-215"></a><span class="hs-identifier">hBlockInteract</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="System.IO.HVIO.html#HVIO"><span class="hs-identifier hs-type">HVIO</span></a><span> </span><a href="#local-6989586621679097367"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="System.IO.HVIO.html#HVIO"><span class="hs-identifier hs-type">HVIO</span></a><span> </span><a href="#local-6989586621679097368"><span class="hs-identifier hs-type">d</span></a><span class="hs-special">,</span><span> </span><a href="System.IO.Binary.html#BinaryConvertible"><span class="hs-identifier hs-type">BinaryConvertible</span></a><span> </span><a href="#local-6989586621679097369"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">,</span><span> </span><a href="System.IO.Binary.html#BinaryConvertible"><span class="hs-identifier hs-type">BinaryConvertible</span></a><span> </span><a href="#local-6989586621679097370"><span class="hs-identifier hs-type">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><a name="line-216"></a><span>                  </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679097367"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679097368"><span class="hs-identifier hs-type">d</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">[</span><a href="#local-6989586621679097369"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><a href="#local-6989586621679097370"><span class="hs-identifier hs-type">c</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-217"></a><a name="hBlockInteract"><a href="System.IO.Binary.html#hBlockInteract"><span class="hs-identifier">hBlockInteract</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.IO.Binary.html#hBlockInteractUtil"><span class="hs-identifier hs-var">hBlockInteractUtil</span></a><span> </span><a href="System.IO.Binary.html#hGetBlocks"><span class="hs-identifier hs-var">hGetBlocks</span></a><span>
</span><a name="line-218"></a><span>
</span><a name="line-219"></a><span class="hs-comment">-- | An alias for 'hBlockInteract' over 'stdin' and 'stdout'</span><span>
</span><a name="line-220"></a><span class="hs-identifier">blockInteract</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="System.IO.Binary.html#BinaryConvertible"><span class="hs-identifier hs-type">BinaryConvertible</span></a><span> </span><a href="#local-6989586621679097365"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">,</span><span> </span><a href="System.IO.Binary.html#BinaryConvertible"><span class="hs-identifier hs-type">BinaryConvertible</span></a><span> </span><a href="#local-6989586621679097366"><span class="hs-identifier hs-type">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">[</span><a href="#local-6989586621679097365"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><a href="#local-6989586621679097366"><span class="hs-identifier hs-type">c</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-221"></a><a name="blockInteract"><a href="System.IO.Binary.html#blockInteract"><span class="hs-identifier">blockInteract</span></a></a><span> </span><a name="local-6989586621679097408"><a href="#local-6989586621679097408"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.IO.Binary.html#hBlockInteract"><span class="hs-identifier hs-var">hBlockInteract</span></a><span> </span><a href="#local-6989586621679097408"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-identifier hs-var">stdin</span><span> </span><span class="hs-identifier hs-var">stdout</span><span>
</span><a name="line-222"></a><span>
</span><a name="line-223"></a><span class="hs-comment">{- | Same as 'hBlockInteract', but uses 'hFullGetBlocks' instead of
'hGetBlocks' internally. -}</span><span>
</span><a name="line-225"></a><span class="hs-identifier">hFullBlockInteract</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="System.IO.HVIO.html#HVIO"><span class="hs-identifier hs-type">HVIO</span></a><span> </span><a href="#local-6989586621679097361"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="System.IO.HVIO.html#HVIO"><span class="hs-identifier hs-type">HVIO</span></a><span> </span><a href="#local-6989586621679097362"><span class="hs-identifier hs-type">d</span></a><span class="hs-special">,</span><span> </span><a href="System.IO.Binary.html#BinaryConvertible"><span class="hs-identifier hs-type">BinaryConvertible</span></a><span> </span><a href="#local-6989586621679097363"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">,</span><span> </span><a href="System.IO.Binary.html#BinaryConvertible"><span class="hs-identifier hs-type">BinaryConvertible</span></a><span> </span><a href="#local-6989586621679097364"><span class="hs-identifier hs-type">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><a name="line-226"></a><span>                      </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679097361"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679097362"><span class="hs-identifier hs-type">d</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">[</span><a href="#local-6989586621679097363"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><a href="#local-6989586621679097364"><span class="hs-identifier hs-type">c</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-227"></a><a name="hFullBlockInteract"><a href="System.IO.Binary.html#hFullBlockInteract"><span class="hs-identifier">hFullBlockInteract</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.IO.Binary.html#hBlockInteractUtil"><span class="hs-identifier hs-var">hBlockInteractUtil</span></a><span> </span><a href="System.IO.Binary.html#hFullGetBlocks"><span class="hs-identifier hs-var">hFullGetBlocks</span></a><span>
</span><a name="line-228"></a><span>
</span><a name="line-229"></a><span class="hs-comment">-- | An alias for 'hFullBlockInteract' over 'stdin' and 'stdout'</span><span>
</span><a name="line-230"></a><span class="hs-identifier">fullBlockInteract</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="System.IO.Binary.html#BinaryConvertible"><span class="hs-identifier hs-type">BinaryConvertible</span></a><span> </span><a href="#local-6989586621679097359"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">,</span><span> </span><a href="System.IO.Binary.html#BinaryConvertible"><span class="hs-identifier hs-type">BinaryConvertible</span></a><span> </span><a href="#local-6989586621679097360"><span class="hs-identifier hs-type">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><a name="line-231"></a><span>                     </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">[</span><a href="#local-6989586621679097359"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><a href="#local-6989586621679097360"><span class="hs-identifier hs-type">c</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-232"></a><a name="fullBlockInteract"><a href="System.IO.Binary.html#fullBlockInteract"><span class="hs-identifier">fullBlockInteract</span></a></a><span> </span><a name="local-6989586621679097409"><a href="#local-6989586621679097409"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.IO.Binary.html#hFullBlockInteract"><span class="hs-identifier hs-var">hFullBlockInteract</span></a><span> </span><a href="#local-6989586621679097409"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-identifier hs-var">stdin</span><span> </span><span class="hs-identifier hs-var">stdout</span><span>
</span><a name="line-233"></a><span>
</span><a name="line-234"></a><span class="hs-identifier">hBlockInteractUtil</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="System.IO.HVIO.html#HVIO"><span class="hs-identifier hs-type">HVIO</span></a><span> </span><a href="#local-6989586621679097355"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="System.IO.HVIO.html#HVIO"><span class="hs-identifier hs-type">HVIO</span></a><span> </span><a href="#local-6989586621679097356"><span class="hs-identifier hs-type">d</span></a><span class="hs-special">,</span><span> </span><a href="System.IO.Binary.html#BinaryConvertible"><span class="hs-identifier hs-type">BinaryConvertible</span></a><span> </span><a href="#local-6989586621679097357"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">,</span><span> </span><a href="System.IO.Binary.html#BinaryConvertible"><span class="hs-identifier hs-type">BinaryConvertible</span></a><span> </span><a href="#local-6989586621679097358"><span class="hs-identifier hs-type">c</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><a name="line-235"></a><span>                      </span><span class="hs-special">(</span><a href="#local-6989586621679097355"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><a href="#local-6989586621679097357"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-236"></a><span>                      </span><a href="#local-6989586621679097355"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679097356"><span class="hs-identifier hs-type">d</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">[</span><a href="#local-6989586621679097357"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><a href="#local-6989586621679097358"><span class="hs-identifier hs-type">c</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-237"></a><a name="hBlockInteractUtil"><a href="System.IO.Binary.html#hBlockInteractUtil"><span class="hs-identifier">hBlockInteractUtil</span></a></a><span> </span><a name="local-6989586621679097410"><a href="#local-6989586621679097410"><span class="hs-identifier">blockreader</span></a></a><span> </span><a name="local-6989586621679097411"><a href="#local-6989586621679097411"><span class="hs-identifier">blocksize</span></a></a><span> </span><a name="local-6989586621679097412"><a href="#local-6989586621679097412"><span class="hs-identifier">hin</span></a></a><span> </span><a name="local-6989586621679097413"><a href="#local-6989586621679097413"><span class="hs-identifier">hout</span></a></a><span> </span><a name="local-6989586621679097414"><a href="#local-6989586621679097414"><span class="hs-identifier">func</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-238"></a><span>    </span><span class="hs-keyword">do</span><span>
</span><a name="line-239"></a><span>    </span><a name="local-6989586621679097415"><a href="#local-6989586621679097415"><span class="hs-identifier">blocks</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679097410"><span class="hs-identifier hs-var">blockreader</span></a><span> </span><a href="#local-6989586621679097412"><span class="hs-identifier hs-var">hin</span></a><span> </span><a href="#local-6989586621679097411"><span class="hs-identifier hs-var">blocksize</span></a><span>
</span><a name="line-240"></a><span>    </span><a href="System.IO.Binary.html#hPutBlocks"><span class="hs-identifier hs-var">hPutBlocks</span></a><span> </span><a href="#local-6989586621679097413"><span class="hs-identifier hs-var">hout</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679097414"><span class="hs-identifier hs-var">func</span></a><span> </span><a href="#local-6989586621679097415"><span class="hs-identifier hs-var">blocks</span></a><span class="hs-special">)</span><span>
</span><a name="line-241"></a><span>
</span><a name="line-242"></a><span class="hs-comment">{- | Copies everything from the input handle to the output handle using binary
blocks of the given size.  This was once the following
beautiful implementation:

&gt; hBlockCopy bs hin hout = hBlockInteract bs hin hout id

('id' is the built-in Haskell function that just returns whatever is given
to it)

In more recent versions of MissingH, it uses a more optimized routine that
avoids ever having to convert the binary buffer at all.
-}</span><span>
</span><a name="line-254"></a><span class="hs-identifier">hBlockCopy</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="System.IO.HVIO.html#HVIO"><span class="hs-identifier hs-type">HVIO</span></a><span> </span><a href="#local-6989586621679097353"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="System.IO.HVIO.html#HVIO"><span class="hs-identifier hs-type">HVIO</span></a><span> </span><a href="#local-6989586621679097354"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679097353"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679097354"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-255"></a><a name="hBlockCopy"><a href="System.IO.Binary.html#hBlockCopy"><span class="hs-identifier">hBlockCopy</span></a></a><span> </span><a name="local-6989586621679097416"><a href="#local-6989586621679097416"><span class="hs-identifier">bs</span></a></a><span> </span><a name="local-6989586621679097417"><a href="#local-6989586621679097417"><span class="hs-identifier">hin</span></a></a><span> </span><a name="local-6989586621679097418"><a href="#local-6989586621679097418"><span class="hs-identifier">hout</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-256"></a><span>    </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679097422"><a href="#local-6989586621679097422"><span class="hs-identifier">fbuf</span></a></a><span class="hs-glyph">::</span><span class="hs-identifier hs-type">ForeignPtr</span><span> </span><span class="hs-identifier hs-type">CChar</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">mallocForeignPtrArray</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679097416"><span class="hs-identifier hs-var">bs</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span>
</span><a name="line-257"></a><span>       </span><span class="hs-identifier hs-var">withForeignPtr</span><span> </span><a href="#local-6989586621679097422"><span class="hs-identifier hs-var">fbuf</span></a><span> </span><a href="#local-6989586621679097419"><span class="hs-identifier hs-var">handler</span></a><span>
</span><a name="line-258"></a><span>    </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679097419"><a href="#local-6989586621679097419"><span class="hs-identifier">handler</span></a></a><span> </span><a name="local-6989586621679097420"><a href="#local-6989586621679097420"><span class="hs-identifier">ptr</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-259"></a><span>              </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621679097421"><a href="#local-6989586621679097421"><span class="hs-identifier">bytesread</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="System.IO.HVIO.html#vGetBuf"><span class="hs-identifier hs-var">vGetBuf</span></a><span> </span><a href="#local-6989586621679097417"><span class="hs-identifier hs-var">hin</span></a><span> </span><a href="#local-6989586621679097420"><span class="hs-identifier hs-var">ptr</span></a><span> </span><a href="#local-6989586621679097416"><span class="hs-identifier hs-var">bs</span></a><span>
</span><a name="line-260"></a><span>                 </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679097421"><span class="hs-identifier hs-var">bytesread</span></a><span> </span><span class="hs-operator hs-var">&gt;</span><span> </span><span class="hs-number">0</span><span>
</span><a name="line-261"></a><span>                    </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span> </span><a href="System.IO.HVIO.html#vPutBuf"><span class="hs-identifier hs-var">vPutBuf</span></a><span> </span><a href="#local-6989586621679097418"><span class="hs-identifier hs-var">hout</span></a><span> </span><a href="#local-6989586621679097420"><span class="hs-identifier hs-var">ptr</span></a><span> </span><a href="#local-6989586621679097421"><span class="hs-identifier hs-var">bytesread</span></a><span>
</span><a name="line-262"></a><span>                            </span><a href="#local-6989586621679097419"><span class="hs-identifier hs-var">handler</span></a><span> </span><a href="#local-6989586621679097420"><span class="hs-identifier hs-var">ptr</span></a><span>
</span><a name="line-263"></a><span>                    </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-264"></a><span>
</span><a name="line-265"></a><span class="hs-comment">{- | Copies from 'stdin' to 'stdout' using binary blocks of the given size.
An alias for 'hBlockCopy' over 'stdin' and 'stdout'
-}</span><span>
</span><a name="line-268"></a><span class="hs-identifier">blockCopy</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-269"></a><a name="blockCopy"><a href="System.IO.Binary.html#blockCopy"><span class="hs-identifier">blockCopy</span></a></a><span> </span><a name="local-6989586621679097423"><a href="#local-6989586621679097423"><span class="hs-identifier">bs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.IO.Binary.html#hBlockCopy"><span class="hs-identifier hs-var">hBlockCopy</span></a><span> </span><a href="#local-6989586621679097423"><span class="hs-identifier hs-var">bs</span></a><span> </span><span class="hs-identifier hs-var">stdin</span><span> </span><span class="hs-identifier hs-var">stdout</span><span>
</span><a name="line-270"></a><span>
</span><a name="line-271"></a><span class="hs-comment">{- | Copies one filename to another in binary mode.

Please note that the Unix permission bits on the output file cannot
be set due to a limitation of the Haskell 'System.IO.openBinaryFile'
function.  Therefore, you may need to adjust those bits after the copy
yourself.

This function is implemented using 'hBlockCopy' internally. -}</span><span>
</span><a name="line-279"></a><span class="hs-identifier">copyFileBlocksToFile</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">FilePath</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">FilePath</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-280"></a><a name="copyFileBlocksToFile"><a href="System.IO.Binary.html#copyFileBlocksToFile"><span class="hs-identifier">copyFileBlocksToFile</span></a></a><span> </span><a name="local-6989586621679097424"><a href="#local-6989586621679097424"><span class="hs-identifier">bs</span></a></a><span> </span><a name="local-6989586621679097425"><a href="#local-6989586621679097425"><span class="hs-identifier">infn</span></a></a><span> </span><a name="local-6989586621679097426"><a href="#local-6989586621679097426"><span class="hs-identifier">outfn</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-281"></a><span>                                     </span><a name="local-6989586621679097427"><a href="#local-6989586621679097427"><span class="hs-identifier">hin</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">openBinaryFile</span><span> </span><a href="#local-6989586621679097425"><span class="hs-identifier hs-var">infn</span></a><span> </span><span class="hs-identifier hs-var">ReadMode</span><span>
</span><a name="line-282"></a><span>                                     </span><a name="local-6989586621679097428"><a href="#local-6989586621679097428"><span class="hs-identifier">hout</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">openBinaryFile</span><span> </span><a href="#local-6989586621679097426"><span class="hs-identifier hs-var">outfn</span></a><span> </span><span class="hs-identifier hs-var">WriteMode</span><span>
</span><a name="line-283"></a><span>                                     </span><a href="System.IO.Binary.html#hBlockCopy"><span class="hs-identifier hs-var">hBlockCopy</span></a><span> </span><a href="#local-6989586621679097424"><span class="hs-identifier hs-var">bs</span></a><span> </span><a href="#local-6989586621679097427"><span class="hs-identifier hs-var">hin</span></a><span> </span><a href="#local-6989586621679097428"><span class="hs-identifier hs-var">hout</span></a><span>
</span><a name="line-284"></a><span>                                     </span><span class="hs-identifier hs-var">hClose</span><span> </span><a href="#local-6989586621679097427"><span class="hs-identifier hs-var">hin</span></a><span>
</span><a name="line-285"></a><span>                                     </span><span class="hs-identifier hs-var">hClose</span><span> </span><a href="#local-6989586621679097428"><span class="hs-identifier hs-var">hout</span></a><span>
</span><a name="line-286"></a><span>                                     </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-287"></a><span>
</span><a name="line-288"></a><span class="hs-comment">{- | Like the built-in 'readFile', but opens the file in binary instead
of text mode. -}</span><span>
</span><a name="line-290"></a><span class="hs-identifier">readBinaryFile</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">FilePath</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-291"></a><a name="readBinaryFile"><a href="System.IO.Binary.html#readBinaryFile"><span class="hs-identifier">readBinaryFile</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.IO.Binary.html#vReadBinaryFile"><span class="hs-identifier hs-var">vReadBinaryFile</span></a><span> </span><a href="System.IO.HVFS.html#SystemFS"><span class="hs-identifier hs-var">SystemFS</span></a><span>
</span><a name="line-292"></a><span>
</span><a name="line-293"></a><span class="hs-comment">{- | Same as 'readBinaryFile', but works with HVFS objects. -}</span><span>
</span><a name="line-294"></a><span class="hs-identifier">vReadBinaryFile</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="System.IO.HVFS.html#HVFSOpenable"><span class="hs-identifier hs-type">HVFSOpenable</span></a><span> </span><a href="#local-6989586621679097352"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679097352"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">FilePath</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-295"></a><a name="vReadBinaryFile"><a href="System.IO.Binary.html#vReadBinaryFile"><span class="hs-identifier">vReadBinaryFile</span></a></a><span> </span><a name="local-6989586621679097429"><a href="#local-6989586621679097429"><span class="hs-identifier">fs</span></a></a><span> </span><a name="local-6989586621679097430"><a href="#local-6989586621679097430"><span class="hs-identifier">fp</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-296"></a><span>    </span><a href="System.IO.HVFS.html#vOpenBinaryFile"><span class="hs-identifier hs-var">vOpenBinaryFile</span></a><span> </span><a href="#local-6989586621679097429"><span class="hs-identifier hs-var">fs</span></a><span> </span><a href="#local-6989586621679097430"><span class="hs-identifier hs-var">fp</span></a><span> </span><span class="hs-identifier hs-var">ReadMode</span><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><a href="System.IO.HVFS.html#HVFSOpenEncap"><span class="hs-identifier hs-var">HVFSOpenEncap</span></a><span> </span><a name="local-6989586621679097431"><a href="#local-6989586621679097431"><span class="hs-identifier">h</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="System.IO.HVIO.html#vGetContents"><span class="hs-identifier hs-var">vGetContents</span></a><span> </span><a href="#local-6989586621679097431"><span class="hs-identifier hs-var">h</span></a><span class="hs-special">)</span><span>
</span><a name="line-297"></a><span>
</span><a name="line-298"></a><span class="hs-comment">{- | Like the built-in 'writeFile', but opens the file in binary instead
of text mode. -}</span><span>
</span><a name="line-300"></a><span class="hs-identifier">writeBinaryFile</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">FilePath</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-301"></a><a name="writeBinaryFile"><a href="System.IO.Binary.html#writeBinaryFile"><span class="hs-identifier">writeBinaryFile</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.IO.Binary.html#vWriteBinaryFile"><span class="hs-identifier hs-var">vWriteBinaryFile</span></a><span> </span><a href="System.IO.HVFS.html#SystemFS"><span class="hs-identifier hs-var">SystemFS</span></a><span>
</span><a name="line-302"></a><span>
</span><a name="line-303"></a><span class="hs-comment">{- | Like 'writeBinaryFile', but works on HVFS objects. -}</span><span>
</span><a name="line-304"></a><span class="hs-identifier">vWriteBinaryFile</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="System.IO.HVFS.html#HVFSOpenable"><span class="hs-identifier hs-type">HVFSOpenable</span></a><span> </span><a href="#local-6989586621679097351"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679097351"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">FilePath</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-305"></a><a name="vWriteBinaryFile"><a href="System.IO.Binary.html#vWriteBinaryFile"><span class="hs-identifier">vWriteBinaryFile</span></a></a><span> </span><a name="local-6989586621679097432"><a href="#local-6989586621679097432"><span class="hs-identifier">fs</span></a></a><span> </span><a name="local-6989586621679097433"><a href="#local-6989586621679097433"><span class="hs-identifier">name</span></a></a><span> </span><a name="local-6989586621679097434"><a href="#local-6989586621679097434"><span class="hs-identifier">str</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-306"></a><span>    </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621679097435"><a href="#local-6989586621679097435"><span class="hs-identifier">h</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="System.IO.HVFS.html#vOpenBinaryFile"><span class="hs-identifier hs-var">vOpenBinaryFile</span></a><span> </span><a href="#local-6989586621679097432"><span class="hs-identifier hs-var">fs</span></a><span> </span><a href="#local-6989586621679097433"><span class="hs-identifier hs-var">name</span></a><span> </span><span class="hs-identifier hs-var">WriteMode</span><span>
</span><a name="line-307"></a><span>       </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679097435"><span class="hs-identifier hs-var">h</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-308"></a><span>              </span><a href="System.IO.HVFS.html#HVFSOpenEncap"><span class="hs-identifier hs-var">HVFSOpenEncap</span></a><span> </span><a name="local-6989586621679097436"><a href="#local-6989586621679097436"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span> </span><a href="System.IO.HVIO.html#vPutStr"><span class="hs-identifier hs-var">vPutStr</span></a><span> </span><a href="#local-6989586621679097436"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679097434"><span class="hs-identifier hs-var">str</span></a><span>
</span><a name="line-309"></a><span>                                    </span><a href="System.IO.HVIO.html#vClose"><span class="hs-identifier hs-var">vClose</span></a><span> </span><a href="#local-6989586621679097436"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-310"></a></pre></body></html>