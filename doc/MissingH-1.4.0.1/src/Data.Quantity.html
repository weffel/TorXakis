<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE Safe #-}</span><span>
</span><a name="line-2"></a><span class="hs-comment">{-
Copyright (c) 2006-2011 John Goerzen &lt;jgoerzen@complete.org&gt;

All rights reserved.

For license and copyright information, see the file LICENSE
-}</span><span>
</span><a name="line-9"></a><span>
</span><a name="line-10"></a><span class="hs-comment">{- |
   Module     : Data.Quantity
   Copyright  : Copyright (C) 2006-2011 John Goerzen
   License    : BSD3

   Maintainer : John Goerzen &lt;jgoerzen@complete.org&gt; 
   Stability  : provisional
   Portability: portable

Tools for rendering sizes

Written by John Goerzen, jgoerzen\@complete.org -}</span><span>
</span><a name="line-22"></a><span>
</span><a name="line-23"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Quantity</span><span> </span><span class="hs-special">(</span><span>
</span><a name="line-24"></a><span>                          </span><a href="Data.Quantity.html#renderNum"><span class="hs-identifier hs-var">renderNum</span></a><span class="hs-special">,</span><span>
</span><a name="line-25"></a><span>                          </span><a href="Data.Quantity.html#renderNums"><span class="hs-identifier hs-var">renderNums</span></a><span class="hs-special">,</span><span>
</span><a name="line-26"></a><span>                          </span><a href="Data.Quantity.html#parseNum"><span class="hs-identifier hs-var">parseNum</span></a><span class="hs-special">,</span><span>
</span><a name="line-27"></a><span>                          </span><a href="Data.Quantity.html#parseNumInt"><span class="hs-identifier hs-var">parseNumInt</span></a><span class="hs-special">,</span><span>
</span><a name="line-28"></a><span>                          </span><a href="Data.Quantity.html#quantifyNum"><span class="hs-identifier hs-var">quantifyNum</span></a><span class="hs-special">,</span><span>
</span><a name="line-29"></a><span>                          </span><a href="Data.Quantity.html#quantifyNums"><span class="hs-identifier hs-var">quantifyNums</span></a><span class="hs-special">,</span><span>
</span><a name="line-30"></a><span>                          </span><a href="Data.Quantity.html#SizeOpts"><span class="hs-identifier hs-type">SizeOpts</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-31"></a><span>                          </span><a href="Data.Quantity.html#binaryOpts"><span class="hs-identifier hs-var">binaryOpts</span></a><span class="hs-special">,</span><span>
</span><a name="line-32"></a><span>                          </span><a href="Data.Quantity.html#siOpts"><span class="hs-identifier hs-var">siOpts</span></a><span>
</span><a name="line-33"></a><span>                     </span><span class="hs-special">)</span><span>
</span><a name="line-34"></a><span>
</span><a name="line-35"></a><span class="hs-keyword">where</span><span>
</span><a name="line-36"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">List</span><span>
</span><a name="line-37"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Text</span><span class="hs-operator">.</span><span class="hs-identifier">Printf</span><span>
</span><a name="line-38"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Char</span><span>
</span><a name="line-39"></a><span>
</span><a name="line-40"></a><span class="hs-comment">{- | The options for 'quantifyNum' and 'renderNum' -}</span><span>
</span><a name="line-41"></a><span class="hs-keyword">data</span><span> </span><a name="SizeOpts"><a href="Data.Quantity.html#SizeOpts"><span class="hs-identifier">SizeOpts</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="SizeOpts"><a href="Data.Quantity.html#SizeOpts"><span class="hs-identifier">SizeOpts</span></a></a><span> </span><span class="hs-special">{</span><span> </span><a name="base"><a href="Data.Quantity.html#base"><span class="hs-identifier">base</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span class="hs-special">,</span><span> </span><span class="hs-comment">-- ^ The base from which calculations are made</span><span>
</span><a name="line-42"></a><span>                           </span><a name="powerIncr"><a href="Data.Quantity.html#powerIncr"><span class="hs-identifier">powerIncr</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span class="hs-special">,</span><span> </span><span class="hs-comment">-- ^ The increment to the power for each new suffix</span><span>
</span><a name="line-43"></a><span>                           </span><a name="firstPower"><a href="Data.Quantity.html#firstPower"><span class="hs-identifier">firstPower</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span class="hs-special">,</span><span> </span><span class="hs-comment">-- ^ The first power for which suffixes are given</span><span>
</span><a name="line-44"></a><span>                           </span><a name="suffixes"><a href="Data.Quantity.html#suffixes"><span class="hs-identifier">suffixes</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-comment">-- ^ The suffixes themselves</span><span>
</span><a name="line-45"></a><span>                         </span><span class="hs-special">}</span><span>
</span><a name="line-46"></a><span>                           </span><span>
</span><a name="line-47"></a><span class="hs-comment">{- | Predefined definitions for byte measurement in groups of 1024, from 0 to
2**80 -}</span><span>
</span><a name="line-49"></a><span class="hs-identifier">binaryOpts</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Quantity.html#SizeOpts"><span class="hs-identifier hs-type">SizeOpts</span></a><span>
</span><a name="line-50"></a><a name="binaryOpts"><a href="Data.Quantity.html#binaryOpts"><span class="hs-identifier">binaryOpts</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Quantity.html#SizeOpts"><span class="hs-identifier hs-var">SizeOpts</span></a><span> </span><span class="hs-special">{</span><span class="hs-identifier">base</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">2</span><span class="hs-special">,</span><span>
</span><a name="line-51"></a><span>                       </span><span class="hs-identifier">firstPower</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">0</span><span class="hs-special">,</span><span>
</span><a name="line-52"></a><span>                       </span><span class="hs-identifier">suffixes</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot; KMGTPEZY&quot;</span><span class="hs-special">,</span><span>
</span><a name="line-53"></a><span>                       </span><span class="hs-identifier">powerIncr</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">10</span><span class="hs-special">}</span><span>
</span><a name="line-54"></a><span>
</span><a name="line-55"></a><span class="hs-comment">{- | Predefined definitions for SI measurement, from 10**-24 to 10**24. -}</span><span>
</span><a name="line-56"></a><span class="hs-identifier">siOpts</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.Quantity.html#SizeOpts"><span class="hs-identifier hs-type">SizeOpts</span></a><span>
</span><a name="line-57"></a><a name="siOpts"><a href="Data.Quantity.html#siOpts"><span class="hs-identifier">siOpts</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.Quantity.html#SizeOpts"><span class="hs-identifier hs-var">SizeOpts</span></a><span> </span><span class="hs-special">{</span><span class="hs-identifier">base</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">10</span><span class="hs-special">,</span><span>
</span><a name="line-58"></a><span>                   </span><span class="hs-identifier">firstPower</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">-</span><span class="hs-number">24</span><span class="hs-special">,</span><span>
</span><a name="line-59"></a><span>                   </span><span class="hs-identifier">suffixes</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;yzafpnum kMGTPEZY&quot;</span><span class="hs-special">,</span><span>
</span><a name="line-60"></a><span>                   </span><span class="hs-identifier">powerIncr</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">3</span><span class="hs-special">}</span><span>
</span><a name="line-61"></a><span>
</span><a name="line-62"></a><span class="hs-comment">{- | Takes a number and returns a new (quantity, suffix) combination.
The space character is used as the suffix for items around 0. -}</span><span>
</span><a name="line-64"></a><span class="hs-identifier">quantifyNum</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679060891"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Real</span><span> </span><a href="#local-6989586621679060891"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Floating</span><span> </span><a href="#local-6989586621679060892"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679060892"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Data.Quantity.html#SizeOpts"><span class="hs-identifier hs-type">SizeOpts</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679060891"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679060892"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Char</span><span class="hs-special">)</span><span>
</span><a name="line-65"></a><a name="quantifyNum"><a href="Data.Quantity.html#quantifyNum"><span class="hs-identifier">quantifyNum</span></a></a><span> </span><a name="local-6989586621679060893"><a href="#local-6989586621679060893"><span class="hs-identifier">opts</span></a></a><span> </span><a name="local-6989586621679060894"><a href="#local-6989586621679060894"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><a name="local-6989586621679060895"><a href="#local-6989586621679060895"><span class="hs-identifier">x</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679060896"><a href="#local-6989586621679060896"><span class="hs-identifier">s</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">head</span><span> </span><a href="#local-6989586621679060895"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679060896"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Data.Quantity.html#quantifyNums"><span class="hs-identifier hs-var">quantifyNums</span></a><span> </span><a href="#local-6989586621679060893"><span class="hs-identifier hs-var">opts</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679060894"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">]</span><span>
</span><a name="line-66"></a><span>
</span><a name="line-67"></a><span class="hs-comment">{- | Like 'quantifyNum', but takes a list of numbers.  The first number in
the list will be evaluated for the suffix.  The same suffix and scale will
be used for the remaining items in the list.  Please see 'renderNums' for
an example of how this works.

It is invalid to use this function on an empty list. -}</span><span>
</span><a name="line-73"></a><span class="hs-identifier">quantifyNums</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679060889"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Real</span><span> </span><a href="#local-6989586621679060889"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Floating</span><span> </span><a href="#local-6989586621679060890"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679060890"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Data.Quantity.html#SizeOpts"><span class="hs-identifier hs-type">SizeOpts</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679060889"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="#local-6989586621679060890"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Char</span><span class="hs-special">)</span><span>
</span><a name="line-74"></a><a name="quantifyNums"><a href="Data.Quantity.html#quantifyNums"><span class="hs-identifier">quantifyNums</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-string">&quot;Attempt to use quantifyNums on an empty list&quot;</span><span>
</span><a name="line-75"></a><span class="hs-identifier">quantifyNums</span><span> </span><a name="local-6989586621679060897"><a href="#local-6989586621679060897"><span class="hs-identifier">opts</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679060898"><a href="#local-6989586621679060898"><span class="hs-identifier">headnum</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679060899"><a href="#local-6989586621679060899"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-76"></a><span>    </span><span class="hs-special">(</span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679060914"><a href="#local-6989586621679060914"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679060908"><span class="hs-identifier hs-var">procnum</span></a><span> </span><a href="#local-6989586621679060914"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679060898"><span class="hs-identifier hs-var">headnum</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679060899"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679060907"><span class="hs-identifier hs-var">suffix</span></a><span class="hs-special">)</span><span>
</span><a name="line-77"></a><span>    </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679060900"><a href="#local-6989586621679060900"><span class="hs-identifier">number</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">fromRational</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">toRational</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679060898"><span class="hs-identifier hs-var">headnum</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-78"></a><span>                     </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-number">1</span><span>
</span><a name="line-79"></a><span>                     </span><a name="local-6989586621679060909"><a href="#local-6989586621679060909"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679060909"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-80"></a><span>          </span><a name="local-6989586621679060901"><a href="#local-6989586621679060901"><span class="hs-identifier">incrList</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><a href="#local-6989586621679060903"><span class="hs-identifier hs-var">idx2pwr</span></a><span> </span><span class="hs-special">[</span><span class="hs-number">0</span><span class="hs-glyph">..</span><span class="hs-identifier hs-var">length</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">suffixes</span><span> </span><a href="#local-6989586621679060897"><span class="hs-identifier hs-var">opts</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-number">1</span><span class="hs-special">]</span><span>
</span><a name="line-81"></a><span>          </span><a name="local-6989586621679060902"><a href="#local-6989586621679060902"><span class="hs-identifier">incrIdxList</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">zip</span><span> </span><a href="#local-6989586621679060901"><span class="hs-identifier hs-var">incrList</span></a><span> </span><span class="hs-special">[</span><span class="hs-number">0</span><span class="hs-glyph">..</span><span class="hs-special">]</span><span>
</span><a name="line-82"></a><span>          </span><a name="local-6989586621679060903"><a href="#local-6989586621679060903"><span class="hs-identifier">idx2pwr</span></a></a><span> </span><a name="local-6989586621679060910"><a href="#local-6989586621679060910"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679060910"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-operator hs-var">*</span><span> </span><span class="hs-identifier">powerIncr</span><span> </span><a href="#local-6989586621679060897"><span class="hs-identifier hs-var">opts</span></a><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-identifier">firstPower</span><span> </span><a href="#local-6989586621679060897"><span class="hs-identifier hs-var">opts</span></a><span>
</span><a name="line-83"></a><span>          </span><a name="local-6989586621679060904"><a href="#local-6989586621679060904"><span class="hs-identifier">finderfunc</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679060911"><a href="#local-6989586621679060911"><span class="hs-identifier">x</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">base</span><span> </span><a href="#local-6989586621679060897"><span class="hs-identifier hs-var">opts</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">**</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><a href="#local-6989586621679060911"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><span>
</span><a name="line-84"></a><span>                              </span><span class="hs-operator hs-var">&lt;=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">abs</span><span> </span><a href="#local-6989586621679060900"><span class="hs-identifier hs-var">number</span></a><span class="hs-special">)</span><span>
</span><a name="line-85"></a><span>          </span><span class="hs-comment">-- Find the largest item that does not exceed the number given.</span><span>
</span><a name="line-86"></a><span>          </span><span class="hs-comment">-- If the number is larger than the larger item in the list,</span><span>
</span><a name="line-87"></a><span>          </span><span class="hs-comment">-- that's fine; we'll just write it in terms of what we have.</span><span>
</span><a name="line-88"></a><span>
</span><a name="line-89"></a><span>          </span><span class="hs-special">(</span><a name="local-6989586621679060905"><a href="#local-6989586621679060905"><span class="hs-identifier">usedexp</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679060906"><a href="#local-6989586621679060906"><span class="hs-identifier">expidx</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-90"></a><span>              </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">find</span><span> </span><a href="#local-6989586621679060904"><span class="hs-identifier hs-var">finderfunc</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">reverse</span><span> </span><a href="#local-6989586621679060902"><span class="hs-identifier hs-var">incrIdxList</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-91"></a><span>                  </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679060912"><a href="#local-6989586621679060912"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679060912"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-92"></a><span>                  </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">head</span><span> </span><a href="#local-6989586621679060902"><span class="hs-identifier hs-var">incrIdxList</span></a><span> </span><span class="hs-comment">-- If not found, it's smaller than the first</span><span>
</span><a name="line-93"></a><span>          </span><a name="local-6989586621679060907"><a href="#local-6989586621679060907"><span class="hs-identifier">suffix</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">suffixes</span><span> </span><a href="#local-6989586621679060897"><span class="hs-identifier hs-var">opts</span></a><span> </span><span class="hs-operator hs-var">!!</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><a href="#local-6989586621679060906"><span class="hs-identifier hs-var">expidx</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-94"></a><span>          </span><a name="local-6989586621679060908"><a href="#local-6989586621679060908"><span class="hs-identifier">procnum</span></a></a><span> </span><a name="local-6989586621679060913"><a href="#local-6989586621679060913"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromRational</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">toRational</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679060913"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">/</span><span>
</span><a name="line-95"></a><span>                      </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">base</span><span> </span><a href="#local-6989586621679060897"><span class="hs-identifier hs-var">opts</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">**</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><a href="#local-6989586621679060905"><span class="hs-identifier hs-var">usedexp</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-96"></a><span>          </span><span class="hs-comment">--(posres, possuf) = quantifyNum opts (headnum * (-1))</span><span>
</span><a name="line-97"></a><span>
</span><a name="line-98"></a><span class="hs-comment">{- | Render a number into a string, based on the given quantities.  This is
useful for displaying quantities in terms of bytes or in SI units.  Give this
function the 'SizeOpts' for the desired output, and a precision (number of
digits to the right of the decimal point), and you get a string output.

Here are some examples:

&gt; Data.Quantity&gt; renderNum binaryOpts 0 1048576
&gt; &quot;1M&quot;
&gt; Data.Quantity&gt; renderNum binaryOpts 2 10485760
&gt; &quot;10.00M&quot;
&gt; Data.Quantity&gt; renderNum binaryOpts 3 1048576
&gt; &quot;1.000M&quot;
&gt; Data.Quantity&gt; renderNum binaryOpts 3 1500000
&gt; &quot;1.431M&quot;
&gt; Data.Quantity&gt; renderNum binaryOpts 2 (1500 ** 3)
&gt; &quot;3.14G&quot;

&gt; Data.Quantity&gt; renderNum siOpts 2 1024
&gt; &quot;1.02k&quot;
&gt; Data.Quantity&gt; renderNum siOpts 2 1048576
&gt; &quot;1.05M&quot;
&gt; Data.Quantity&gt; renderNum siOpts 2 0.001
&gt; &quot;1.00m&quot;
&gt; Data.Quantity&gt; renderNum siOpts 2 0.0001
&gt; &quot;100.00u&quot;

If you want more control over the output, see 'quantifyNum'. -}</span><span>
</span><a name="line-126"></a><span class="hs-identifier">renderNum</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679060888"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Real</span><span> </span><a href="#local-6989586621679060888"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span>
</span><a name="line-127"></a><span>             </span><a href="Data.Quantity.html#SizeOpts"><span class="hs-identifier hs-type">SizeOpts</span></a><span>
</span><a name="line-128"></a><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span>                </span><span class="hs-comment">-- ^ Precision of the result</span><span>
</span><a name="line-129"></a><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679060888"><span class="hs-identifier hs-type">a</span></a><span>                  </span><span class="hs-comment">-- ^ The number to examine</span><span>
</span><a name="line-130"></a><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-131"></a><a name="renderNum"><a href="Data.Quantity.html#renderNum"><span class="hs-identifier">renderNum</span></a></a><span> </span><a name="local-6989586621679060915"><a href="#local-6989586621679060915"><span class="hs-identifier">opts</span></a></a><span> </span><a name="local-6989586621679060916"><a href="#local-6989586621679060916"><span class="hs-identifier">prec</span></a></a><span> </span><a name="local-6989586621679060917"><a href="#local-6989586621679060917"><span class="hs-identifier">number</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-132"></a><span>    </span><span class="hs-special">(</span><span class="hs-identifier hs-var">printf</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;%.&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679060916"><span class="hs-identifier hs-var">prec</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;g&quot;</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679060918"><span class="hs-identifier hs-var">num</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679060919"><span class="hs-identifier hs-var">suffix</span></a><span class="hs-special">]</span><span>
</span><a name="line-133"></a><span>    </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679060918"><a href="#local-6989586621679060918"><span class="hs-identifier">num</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679060919"><a href="#local-6989586621679060919"><span class="hs-identifier">suffix</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="Data.Quantity.html#quantifyNum"><span class="hs-identifier hs-var">quantifyNum</span></a><span> </span><a href="#local-6989586621679060915"><span class="hs-identifier hs-var">opts</span></a><span> </span><a href="#local-6989586621679060917"><span class="hs-identifier hs-var">number</span></a><span class="hs-special">)</span><span class="hs-glyph">::</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Double</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Char</span><span class="hs-special">)</span><span>
</span><a name="line-134"></a><span>
</span><a name="line-135"></a><span class="hs-comment">{- | Like 'renderNum', but operates on a list of numbers.  The first number
in the list will be evaluated for the suffix.  The same suffix and scale will
be used for the remaining items in the list.  See 'renderNum' for more
examples.

Also, unlike 'renderNum', the %f instead of %g printf format is used so that
\&quot;scientific\&quot; notation is avoided in the output.

Examples:

&gt; *Data.Quantity&gt; renderNums binaryOpts 3 [1500000, 10240, 104857600]
&gt; [&quot;1.431M&quot;,&quot;0.010M&quot;,&quot;100.000M&quot;]
&gt; *Data.Quantity&gt; renderNums binaryOpts 3 [1500, 10240, 104857600]
&gt; [&quot;1.465K&quot;,&quot;10.000K&quot;,&quot;102400.000K&quot;]

-}</span><span>
</span><a name="line-151"></a><span class="hs-identifier">renderNums</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679060887"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Real</span><span> </span><a href="#local-6989586621679060887"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><a name="line-152"></a><span>              </span><a href="Data.Quantity.html#SizeOpts"><span class="hs-identifier hs-type">SizeOpts</span></a><span>
</span><a name="line-153"></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span>               </span><span class="hs-comment">-- ^ Prevision of the result</span><span>
</span><a name="line-154"></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679060887"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>               </span><span class="hs-comment">-- ^ The numbers to examine</span><span>
</span><a name="line-155"></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">String</span><span class="hs-special">]</span><span>          </span><span class="hs-comment">-- ^ Result</span><span>
</span><a name="line-156"></a><a name="renderNums"><a href="Data.Quantity.html#renderNums"><span class="hs-identifier">renderNums</span></a></a><span> </span><a name="local-6989586621679060920"><a href="#local-6989586621679060920"><span class="hs-identifier">opts</span></a></a><span> </span><a name="local-6989586621679060921"><a href="#local-6989586621679060921"><span class="hs-identifier">prec</span></a></a><span> </span><a name="local-6989586621679060922"><a href="#local-6989586621679060922"><span class="hs-identifier">numbers</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-157"></a><span>    </span><span class="hs-identifier hs-var">map</span><span> </span><a href="#local-6989586621679060923"><span class="hs-identifier hs-var">printit</span></a><span> </span><a href="#local-6989586621679060924"><span class="hs-identifier hs-var">convnums</span></a><span>
</span><a name="line-158"></a><span>    </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679060923"><a href="#local-6989586621679060923"><span class="hs-identifier">printit</span></a></a><span> </span><a name="local-6989586621679060926"><a href="#local-6989586621679060926"><span class="hs-identifier">num</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-159"></a><span>              </span><span class="hs-special">(</span><span class="hs-identifier hs-var">printf</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;%.&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679060921"><span class="hs-identifier hs-var">prec</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;f&quot;</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679060926"><span class="hs-identifier hs-var">num</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679060925"><span class="hs-identifier hs-var">suffix</span></a><span class="hs-special">]</span><span>
</span><a name="line-160"></a><span>          </span><span class="hs-special">(</span><a name="local-6989586621679060924"><a href="#local-6989586621679060924"><span class="hs-identifier">convnums</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679060925"><a href="#local-6989586621679060925"><span class="hs-identifier">suffix</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span>
</span><a name="line-161"></a><span>              </span><span class="hs-special">(</span><a href="Data.Quantity.html#quantifyNums"><span class="hs-identifier hs-var">quantifyNums</span></a><span> </span><a href="#local-6989586621679060920"><span class="hs-identifier hs-var">opts</span></a><span> </span><a href="#local-6989586621679060922"><span class="hs-identifier hs-var">numbers</span></a><span class="hs-special">)</span><span class="hs-glyph">::</span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-identifier hs-type">Double</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Char</span><span class="hs-special">)</span><span>
</span><a name="line-162"></a><span>
</span><a name="line-163"></a><span class="hs-comment">{- | Parses a String, possibly generated by 'renderNum'.  Parses the suffix
and applies it to the number, which is read via the Read class.

Returns Left &quot;error message&quot; on error, or Right number on successful parse.

If you want an Integral result, the convenience function 'parseNumInt' is for
you.
-}</span><span>
</span><a name="line-171"></a><span class="hs-identifier">parseNum</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Read</span><span> </span><a href="#local-6989586621679060886"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Fractional</span><span> </span><a href="#local-6989586621679060886"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span>
</span><a name="line-172"></a><span>            </span><a href="Data.Quantity.html#SizeOpts"><span class="hs-identifier hs-type">SizeOpts</span></a><span>            </span><span class="hs-comment">-- ^ Information on how to parse this data</span><span>
</span><a name="line-173"></a><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>                </span><span class="hs-comment">-- ^ Whether to perform a case-insensitive match</span><span>
</span><a name="line-174"></a><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span>              </span><span class="hs-comment">-- ^ The string to parse</span><span>
</span><a name="line-175"></a><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Either</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><a href="#local-6989586621679060886"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-176"></a><a name="parseNum"><a href="Data.Quantity.html#parseNum"><span class="hs-identifier">parseNum</span></a></a><span> </span><a name="local-6989586621679060927"><a href="#local-6989586621679060927"><span class="hs-identifier">opts</span></a></a><span> </span><a name="local-6989586621679060928"><a href="#local-6989586621679060928"><span class="hs-identifier">insensitive</span></a></a><span> </span><a name="local-6989586621679060929"><a href="#local-6989586621679060929"><span class="hs-identifier">inp</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-177"></a><span>    </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">reads</span><span> </span><a href="#local-6989586621679060929"><span class="hs-identifier hs-var">inp</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-178"></a><span>      </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Left</span><span> </span><span class="hs-string">&quot;Couldn't parse numeric component of input&quot;</span><span>
</span><a name="line-179"></a><span>      </span><span class="hs-special">[</span><span class="hs-special">(</span><a name="local-6989586621679060936"><a href="#local-6989586621679060936"><span class="hs-identifier">num</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;&quot;</span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Right</span><span> </span><a href="#local-6989586621679060936"><span class="hs-identifier hs-var">num</span></a><span>  </span><span class="hs-comment">-- No suffix; pass number unhindered</span><span>
</span><a name="line-180"></a><span>      </span><span class="hs-special">[</span><span class="hs-special">(</span><a name="local-6989586621679060937"><a href="#local-6989586621679060937"><span class="hs-identifier">num</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a name="local-6989586621679060938"><a href="#local-6989586621679060938"><span class="hs-identifier">suffix</span></a></a><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-181"></a><span>          </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">lookup</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679060931"><span class="hs-identifier hs-var">caseTransformer</span></a><span> </span><a href="#local-6989586621679060938"><span class="hs-identifier hs-var">suffix</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679060930"><span class="hs-identifier hs-var">suffixMap</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-182"></a><span>            </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Left</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-string">&quot;Unrecognized suffix &quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679060938"><span class="hs-identifier hs-var">suffix</span></a><span>
</span><a name="line-183"></a><span>            </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679060939"><a href="#local-6989586621679060939"><span class="hs-identifier">power</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Right</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679060937"><span class="hs-identifier hs-var">num</span></a><span> </span><span class="hs-operator hs-var">*</span><span> </span><a href="#local-6989586621679060932"><span class="hs-identifier hs-var">multiplier</span></a><span> </span><a href="#local-6989586621679060939"><span class="hs-identifier hs-var">power</span></a><span>
</span><a name="line-184"></a><span>      </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><a name="local-6989586621679060940"><a href="#local-6989586621679060940"><span class="hs-identifier">suffix</span></a></a><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Left</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-string">&quot;Multi-character suffix &quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679060940"><span class="hs-identifier hs-var">suffix</span></a><span>
</span><a name="line-185"></a><span>      </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Left</span><span> </span><span class="hs-string">&quot;Multiple parses for input&quot;</span><span>
</span><a name="line-186"></a><span>    </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679060930"><a href="#local-6989586621679060930"><span class="hs-identifier">suffixMap</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">zip</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">map</span><span> </span><a href="#local-6989586621679060931"><span class="hs-identifier hs-var">caseTransformer</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier">suffixes</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679060927"><span class="hs-identifier hs-var">opts</span></a><span class="hs-special">)</span><span> </span><span>
</span><a name="line-187"></a><span>                          </span><span class="hs-special">(</span><span class="hs-identifier hs-var">iterate</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">powerIncr</span><span> </span><a href="#local-6989586621679060927"><span class="hs-identifier hs-var">opts</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">firstPower</span><span> </span><a href="#local-6989586621679060927"><span class="hs-identifier hs-var">opts</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-188"></a><span>          </span><a name="local-6989586621679060931"><a href="#local-6989586621679060931"><span class="hs-identifier">caseTransformer</span></a></a><span> </span><a name="local-6989586621679060934"><a href="#local-6989586621679060934"><span class="hs-identifier">x</span></a></a><span>
</span><a name="line-189"></a><span>              </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679060928"><span class="hs-identifier hs-var">insensitive</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">toLower</span><span> </span><a href="#local-6989586621679060934"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-190"></a><span>              </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679060934"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-191"></a><span>          </span><span class="hs-identifier">multiplier</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Read</span><span> </span><a href="#local-6989586621679060933"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Fractional</span><span> </span><a href="#local-6989586621679060933"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679060933"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-192"></a><span>          </span><a name="local-6989586621679060932"><a href="#local-6989586621679060932"><span class="hs-identifier">multiplier</span></a></a><span> </span><a name="local-6989586621679060935"><a href="#local-6989586621679060935"><span class="hs-identifier">power</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-193"></a><span>              </span><span class="hs-identifier hs-var">fromRational</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">toRational</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span>
</span><a name="line-194"></a><span>                           </span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">base</span><span> </span><a href="#local-6989586621679060927"><span class="hs-identifier hs-var">opts</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">**</span><span> </span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><a href="#local-6989586621679060935"><span class="hs-identifier hs-var">power</span></a><span>
</span><a name="line-195"></a><span class="hs-comment">{- | Parse a number as with 'parseNum', but return the result as
an 'Integral'.  Any type such as Integer, Int, etc. can be used for the
result type.

This function simply calls 'round' on the result of 'parseNum'.  A
'Double' is used internally for the parsing of the numeric component.

By using this function, a user can still say something like 1.5M and get an
integral result. -}</span><span>
</span><a name="line-204"></a><span class="hs-identifier">parseNumInt</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Read</span><span> </span><a href="#local-6989586621679060885"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Integral</span><span> </span><a href="#local-6989586621679060885"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span>
</span><a name="line-205"></a><span>               </span><a href="Data.Quantity.html#SizeOpts"><span class="hs-identifier hs-type">SizeOpts</span></a><span>         </span><span class="hs-comment">-- ^ Information on how to parse this data</span><span>
</span><a name="line-206"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>             </span><span class="hs-comment">-- ^ Whether to perform a case-insensitive match</span><span>
</span><a name="line-207"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span>           </span><span class="hs-comment">-- ^ The string to parse</span><span>
</span><a name="line-208"></a><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Either</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><a href="#local-6989586621679060885"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-209"></a><a name="parseNumInt"><a href="Data.Quantity.html#parseNumInt"><span class="hs-identifier">parseNumInt</span></a></a><span> </span><a name="local-6989586621679060941"><a href="#local-6989586621679060941"><span class="hs-identifier">opts</span></a></a><span> </span><a name="local-6989586621679060942"><a href="#local-6989586621679060942"><span class="hs-identifier">insensitive</span></a></a><span> </span><a name="local-6989586621679060943"><a href="#local-6989586621679060943"><span class="hs-identifier">inp</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-210"></a><span>    </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><a href="Data.Quantity.html#parseNum"><span class="hs-identifier hs-var">parseNum</span></a><span> </span><a href="#local-6989586621679060941"><span class="hs-identifier hs-var">opts</span></a><span> </span><a href="#local-6989586621679060942"><span class="hs-identifier hs-var">insensitive</span></a><span> </span><a href="#local-6989586621679060943"><span class="hs-identifier hs-var">inp</span></a><span class="hs-special">)</span><span class="hs-glyph">::</span><span class="hs-identifier hs-type">Either</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-identifier hs-type">Double</span><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-211"></a><span>      </span><span class="hs-identifier hs-var">Left</span><span> </span><a name="local-6989586621679060944"><a href="#local-6989586621679060944"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Left</span><span> </span><a href="#local-6989586621679060944"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-212"></a><span>      </span><span class="hs-identifier hs-var">Right</span><span> </span><a name="local-6989586621679060945"><a href="#local-6989586621679060945"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Right</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">round</span><span> </span><a href="#local-6989586621679060945"><span class="hs-identifier hs-var">n</span></a><span class="hs-special">)</span><span>
</span><a name="line-213"></a></pre></body></html>