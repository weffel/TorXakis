<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE Safe #-}</span><span>
</span><a name="line-2"></a><span class="hs-comment">{- arch-tag: List utilities main file
Copyright (c) 2004-2011 John Goerzen &lt;jgoerzen@complete.org&gt;

All rights reserved.

For license and copyright information, see the file LICENSE
-}</span><span>
</span><a name="line-9"></a><span>
</span><a name="line-10"></a><span class="hs-comment">{- |
   Module     : Data.List.Utils
   Copyright  : Copyright (C) 2004-2011 John Goerzen
   License    : BSD3

   Maintainer : John Goerzen &lt;jgoerzen@complete.org&gt; 
   Stability  : provisional
   Portability: portable

This module provides various helpful utilities for dealing with lists.

Written by John Goerzen, jgoerzen\@complete.org
-}</span><span>
</span><a name="line-23"></a><span>
</span><a name="line-24"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">List</span><span class="hs-operator">.</span><span class="hs-identifier">Utils</span><span class="hs-special">(</span><span class="hs-comment">-- * Merging</span><span>
</span><a name="line-25"></a><span>                     </span><a href="Data.List.Utils.html#merge"><span class="hs-identifier hs-var">merge</span></a><span class="hs-special">,</span><span> </span><a href="Data.List.Utils.html#mergeBy"><span class="hs-identifier hs-var">mergeBy</span></a><span class="hs-special">,</span><span>
</span><a name="line-26"></a><span>                     </span><span class="hs-comment">-- * Tests</span><span>
</span><a name="line-27"></a><span>                     </span><a href="Data.List.Utils.html#startswith"><span class="hs-identifier hs-var">startswith</span></a><span class="hs-special">,</span><span> </span><a href="Data.List.Utils.html#endswith"><span class="hs-identifier hs-var">endswith</span></a><span class="hs-special">,</span><span> </span><a href="Data.List.Utils.html#contains"><span class="hs-identifier hs-var">contains</span></a><span class="hs-special">,</span><span> </span><a href="Data.List.Utils.html#hasAny"><span class="hs-identifier hs-var">hasAny</span></a><span class="hs-special">,</span><span>
</span><a name="line-28"></a><span>                     </span><span class="hs-comment">-- * Association List Utilities</span><span>
</span><a name="line-29"></a><span>                     </span><span class="hs-comment">{- | These functions are designed to augment the
                     association list functions in &quot;Data.List&quot; and
                     provide an interface similar to &quot;Data.FiniteMap&quot; or
                     &quot;Data.Map&quot;
                     for association lists. -}</span><span>
</span><a name="line-34"></a><span>                     </span><a href="Data.List.Utils.html#addToAL"><span class="hs-identifier hs-var">addToAL</span></a><span class="hs-special">,</span><span> </span><a href="Data.List.Utils.html#delFromAL"><span class="hs-identifier hs-var">delFromAL</span></a><span class="hs-special">,</span><span> </span><a href="Data.List.Utils.html#flipAL"><span class="hs-identifier hs-var">flipAL</span></a><span class="hs-special">,</span><span> </span><a href="Data.List.Utils.html#keysAL"><span class="hs-identifier hs-var">keysAL</span></a><span class="hs-special">,</span><span> </span><a href="Data.List.Utils.html#valuesAL"><span class="hs-identifier hs-var">valuesAL</span></a><span class="hs-special">,</span><span>
</span><a name="line-35"></a><span>                     </span><a href="Data.List.Utils.html#hasKeyAL"><span class="hs-identifier hs-var">hasKeyAL</span></a><span class="hs-special">,</span><span>
</span><a name="line-36"></a><span>                     </span><span class="hs-comment">-- ** Association List Conversions</span><span>
</span><a name="line-37"></a><span>                     </span><a href="Data.List.Utils.html#strFromAL"><span class="hs-identifier hs-var">strFromAL</span></a><span class="hs-special">,</span><span>
</span><a name="line-38"></a><span>                     </span><a href="Data.List.Utils.html#strToAL"><span class="hs-identifier hs-var">strToAL</span></a><span class="hs-special">,</span><span>
</span><a name="line-39"></a><span>                     </span><span class="hs-comment">-- * Conversions</span><span>
</span><a name="line-40"></a><span>                     </span><a href="Data.List.Utils.html#split"><span class="hs-identifier hs-var">split</span></a><span class="hs-special">,</span><span> </span><a href="Data.List.Utils.html#join"><span class="hs-identifier hs-var">join</span></a><span class="hs-special">,</span><span> </span><a href="Data.List.Utils.html#replace"><span class="hs-identifier hs-var">replace</span></a><span class="hs-special">,</span><span> </span><a href="Data.List.Utils.html#genericJoin"><span class="hs-identifier hs-var">genericJoin</span></a><span class="hs-special">,</span><span> </span><a href="Data.List.Utils.html#takeWhileList"><span class="hs-identifier hs-var">takeWhileList</span></a><span class="hs-special">,</span><span>
</span><a name="line-41"></a><span>                     </span><a href="Data.List.Utils.html#dropWhileList"><span class="hs-identifier hs-var">dropWhileList</span></a><span class="hs-special">,</span><span> </span><a href="Data.List.Utils.html#spanList"><span class="hs-identifier hs-var">spanList</span></a><span class="hs-special">,</span><span> </span><a href="Data.List.Utils.html#breakList"><span class="hs-identifier hs-var">breakList</span></a><span class="hs-special">,</span><span>
</span><a name="line-42"></a><span>                     </span><span class="hs-comment">-- ** Advanced Conversions</span><span>
</span><a name="line-43"></a><span>                     </span><a href="Data.List.Utils.html#WholeFunc"><span class="hs-identifier hs-type">WholeFunc</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="Data.List.Utils.html#wholeMap"><span class="hs-identifier hs-var">wholeMap</span></a><span class="hs-special">,</span><span> </span><a href="Data.List.Utils.html#fixedWidth"><span class="hs-identifier hs-var">fixedWidth</span></a><span class="hs-special">,</span><span>
</span><a name="line-44"></a><span>                     </span><span class="hs-comment">-- * Fixed-Width and State Monad Utilities</span><span>
</span><a name="line-45"></a><span>                     </span><a href="Data.List.Utils.html#grab"><span class="hs-identifier hs-var">grab</span></a><span class="hs-special">,</span><span>
</span><a name="line-46"></a><span>                     </span><span class="hs-comment">-- * Miscellaneous</span><span>
</span><a name="line-47"></a><span>                     </span><a href="Data.List.Utils.html#countElem"><span class="hs-identifier hs-var">countElem</span></a><span class="hs-special">,</span><span> </span><a href="Data.List.Utils.html#elemRIndex"><span class="hs-identifier hs-var">elemRIndex</span></a><span class="hs-special">,</span><span> </span><a href="Data.List.Utils.html#alwaysElemRIndex"><span class="hs-identifier hs-var">alwaysElemRIndex</span></a><span class="hs-special">,</span><span> </span><a href="Data.List.Utils.html#seqList"><span class="hs-identifier hs-var">seqList</span></a><span class="hs-special">,</span><span>
</span><a name="line-48"></a><span>                     </span><a href="Data.List.Utils.html#subIndex"><span class="hs-identifier hs-var">subIndex</span></a><span class="hs-special">,</span><span> </span><a href="Data.List.Utils.html#uniq"><span class="hs-identifier hs-var">uniq</span></a><span>
</span><a name="line-49"></a><span>                     </span><span class="hs-comment">-- -- * Sub-List Selection</span><span>
</span><a name="line-50"></a><span>                     </span><span class="hs-comment">-- sub,</span><span>
</span><a name="line-51"></a><span>                    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-52"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">List</span><span class="hs-special">(</span><span class="hs-identifier hs-var">intersperse</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">concat</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">isPrefixOf</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">isSuffixOf</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">elemIndices</span><span class="hs-special">,</span><span>
</span><a name="line-53"></a><span>                </span><span class="hs-identifier hs-var">elemIndex</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">elemIndices</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">tails</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">find</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">findIndex</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">isInfixOf</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">nub</span><span class="hs-special">)</span><span>
</span><a name="line-54"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Control</span><span class="hs-operator">.</span><span class="hs-identifier">Monad</span><span class="hs-operator">.</span><span class="hs-identifier">State</span><span class="hs-special">(</span><span class="hs-identifier hs-type">State</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">get</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">put</span><span class="hs-special">)</span><span>
</span><a name="line-55"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Maybe</span><span class="hs-special">(</span><span class="hs-identifier hs-var">isJust</span><span class="hs-special">)</span><span>
</span><a name="line-56"></a><span>
</span><a name="line-57"></a><span>
</span><a name="line-58"></a><span class="hs-comment">{- | Merge two sorted lists into a single, sorted whole.

Example:

&gt; merge [1,3,5] [1,2,4,6] -&gt; [1,1,2,3,4,5,6]

QuickCheck test property:

prop_merge xs ys =
    merge (sort xs) (sort ys) == sort (xs ++ ys)
          where types = xs :: [Int]
-}</span><span>
</span><a name="line-70"></a><span class="hs-identifier">merge</span><span> </span><span class="hs-glyph">::</span><span>  </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679057883"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679057883"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679057883"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679057883"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-71"></a><a name="merge"><a href="Data.List.Utils.html#merge"><span class="hs-identifier">merge</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.List.Utils.html#mergeBy"><span class="hs-identifier hs-var">mergeBy</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">compare</span><span class="hs-special">)</span><span>
</span><a name="line-72"></a><span>
</span><a name="line-73"></a><span class="hs-comment">{- | Merge two sorted lists using into a single, sorted whole,
allowing the programmer to specify the comparison function.

QuickCheck test property:

prop_mergeBy xs ys =
    mergeBy cmp (sortBy cmp xs) (sortBy cmp ys) == sortBy cmp (xs ++ ys)
          where types = xs :: [ (Int, Int) ]
                cmp (x1,_) (x2,_) = compare x1 x2
-}</span><span>
</span><a name="line-83"></a><span class="hs-identifier">mergeBy</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679057882"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679057882"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Ordering</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679057882"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679057882"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679057882"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-84"></a><a name="mergeBy"><a href="Data.List.Utils.html#mergeBy"><span class="hs-identifier">mergeBy</span></a></a><span> </span><a name="local-6989586621679057884"><a href="#local-6989586621679057884"><span class="hs-identifier">cmp</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><a name="local-6989586621679057885"><a href="#local-6989586621679057885"><span class="hs-identifier">ys</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679057885"><span class="hs-identifier hs-var">ys</span></a><span>
</span><a name="line-85"></a><span class="hs-identifier">mergeBy</span><span> </span><a name="local-6989586621679057886"><a href="#local-6989586621679057886"><span class="hs-identifier">cmp</span></a></a><span> </span><a name="local-6989586621679057887"><a href="#local-6989586621679057887"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679057887"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-86"></a><span class="hs-identifier">mergeBy</span><span> </span><a name="local-6989586621679057888"><a href="#local-6989586621679057888"><span class="hs-identifier">cmp</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679057889"><a href="#local-6989586621679057889"><span class="hs-identifier">allx</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a name="local-6989586621679057890"><a href="#local-6989586621679057890"><span class="hs-identifier">x</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679057891"><a href="#local-6989586621679057891"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679057892"><a href="#local-6989586621679057892"><span class="hs-identifier">ally</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a name="local-6989586621679057893"><a href="#local-6989586621679057893"><span class="hs-identifier">y</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679057894"><a href="#local-6989586621679057894"><span class="hs-identifier">ys</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span>
</span><a name="line-87"></a><span>        </span><span class="hs-comment">-- Ordering derives Eq, Ord, so the comparison below is valid.</span><span>
</span><a name="line-88"></a><span>        </span><span class="hs-comment">-- Explanation left as an exercise for the reader.</span><span>
</span><a name="line-89"></a><span>        </span><span class="hs-comment">-- Someone please put this code out of its misery.</span><span>
</span><a name="line-90"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679057890"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">`</span><a href="#local-6989586621679057888"><span class="hs-identifier hs-var">cmp</span></a><span class="hs-special">`</span><span> </span><a href="#local-6989586621679057893"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;=</span><span> </span><span class="hs-identifier hs-var">EQ</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679057890"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="Data.List.Utils.html#mergeBy"><span class="hs-identifier hs-var">mergeBy</span></a><span> </span><a href="#local-6989586621679057888"><span class="hs-identifier hs-var">cmp</span></a><span> </span><a href="#local-6989586621679057891"><span class="hs-identifier hs-var">xs</span></a><span> </span><a href="#local-6989586621679057892"><span class="hs-identifier hs-var">ally</span></a><span>
</span><a name="line-91"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679057893"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="Data.List.Utils.html#mergeBy"><span class="hs-identifier hs-var">mergeBy</span></a><span> </span><a href="#local-6989586621679057888"><span class="hs-identifier hs-var">cmp</span></a><span> </span><a href="#local-6989586621679057889"><span class="hs-identifier hs-var">allx</span></a><span> </span><a href="#local-6989586621679057894"><span class="hs-identifier hs-var">ys</span></a><span>
</span><a name="line-92"></a><span>
</span><a name="line-93"></a><span class="hs-comment">{- | Returns true if the given list starts with the specified elements;
false otherwise.  (This is an alias for &quot;Data.List.isPrefixOf&quot;.)

Example:

&gt; startswith &quot;He&quot; &quot;Hello&quot; -&gt; True

-}</span><span>
</span><a name="line-101"></a><span>
</span><a name="line-102"></a><span class="hs-identifier">startswith</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="#local-6989586621679057881"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679057881"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679057881"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-103"></a><a name="startswith"><a href="Data.List.Utils.html#startswith"><span class="hs-identifier">startswith</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">isPrefixOf</span><span>
</span><a name="line-104"></a><span>
</span><a name="line-105"></a><span class="hs-comment">{- | Returns true if the given list ends with the specified elements;
false otherwise.  (This is an alias for &quot;Data.List.isSuffixOf&quot;.)

Example:

&gt; endswith &quot;lo&quot; &quot;Hello&quot; -&gt; True

-}</span><span>
</span><a name="line-113"></a><span class="hs-identifier">endswith</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="#local-6989586621679057880"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679057880"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679057880"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-114"></a><a name="endswith"><a href="Data.List.Utils.html#endswith"><span class="hs-identifier">endswith</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">isSuffixOf</span><span>
</span><a name="line-115"></a><span>
</span><a name="line-116"></a><span class="hs-comment">{- | Returns true if the given list contains any of the elements in the search
list. -}</span><span>
</span><a name="line-118"></a><span class="hs-identifier">hasAny</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="#local-6989586621679057879"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679057879"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>           </span><span class="hs-comment">-- ^ List of elements to look for</span><span>
</span><a name="line-119"></a><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679057879"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>                   </span><span class="hs-comment">-- ^ List to search</span><span>
</span><a name="line-120"></a><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>                  </span><span class="hs-comment">-- ^ Result</span><span>
</span><a name="line-121"></a><a name="hasAny"><a href="Data.List.Utils.html#hasAny"><span class="hs-identifier">hasAny</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>             </span><span class="hs-comment">-- An empty search list: always false</span><span>
</span><a name="line-122"></a><span class="hs-identifier">hasAny</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>             </span><span class="hs-comment">-- An empty list to scan: always false</span><span>
</span><a name="line-123"></a><span class="hs-identifier">hasAny</span><span> </span><a name="local-6989586621679057895"><a href="#local-6989586621679057895"><span class="hs-identifier">search</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679057896"><a href="#local-6989586621679057896"><span class="hs-identifier">x</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679057897"><a href="#local-6989586621679057897"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679057896"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">elem</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621679057895"><span class="hs-identifier hs-var">search</span></a><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier hs-var">True</span><span> </span><span class="hs-keyword">else</span><span> </span><a href="Data.List.Utils.html#hasAny"><span class="hs-identifier hs-var">hasAny</span></a><span> </span><a href="#local-6989586621679057895"><span class="hs-identifier hs-var">search</span></a><span> </span><a href="#local-6989586621679057897"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-124"></a><span>
</span><a name="line-125"></a><span class="hs-comment">{- | Similar to Data.List.takeWhile, takes elements while the func is true.
The function is given the remainder of the list to examine. -}</span><span>
</span><a name="line-127"></a><span class="hs-identifier">takeWhileList</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="#local-6989586621679057878"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679057878"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679057878"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-128"></a><a name="takeWhileList"><a href="Data.List.Utils.html#takeWhileList"><span class="hs-identifier">takeWhileList</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-129"></a><span class="hs-identifier">takeWhileList</span><span> </span><a name="local-6989586621679057898"><a href="#local-6989586621679057898"><span class="hs-identifier">func</span></a></a><span> </span><a name="local-6989586621679057899"><a href="#local-6989586621679057899"><span class="hs-identifier">list</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a name="local-6989586621679057900"><a href="#local-6989586621679057900"><span class="hs-identifier">x</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679057901"><a href="#local-6989586621679057901"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-130"></a><span>    </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679057898"><span class="hs-identifier hs-var">func</span></a><span> </span><a href="#local-6989586621679057899"><span class="hs-identifier hs-var">list</span></a><span> </span><span>
</span><a name="line-131"></a><span>       </span><span class="hs-keyword">then</span><span> </span><a href="#local-6989586621679057900"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="Data.List.Utils.html#takeWhileList"><span class="hs-identifier hs-var">takeWhileList</span></a><span> </span><a href="#local-6989586621679057898"><span class="hs-identifier hs-var">func</span></a><span> </span><a href="#local-6989586621679057901"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-132"></a><span>       </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-133"></a><span>
</span><a name="line-134"></a><span class="hs-comment">{- | Similar to Data.List.dropWhile, drops elements while the func is true.
The function is given the remainder of the list to examine. -}</span><span>
</span><a name="line-136"></a><span class="hs-identifier">dropWhileList</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="#local-6989586621679057877"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679057877"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679057877"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-137"></a><a name="dropWhileList"><a href="Data.List.Utils.html#dropWhileList"><span class="hs-identifier">dropWhileList</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-138"></a><span class="hs-identifier">dropWhileList</span><span> </span><a name="local-6989586621679057902"><a href="#local-6989586621679057902"><span class="hs-identifier">func</span></a></a><span> </span><a name="local-6989586621679057903"><a href="#local-6989586621679057903"><span class="hs-identifier">list</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a name="local-6989586621679057904"><a href="#local-6989586621679057904"><span class="hs-identifier">x</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679057905"><a href="#local-6989586621679057905"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-139"></a><span>    </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679057902"><span class="hs-identifier hs-var">func</span></a><span> </span><a href="#local-6989586621679057903"><span class="hs-identifier hs-var">list</span></a><span>
</span><a name="line-140"></a><span>       </span><span class="hs-keyword">then</span><span> </span><a href="Data.List.Utils.html#dropWhileList"><span class="hs-identifier hs-var">dropWhileList</span></a><span> </span><a href="#local-6989586621679057902"><span class="hs-identifier hs-var">func</span></a><span> </span><a href="#local-6989586621679057905"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-141"></a><span>       </span><span class="hs-keyword">else</span><span> </span><a href="#local-6989586621679057903"><span class="hs-identifier hs-var">list</span></a><span>
</span><a name="line-142"></a><span>
</span><a name="line-143"></a><span class="hs-comment">{- | Similar to Data.List.span, but performs the test on the entire remaining
list instead of just one element. 

@spanList p xs@ is the same as @(takeWhileList p xs, dropWhileList p xs)@ 
-}</span><span>
</span><a name="line-148"></a><span class="hs-identifier">spanList</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="#local-6989586621679057876"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679057876"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="#local-6989586621679057876"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679057876"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-149"></a><span>
</span><a name="line-150"></a><a name="spanList"><a href="Data.List.Utils.html#spanList"><span class="hs-identifier">spanList</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-151"></a><span class="hs-identifier">spanList</span><span> </span><a name="local-6989586621679057906"><a href="#local-6989586621679057906"><span class="hs-identifier">func</span></a></a><span> </span><a name="local-6989586621679057907"><a href="#local-6989586621679057907"><span class="hs-identifier">list</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a name="local-6989586621679057908"><a href="#local-6989586621679057908"><span class="hs-identifier">x</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679057909"><a href="#local-6989586621679057909"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-152"></a><span>    </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679057906"><span class="hs-identifier hs-var">func</span></a><span> </span><a href="#local-6989586621679057907"><span class="hs-identifier hs-var">list</span></a><span>
</span><a name="line-153"></a><span>       </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679057908"><span class="hs-identifier hs-var">x</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679057910"><span class="hs-identifier hs-var">ys</span></a><span class="hs-special">,</span><a href="#local-6989586621679057911"><span class="hs-identifier hs-var">zs</span></a><span class="hs-special">)</span><span>
</span><a name="line-154"></a><span>       </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><a href="#local-6989586621679057907"><span class="hs-identifier hs-var">list</span></a><span class="hs-special">)</span><span>
</span><a name="line-155"></a><span>    </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679057910"><a href="#local-6989586621679057910"><span class="hs-identifier">ys</span></a></a><span class="hs-special">,</span><a name="local-6989586621679057911"><a href="#local-6989586621679057911"><span class="hs-identifier">zs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.List.Utils.html#spanList"><span class="hs-identifier hs-var">spanList</span></a><span> </span><a href="#local-6989586621679057906"><span class="hs-identifier hs-var">func</span></a><span> </span><a href="#local-6989586621679057909"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-156"></a><span>
</span><a name="line-157"></a><span class="hs-comment">{- | Similar to Data.List.break, but performs the test on the entire remaining
list instead of just one element.
-}</span><span>
</span><a name="line-160"></a><span class="hs-identifier">breakList</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="#local-6989586621679057875"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679057875"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="#local-6989586621679057875"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679057875"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-161"></a><a name="breakList"><a href="Data.List.Utils.html#breakList"><span class="hs-identifier">breakList</span></a></a><span> </span><a name="local-6989586621679057912"><a href="#local-6989586621679057912"><span class="hs-identifier">func</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.List.Utils.html#spanList"><span class="hs-identifier hs-var">spanList</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="#local-6989586621679057912"><span class="hs-identifier hs-var">func</span></a><span class="hs-special">)</span><span>
</span><a name="line-162"></a><span>
</span><a name="line-163"></a><span class="hs-comment">{- | Given a delimiter and a list (or string), split into components.

Example:

&gt; split &quot;,&quot; &quot;foo,bar,,baz,&quot; -&gt; [&quot;foo&quot;, &quot;bar&quot;, &quot;&quot;, &quot;baz&quot;, &quot;&quot;]

&gt; split &quot;ba&quot; &quot;,foo,bar,,baz,&quot; -&gt; [&quot;,foo,&quot;,&quot;r,,&quot;,&quot;z,&quot;]
-}</span><span>
</span><a name="line-171"></a><span class="hs-identifier">split</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="#local-6989586621679057874"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679057874"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679057874"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><a href="#local-6989586621679057874"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><a name="line-172"></a><a name="split"><a href="Data.List.Utils.html#split"><span class="hs-identifier">split</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-173"></a><span class="hs-identifier">split</span><span> </span><a name="local-6989586621679057913"><a href="#local-6989586621679057913"><span class="hs-identifier">delim</span></a></a><span> </span><a name="local-6989586621679057914"><a href="#local-6989586621679057914"><span class="hs-identifier">str</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-174"></a><span>    </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679057915"><a href="#local-6989586621679057915"><span class="hs-identifier">firstline</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679057916"><a href="#local-6989586621679057916"><span class="hs-identifier">remainder</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.List.Utils.html#breakList"><span class="hs-identifier hs-var">breakList</span></a><span> </span><span class="hs-special">(</span><a href="Data.List.Utils.html#startswith"><span class="hs-identifier hs-var">startswith</span></a><span> </span><a href="#local-6989586621679057913"><span class="hs-identifier hs-var">delim</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679057914"><span class="hs-identifier hs-var">str</span></a><span>
</span><a name="line-175"></a><span>        </span><span class="hs-keyword">in</span><span> </span><span>
</span><a name="line-176"></a><span>        </span><a href="#local-6989586621679057915"><span class="hs-identifier hs-var">firstline</span></a><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679057916"><span class="hs-identifier hs-var">remainder</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-177"></a><span>                                   </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-178"></a><span>                                   </span><a name="local-6989586621679057917"><a href="#local-6989586621679057917"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679057917"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679057913"><span class="hs-identifier hs-var">delim</span></a><span>
</span><a name="line-179"></a><span>                                        </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">:</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-180"></a><span>                                        </span><span class="hs-keyword">else</span><span> </span><a href="Data.List.Utils.html#split"><span class="hs-identifier hs-var">split</span></a><span> </span><a href="#local-6989586621679057913"><span class="hs-identifier hs-var">delim</span></a><span> </span><span>
</span><a name="line-181"></a><span>                                                 </span><span class="hs-special">(</span><span class="hs-identifier hs-var">drop</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">length</span><span> </span><a href="#local-6989586621679057913"><span class="hs-identifier hs-var">delim</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679057917"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span>
</span><a name="line-182"></a><span>
</span><a name="line-183"></a><span>
</span><a name="line-184"></a><span class="hs-comment">{- | Given a list and a replacement list, replaces each occurance of the search
list with the replacement list in the operation list.

Example:

&gt;replace &quot;,&quot; &quot;.&quot; &quot;127,0,0,1&quot; -&gt; &quot;127.0.0.1&quot;

This could logically be thought of as:

&gt;replace old new l = join new . split old $ l
-}</span><span>
</span><a name="line-195"></a><span>
</span><a name="line-196"></a><span class="hs-identifier">replace</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="#local-6989586621679057873"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679057873"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679057873"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679057873"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679057873"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-197"></a><a name="replace"><a href="Data.List.Utils.html#replace"><span class="hs-identifier">replace</span></a></a><span> </span><a name="local-6989586621679057918"><a href="#local-6989586621679057918"><span class="hs-identifier">old</span></a></a><span> </span><a name="local-6989586621679057919"><a href="#local-6989586621679057919"><span class="hs-identifier">new</span></a></a><span> </span><a name="local-6989586621679057920"><a href="#local-6989586621679057920"><span class="hs-identifier">l</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.List.Utils.html#join"><span class="hs-identifier hs-var">join</span></a><span> </span><a href="#local-6989586621679057919"><span class="hs-identifier hs-var">new</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Data.List.Utils.html#split"><span class="hs-identifier hs-var">split</span></a><span> </span><a href="#local-6989586621679057918"><span class="hs-identifier hs-var">old</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679057920"><span class="hs-identifier hs-var">l</span></a><span>
</span><a name="line-198"></a><span>
</span><a name="line-199"></a><span class="hs-comment">{- | Given a delimiter and a list of items (or strings), join the items
by using the delimiter.

Example:

&gt; join &quot;|&quot; [&quot;foo&quot;, &quot;bar&quot;, &quot;baz&quot;] -&gt; &quot;foo|bar|baz&quot;
-}</span><span>
</span><a name="line-206"></a><span class="hs-identifier">join</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679057872"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><a href="#local-6989586621679057872"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679057872"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-207"></a><a name="join"><a href="Data.List.Utils.html#join"><span class="hs-identifier">join</span></a></a><span> </span><a name="local-6989586621679057921"><a href="#local-6989586621679057921"><span class="hs-identifier">delim</span></a></a><span> </span><a name="local-6989586621679057922"><a href="#local-6989586621679057922"><span class="hs-identifier">l</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">concat</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">intersperse</span><span> </span><a href="#local-6989586621679057921"><span class="hs-identifier hs-var">delim</span></a><span> </span><a href="#local-6989586621679057922"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">)</span><span>
</span><a name="line-208"></a><span>
</span><a name="line-209"></a><span class="hs-comment">{- | Like 'join', but works with a list of anything showable, converting
it to a String.

Examples:

&gt; genericJoin &quot;, &quot; [1, 2, 3, 4] -&gt; &quot;1, 2, 3, 4&quot;
&gt; genericJoin &quot;|&quot; [&quot;foo&quot;, &quot;bar&quot;, &quot;baz&quot;] -&gt; &quot;\&quot;foo\&quot;|\&quot;bar\&quot;|\&quot;baz\&quot;&quot;

-}</span><span>
</span><a name="line-218"></a><span class="hs-identifier">genericJoin</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><a href="#local-6989586621679057871"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679057871"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-219"></a><a name="genericJoin"><a href="Data.List.Utils.html#genericJoin"><span class="hs-identifier">genericJoin</span></a></a><span> </span><a name="local-6989586621679057923"><a href="#local-6989586621679057923"><span class="hs-identifier">delim</span></a></a><span> </span><a name="local-6989586621679057924"><a href="#local-6989586621679057924"><span class="hs-identifier">l</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.List.Utils.html#join"><span class="hs-identifier hs-var">join</span></a><span> </span><a href="#local-6989586621679057923"><span class="hs-identifier hs-var">delim</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679057924"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">)</span><span>
</span><a name="line-220"></a><span>
</span><a name="line-221"></a><span class="hs-pragma">{-# DEPRECATED contains &quot;Use Data.List.isInfixOf, will be removed in MissingH 1.1.0&quot; #-}</span><span>
</span><a name="line-222"></a><span class="hs-comment">{- | Returns true if the given parameter is a sublist of the given list;
false otherwise.

Example:

&gt; contains &quot;Haskell&quot; &quot;I really like Haskell.&quot; -&gt; True
&gt; contains &quot;Haskell&quot; &quot;OCaml is great.&quot; -&gt; False

This function was submitted to GHC and was applied as
'Data.List.isInfixOf'.  This function therefore is deprecated and will
be removed in future versions.
-}</span><span>
</span><a name="line-234"></a><span>
</span><a name="line-235"></a><span class="hs-identifier">contains</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="#local-6989586621679057870"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679057870"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679057870"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-236"></a><a name="contains"><a href="Data.List.Utils.html#contains"><span class="hs-identifier">contains</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">isInfixOf</span><span>
</span><a name="line-237"></a><span>
</span><a name="line-238"></a><span class="hs-comment">-- above function submitted to GHC as Data.List.isInfixOf on 8/31/2006</span><span>
</span><a name="line-239"></a><span>
</span><a name="line-240"></a><span class="hs-comment">{- | Adds the specified (key, value) pair to the given list, removing any
existing pair with the same key already present. -}</span><span>
</span><a name="line-242"></a><span class="hs-identifier">addToAL</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="#local-6989586621679057868"><span class="hs-identifier hs-type">key</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="#local-6989586621679057868"><span class="hs-identifier hs-type">key</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679057869"><span class="hs-identifier hs-type">elt</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679057868"><span class="hs-identifier hs-type">key</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679057869"><span class="hs-identifier hs-type">elt</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="#local-6989586621679057868"><span class="hs-identifier hs-type">key</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679057869"><span class="hs-identifier hs-type">elt</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-243"></a><a name="addToAL"><a href="Data.List.Utils.html#addToAL"><span class="hs-identifier">addToAL</span></a></a><span> </span><a name="local-6989586621679057925"><a href="#local-6989586621679057925"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679057926"><a href="#local-6989586621679057926"><span class="hs-identifier">key</span></a></a><span> </span><a name="local-6989586621679057927"><a href="#local-6989586621679057927"><span class="hs-identifier">value</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679057926"><span class="hs-identifier hs-var">key</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679057927"><span class="hs-identifier hs-var">value</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">:</span><span> </span><a href="Data.List.Utils.html#delFromAL"><span class="hs-identifier hs-var">delFromAL</span></a><span> </span><a href="#local-6989586621679057925"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="#local-6989586621679057926"><span class="hs-identifier hs-var">key</span></a><span>
</span><a name="line-244"></a><span>
</span><a name="line-245"></a><span class="hs-comment">{- | Removes all (key, value) pairs from the given list where the key
matches the given one. -}</span><span>
</span><a name="line-247"></a><span class="hs-identifier">delFromAL</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="#local-6989586621679057866"><span class="hs-identifier hs-type">key</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="#local-6989586621679057866"><span class="hs-identifier hs-type">key</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679057867"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679057866"><span class="hs-identifier hs-type">key</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="#local-6989586621679057866"><span class="hs-identifier hs-type">key</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679057867"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-248"></a><a name="delFromAL"><a href="Data.List.Utils.html#delFromAL"><span class="hs-identifier">delFromAL</span></a></a><span> </span><a name="local-6989586621679057928"><a href="#local-6989586621679057928"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679057929"><a href="#local-6989586621679057929"><span class="hs-identifier">key</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">filter</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679057930"><a href="#local-6989586621679057930"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fst</span><span> </span><a href="#local-6989586621679057930"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">/=</span><span> </span><a href="#local-6989586621679057929"><span class="hs-identifier hs-var">key</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679057928"><span class="hs-identifier hs-var">l</span></a><span>
</span><a name="line-249"></a><span>
</span><a name="line-250"></a><span class="hs-comment">{- | Returns the keys that comprise the (key, value) pairs of the given AL.

Same as:

&gt;map fst
-}</span><span>
</span><a name="line-256"></a><span class="hs-identifier">keysAL</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="#local-6989586621679057864"><span class="hs-identifier hs-type">key</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679057865"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679057864"><span class="hs-identifier hs-type">key</span></a><span class="hs-special">]</span><span>
</span><a name="line-257"></a><a name="keysAL"><a href="Data.List.Utils.html#keysAL"><span class="hs-identifier">keysAL</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-identifier hs-var">fst</span><span>
</span><a name="line-258"></a><span>
</span><a name="line-259"></a><span class="hs-comment">{- | Returns the values the comprise the (key, value) pairs of the given
AL.

Same as:

&gt;map snd
-}</span><span>
</span><a name="line-266"></a><span class="hs-identifier">valuesAL</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="#local-6989586621679057862"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679057863"><span class="hs-identifier hs-type">value</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679057863"><span class="hs-identifier hs-type">value</span></a><span class="hs-special">]</span><span>
</span><a name="line-267"></a><a name="valuesAL"><a href="Data.List.Utils.html#valuesAL"><span class="hs-identifier">valuesAL</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-identifier hs-var">snd</span><span>
</span><a name="line-268"></a><span>
</span><a name="line-269"></a><span class="hs-comment">{- | Indicates whether or not the given key is in the AL. -}</span><span>
</span><a name="line-270"></a><span class="hs-identifier">hasKeyAL</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="#local-6989586621679057860"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679057860"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="#local-6989586621679057860"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679057861"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-271"></a><a name="hasKeyAL"><a href="Data.List.Utils.html#hasKeyAL"><span class="hs-identifier">hasKeyAL</span></a></a><span> </span><a name="local-6989586621679057931"><a href="#local-6989586621679057931"><span class="hs-identifier">key</span></a></a><span> </span><a name="local-6989586621679057932"><a href="#local-6989586621679057932"><span class="hs-identifier">list</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-272"></a><span>    </span><span class="hs-identifier hs-var">elem</span><span> </span><a href="#local-6989586621679057931"><span class="hs-identifier hs-var">key</span></a><span> </span><span class="hs-special">(</span><a href="Data.List.Utils.html#keysAL"><span class="hs-identifier hs-var">keysAL</span></a><span> </span><a href="#local-6989586621679057932"><span class="hs-identifier hs-var">list</span></a><span class="hs-special">)</span><span>
</span><a name="line-273"></a><span>
</span><a name="line-274"></a><span class="hs-comment">{- | Flips an association list.  Converts (key1, val), (key2, val) pairs
to (val, [key1, key2]). -}</span><span>
</span><a name="line-276"></a><span class="hs-identifier">flipAL</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="#local-6989586621679057858"><span class="hs-identifier hs-type">key</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="#local-6989586621679057859"><span class="hs-identifier hs-type">val</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="#local-6989586621679057858"><span class="hs-identifier hs-type">key</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679057859"><span class="hs-identifier hs-type">val</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="#local-6989586621679057859"><span class="hs-identifier hs-type">val</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679057858"><span class="hs-identifier hs-type">key</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-277"></a><a name="flipAL"><a href="Data.List.Utils.html#flipAL"><span class="hs-identifier">flipAL</span></a></a><span> </span><a name="local-6989586621679057933"><a href="#local-6989586621679057933"><span class="hs-identifier">oldl</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-278"></a><span>    </span><span class="hs-keyword">let</span><span> </span><span class="hs-identifier">worker</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="#local-6989586621679057935"><span class="hs-identifier hs-type">key</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="#local-6989586621679057936"><span class="hs-identifier hs-type">val</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="#local-6989586621679057935"><span class="hs-identifier hs-type">key</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679057936"><span class="hs-identifier hs-type">val</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="#local-6989586621679057936"><span class="hs-identifier hs-type">val</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679057935"><span class="hs-identifier hs-type">key</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="#local-6989586621679057936"><span class="hs-identifier hs-type">val</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679057935"><span class="hs-identifier hs-type">key</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-279"></a><span>        </span><a name="local-6989586621679057934"><a href="#local-6989586621679057934"><span class="hs-identifier">worker</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><a name="local-6989586621679057937"><a href="#local-6989586621679057937"><span class="hs-identifier">accum</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679057937"><span class="hs-identifier hs-var">accum</span></a><span>
</span><a name="line-280"></a><span>        </span><span class="hs-identifier">worker</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a name="local-6989586621679057938"><a href="#local-6989586621679057938"><span class="hs-identifier">k</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679057939"><a href="#local-6989586621679057939"><span class="hs-identifier">v</span></a></a><span class="hs-special">)</span><span class="hs-glyph">:</span><a name="local-6989586621679057940"><a href="#local-6989586621679057940"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679057941"><a href="#local-6989586621679057941"><span class="hs-identifier">accum</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-281"></a><span>            </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">lookup</span><span> </span><a href="#local-6989586621679057939"><span class="hs-identifier hs-var">v</span></a><span> </span><a href="#local-6989586621679057941"><span class="hs-identifier hs-var">accum</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-282"></a><span>                                </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679057934"><span class="hs-identifier hs-var">worker</span></a><span> </span><a href="#local-6989586621679057940"><span class="hs-identifier hs-var">xs</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="#local-6989586621679057939"><span class="hs-identifier hs-var">v</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679057938"><span class="hs-identifier hs-var">k</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679057941"><span class="hs-identifier hs-var">accum</span></a><span class="hs-special">)</span><span>
</span><a name="line-283"></a><span>                                </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679057942"><a href="#local-6989586621679057942"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679057934"><span class="hs-identifier hs-var">worker</span></a><span> </span><a href="#local-6989586621679057940"><span class="hs-identifier hs-var">xs</span></a><span> </span><span class="hs-special">(</span><a href="Data.List.Utils.html#addToAL"><span class="hs-identifier hs-var">addToAL</span></a><span> </span><a href="#local-6989586621679057941"><span class="hs-identifier hs-var">accum</span></a><span> </span><a href="#local-6989586621679057939"><span class="hs-identifier hs-var">v</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679057938"><span class="hs-identifier hs-var">k</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679057942"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-284"></a><span>        </span><span class="hs-keyword">in</span><span>
</span><a name="line-285"></a><span>        </span><a href="#local-6989586621679057934"><span class="hs-identifier hs-var">worker</span></a><span> </span><a href="#local-6989586621679057933"><span class="hs-identifier hs-var">oldl</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-286"></a><span>
</span><a name="line-287"></a><span class="hs-comment">{- | Converts an association list to a string.  The string will have
one pair per line, with the key and value both represented as a Haskell string.

This function is designed to work with [(String, String)] association lists,
but may work with other types as well. -}</span><span>
</span><a name="line-292"></a><span>
</span><a name="line-293"></a><span class="hs-identifier">strFromAL</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Show</span><span> </span><a href="#local-6989586621679057856"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><a href="#local-6989586621679057857"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="#local-6989586621679057856"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679057857"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-294"></a><a name="strFromAL"><a href="Data.List.Utils.html#strFromAL"><span class="hs-identifier">strFromAL</span></a></a><span> </span><a name="local-6989586621679057943"><a href="#local-6989586621679057943"><span class="hs-identifier">inp</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-295"></a><span>    </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679057944"><a href="#local-6989586621679057944"><span class="hs-identifier">worker</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679057945"><a href="#local-6989586621679057945"><span class="hs-identifier">key</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679057946"><a href="#local-6989586621679057946"><span class="hs-identifier">val</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679057945"><span class="hs-identifier hs-var">key</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot;,&quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679057946"><span class="hs-identifier hs-var">val</span></a><span>
</span><a name="line-296"></a><span>        </span><span class="hs-keyword">in</span><span> </span><span class="hs-identifier hs-var">unlines</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><a href="#local-6989586621679057944"><span class="hs-identifier hs-var">worker</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679057943"><span class="hs-identifier hs-var">inp</span></a><span>
</span><a name="line-297"></a><span>
</span><a name="line-298"></a><span class="hs-comment">{- | The inverse of 'strFromAL', this function reads a string and outputs the
appropriate association list. 

Like 'strFromAL', this is designed to work with [(String, String)] association
lists but may also work with other objects with simple representations.
-}</span><span>
</span><a name="line-304"></a><span class="hs-identifier">strToAL</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Read</span><span> </span><a href="#local-6989586621679057854"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Read</span><span> </span><a href="#local-6989586621679057855"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="#local-6989586621679057854"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679057855"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-305"></a><a name="strToAL"><a href="Data.List.Utils.html#strToAL"><span class="hs-identifier">strToAL</span></a></a><span> </span><a name="local-6989586621679057947"><a href="#local-6989586621679057947"><span class="hs-identifier">inp</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span>
</span><a name="line-306"></a><span>    </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679057948"><a href="#local-6989586621679057948"><span class="hs-identifier">worker</span></a></a><span> </span><a name="local-6989586621679057949"><a href="#local-6989586621679057949"><span class="hs-identifier">line</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-307"></a><span>            </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">reads</span><span> </span><a href="#local-6989586621679057949"><span class="hs-identifier hs-var">line</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-308"></a><span>               </span><span class="hs-special">[</span><span class="hs-special">(</span><a name="local-6989586621679057980"><a href="#local-6989586621679057980"><span class="hs-identifier">key</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679057981"><a href="#local-6989586621679057981"><span class="hs-identifier">remainder</span></a></a><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679057981"><span class="hs-identifier hs-var">remainder</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-309"></a><span>                     </span><span class="hs-char">','</span><span class="hs-glyph">:</span><a name="local-6989586621679057982"><a href="#local-6989586621679057982"><span class="hs-identifier">valstr</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679057980"><span class="hs-identifier hs-var">key</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">read</span><span> </span><a href="#local-6989586621679057982"><span class="hs-identifier hs-var">valstr</span></a><span class="hs-special">)</span><span>
</span><a name="line-310"></a><span>                     </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-string">&quot;Data.List.Utils.strToAL: Parse error on value&quot;</span><span>
</span><a name="line-311"></a><span>               </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-string">&quot;Data.List.Utils.strToAL: Parse error on key&quot;</span><span>
</span><a name="line-312"></a><span>        </span><span class="hs-keyword">in</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><a href="#local-6989586621679057948"><span class="hs-identifier hs-var">worker</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">lines</span><span> </span><a href="#local-6989586621679057947"><span class="hs-identifier hs-var">inp</span></a><span class="hs-special">)</span><span>
</span><a name="line-313"></a><span>
</span><a name="line-314"></a><span>
</span><a name="line-315"></a><span class="hs-comment">{- FIXME TODO: sub -}</span><span>
</span><a name="line-316"></a><span>
</span><a name="line-317"></a><span class="hs-comment">{- | Returns a count of the number of times the given element occured in the
given list. -}</span><span>
</span><a name="line-319"></a><span class="hs-identifier">countElem</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="#local-6989586621679057853"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679057853"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679057853"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-320"></a><a name="countElem"><a href="Data.List.Utils.html#countElem"><span class="hs-identifier">countElem</span></a></a><span> </span><a name="local-6989586621679057983"><a href="#local-6989586621679057983"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">length</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">filter</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679057983"><span class="hs-identifier hs-var">i</span></a><span class="hs-operator hs-var">==</span><span class="hs-special">)</span><span>
</span><a name="line-321"></a><span>
</span><a name="line-322"></a><span class="hs-comment">{- | Returns the rightmost index of the given element in the
given list. -}</span><span>
</span><a name="line-324"></a><span class="hs-identifier">elemRIndex</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="#local-6989586621679057852"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679057852"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679057852"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-325"></a><a name="elemRIndex"><a href="Data.List.Utils.html#elemRIndex"><span class="hs-identifier">elemRIndex</span></a></a><span> </span><a name="local-6989586621679057984"><a href="#local-6989586621679057984"><span class="hs-identifier">item</span></a></a><span> </span><a name="local-6989586621679057985"><a href="#local-6989586621679057985"><span class="hs-identifier">l</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-326"></a><span>    </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">reverse</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">elemIndices</span><span> </span><a href="#local-6989586621679057984"><span class="hs-identifier hs-var">item</span></a><span> </span><a href="#local-6989586621679057985"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-327"></a><span>                                   </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-328"></a><span>                                   </span><span class="hs-special">(</span><a name="local-6989586621679057986"><a href="#local-6989586621679057986"><span class="hs-identifier">x</span></a></a><span class="hs-glyph">:</span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><a href="#local-6989586621679057986"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-329"></a><span class="hs-comment">{- | Like elemRIndex, but returns -1 if there is nothing
found. -}</span><span>
</span><a name="line-331"></a><span class="hs-identifier">alwaysElemRIndex</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="#local-6989586621679057851"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679057851"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679057851"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-332"></a><a name="alwaysElemRIndex"><a href="Data.List.Utils.html#alwaysElemRIndex"><span class="hs-identifier">alwaysElemRIndex</span></a></a><span> </span><a name="local-6989586621679057987"><a href="#local-6989586621679057987"><span class="hs-identifier">item</span></a></a><span> </span><a name="local-6989586621679057988"><a href="#local-6989586621679057988"><span class="hs-identifier">list</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-333"></a><span>    </span><span class="hs-keyword">case</span><span> </span><a href="Data.List.Utils.html#elemRIndex"><span class="hs-identifier hs-var">elemRIndex</span></a><span> </span><a href="#local-6989586621679057987"><span class="hs-identifier hs-var">item</span></a><span> </span><a href="#local-6989586621679057988"><span class="hs-identifier hs-var">list</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-334"></a><span>                              </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-glyph">-</span><span class="hs-number">1</span><span>
</span><a name="line-335"></a><span>                              </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679057989"><a href="#local-6989586621679057989"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679057989"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-336"></a><span>
</span><a name="line-337"></a><span class="hs-comment">{- | Forces the evaluation of the entire list. -}</span><span>
</span><a name="line-338"></a><span class="hs-identifier">seqList</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679057850"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679057850"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-339"></a><a name="seqList"><a href="Data.List.Utils.html#seqList"><span class="hs-identifier">seqList</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-340"></a><span class="hs-identifier">seqList</span><span> </span><a name="local-6989586621679057990"><a href="#local-6989586621679057990"><span class="hs-identifier">list</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a name="local-6989586621679057991"><a href="#local-6989586621679057991"><span class="hs-identifier">x</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679057992"><a href="#local-6989586621679057992"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">seq</span><span> </span><span class="hs-special">(</span><a href="Data.List.Utils.html#seqList"><span class="hs-identifier hs-var">seqList</span></a><span> </span><a href="#local-6989586621679057992"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679057990"><span class="hs-identifier hs-var">list</span></a><span>
</span><a name="line-341"></a><span>
</span><a name="line-342"></a><span class="hs-comment">--------------------------------------------------</span><span>
</span><a name="line-343"></a><span class="hs-comment">-- Advanced Conversions</span><span>
</span><a name="line-344"></a><span class="hs-comment">--------------------------------------------------</span><span>
</span><a name="line-345"></a><span>
</span><a name="line-346"></a><span class="hs-comment">{- | The type used for functions for 'wholeMap'.  See 'wholeMap' for details.
-}</span><span>
</span><a name="line-348"></a><span class="hs-keyword">newtype</span><span> </span><a name="WholeFunc"><a href="Data.List.Utils.html#WholeFunc"><span class="hs-identifier">WholeFunc</span></a></a><span> </span><a name="local-6989586621679057842"><a href="#local-6989586621679057842"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679057843"><a href="#local-6989586621679057843"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="WholeFunc"><a href="Data.List.Utils.html#WholeFunc"><span class="hs-identifier">WholeFunc</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="#local-6989586621679057842"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="Data.List.Utils.html#WholeFunc"><span class="hs-identifier hs-type">WholeFunc</span></a><span> </span><a href="#local-6989586621679057842"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621679057843"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679057842"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679057843"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-349"></a><span>
</span><a name="line-350"></a><span class="hs-comment">{- | This is an enhanced version of the concatMap or map functions in 
Data.List.

Unlike those functions, this one:

 * Can consume a varying number of elements from the input list during
   each iteration

 * Can arbitrarily decide when to stop processing data

 * Can return a varying number of elements to insert into the output list

 * Can actually switch processing functions mid-stream

 * Is not even restricted to processing the input list intact

The function used by wholeMap, of type 'WholeFunc', is repeatedly called
with the input list.  The function returns three things: the function
to call for the next iteration (if any), what remains of the input list,
and the list of output elements generated during this iteration.  The return
value of 'wholeMap' is the concatenation of the output element lists from
all iterations.

Processing stops when the remaining input list is empty.  An example
of a 'WholeFunc' is 'fixedWidth'. -}</span><span>
</span><a name="line-375"></a><span class="hs-identifier">wholeMap</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Data.List.Utils.html#WholeFunc"><span class="hs-identifier hs-type">WholeFunc</span></a><span> </span><a href="#local-6989586621679057848"><span class="hs-identifier hs-type">a</span></a><span> </span><a href="#local-6989586621679057849"><span class="hs-identifier hs-type">b</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679057848"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679057849"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">]</span><span>
</span><a name="line-376"></a><a name="wholeMap"><a href="Data.List.Utils.html#wholeMap"><span class="hs-identifier">wholeMap</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>              </span><span class="hs-comment">-- Empty input, empty output.</span><span>
</span><a name="line-377"></a><span class="hs-identifier">wholeMap</span><span> </span><span class="hs-special">(</span><a href="Data.List.Utils.html#WholeFunc"><span class="hs-identifier hs-var">WholeFunc</span></a><span> </span><a name="local-6989586621679057993"><a href="#local-6989586621679057993"><span class="hs-identifier">func</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679057994"><a href="#local-6989586621679057994"><span class="hs-identifier">inplist</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-378"></a><span>    </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679057995"><a href="#local-6989586621679057995"><span class="hs-identifier">nextfunc</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679057996"><a href="#local-6989586621679057996"><span class="hs-identifier">nextlist</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679057997"><a href="#local-6989586621679057997"><span class="hs-identifier">output</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679057993"><span class="hs-identifier hs-var">func</span></a><span> </span><a href="#local-6989586621679057994"><span class="hs-identifier hs-var">inplist</span></a><span>
</span><a name="line-379"></a><span>        </span><span class="hs-keyword">in</span><span>
</span><a name="line-380"></a><span>        </span><a href="#local-6989586621679057997"><span class="hs-identifier hs-var">output</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="Data.List.Utils.html#wholeMap"><span class="hs-identifier hs-var">wholeMap</span></a><span> </span><a href="#local-6989586621679057995"><span class="hs-identifier hs-var">nextfunc</span></a><span> </span><a href="#local-6989586621679057996"><span class="hs-identifier hs-var">nextlist</span></a><span>
</span><a name="line-381"></a><span>
</span><a name="line-382"></a><span class="hs-comment">{- | A parser designed to process fixed-width input fields.  Use it with
'wholeMap'.

The Int list passed to this function is the list of the field widths desired
from the input.  The result is a list of those widths, if possible.  If any
of the input remains after processing this list, it is added on as the final
element in the result list.  If the input is less than the sum of the requested
widths, then the result list will be short the appropriate number of elements,
and its final element may be shorter than requested.

Examples:

&gt;wholeMap (fixedWidth [1, 2, 3]) &quot;1234567890&quot;
&gt; --&gt; [&quot;1&quot;,&quot;23&quot;,&quot;456&quot;,&quot;7890&quot;]
&gt;wholeMap (fixedWidth (repeat 2)) &quot;123456789&quot;
&gt; --&gt; [&quot;12&quot;,&quot;34&quot;,&quot;56&quot;,&quot;78&quot;,&quot;9&quot;]
&gt;wholeMap (fixedWidth []) &quot;123456789&quot;
&gt; --&gt; [&quot;123456789&quot;]
&gt;wholeMap (fixedWidth [5, 3, 6, 1]) &quot;Hello, This is a test.&quot;
&gt; --&gt; [&quot;Hello&quot;,&quot;, T&quot;,&quot;his is&quot;,&quot; &quot;,&quot;a test.&quot;]
-}</span><span>
</span><a name="line-403"></a><span class="hs-identifier">fixedWidth</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">Int</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Data.List.Utils.html#WholeFunc"><span class="hs-identifier hs-type">WholeFunc</span></a><span> </span><a href="#local-6989586621679057847"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679057847"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-404"></a><a name="fixedWidth"><a href="Data.List.Utils.html#fixedWidth"><span class="hs-identifier">fixedWidth</span></a></a><span> </span><a name="local-6989586621679057998"><a href="#local-6989586621679057998"><span class="hs-identifier">len</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span>
</span><a name="line-405"></a><span>    </span><a href="Data.List.Utils.html#WholeFunc"><span class="hs-identifier hs-var">WholeFunc</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679057999"><span class="hs-identifier hs-var">fixedWidthFunc</span></a><span> </span><a href="#local-6989586621679057998"><span class="hs-identifier hs-var">len</span></a><span class="hs-special">)</span><span>
</span><a name="line-406"></a><span>    </span><span class="hs-keyword">where</span><span> </span><span class="hs-comment">-- Empty input: Empty output, stop</span><span>
</span><a name="line-407"></a><span>          </span><a name="local-6989586621679057999"><a href="#local-6989586621679057999"><span class="hs-identifier">fixedWidthFunc</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="Data.List.Utils.html#fixedWidth"><span class="hs-identifier hs-var">fixedWidth</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-408"></a><span>          </span><span class="hs-comment">-- Empty length: Stop here.</span><span>
</span><a name="line-409"></a><span>          </span><span class="hs-identifier">fixedWidthFunc</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><a name="local-6989586621679058000"><a href="#local-6989586621679058000"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="Data.List.Utils.html#fixedWidth"><span class="hs-identifier hs-var">fixedWidth</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679058000"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-410"></a><span>          </span><span class="hs-comment">-- Stuff to process: Do it.</span><span>
</span><a name="line-411"></a><span>          </span><span class="hs-identifier">fixedWidthFunc</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679058001"><a href="#local-6989586621679058001"><span class="hs-identifier">len</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679058002"><a href="#local-6989586621679058002"><span class="hs-identifier">lenxs</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679058003"><a href="#local-6989586621679058003"><span class="hs-identifier">input</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-412"></a><span>              </span><span class="hs-special">(</span><a href="Data.List.Utils.html#fixedWidth"><span class="hs-identifier hs-var">fixedWidth</span></a><span> </span><a href="#local-6989586621679058002"><span class="hs-identifier hs-var">lenxs</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679058005"><span class="hs-identifier hs-var">next</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679058004"><span class="hs-identifier hs-var">this</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-413"></a><span>              </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679058004"><a href="#local-6989586621679058004"><span class="hs-identifier">this</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679058005"><a href="#local-6989586621679058005"><span class="hs-identifier">next</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">splitAt</span><span> </span><a href="#local-6989586621679058001"><span class="hs-identifier hs-var">len</span></a><span> </span><a href="#local-6989586621679058003"><span class="hs-identifier hs-var">input</span></a><span>
</span><a name="line-414"></a><span>
</span><a name="line-415"></a><span class="hs-comment">{- | Helps you pick out fixed-width components from a list.

Example:

&gt;conv :: String -&gt; (String,String)
&gt;conv = runState $
&gt;        do f3 &lt;- grab 3
&gt;           n2 &lt;- grab 2
&gt;           return $ f3 ++ &quot;,&quot; ++ n2
&gt;
&gt;main = print $ conv &quot;TestIng&quot;

Prints:

&gt;(&quot;Tes,tI&quot;,&quot;ng&quot;)
-}</span><span>
</span><a name="line-431"></a><span>
</span><a name="line-432"></a><span class="hs-identifier">grab</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">State</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679057846"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679057846"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-433"></a><a name="grab"><a href="Data.List.Utils.html#grab"><span class="hs-identifier">grab</span></a></a><span> </span><a name="local-6989586621679058006"><a href="#local-6989586621679058006"><span class="hs-identifier">count</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-434"></a><span>    </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621679058130"><a href="#local-6989586621679058130"><span class="hs-identifier">g</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">get</span><span>
</span><a name="line-435"></a><span>       </span><span class="hs-special">(</span><a name="local-6989586621679058131"><a href="#local-6989586621679058131"><span class="hs-identifier">x</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679058132"><a href="#local-6989586621679058132"><span class="hs-identifier">g'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">splitAt</span><span> </span><a href="#local-6989586621679058006"><span class="hs-identifier hs-var">count</span></a><span> </span><a href="#local-6989586621679058130"><span class="hs-identifier hs-var">g</span></a><span>
</span><a name="line-436"></a><span>       </span><span class="hs-identifier hs-var">put</span><span> </span><a href="#local-6989586621679058132"><span class="hs-identifier hs-var">g'</span></a><span>
</span><a name="line-437"></a><span>       </span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-6989586621679058131"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-438"></a><span>
</span><a name="line-439"></a><span class="hs-comment">{- | Similar to Data.List.elemIndex.  Instead of looking for one element in a
list, this function looks for the first occurance of a sublist in the list,
and returns the index of the first element of that occurance.  If there is no
such list, returns Nothing.

If the list to look for is the empty list, will return Just 0 regardless
of the content of the list to search.

Examples:

&gt;subIndex &quot;foo&quot; &quot;asdfoobar&quot; -&gt; Just 3
&gt;subIndex &quot;foo&quot; [] -&gt; Nothing
&gt;subIndex &quot;&quot; [] -&gt; Just 0
&gt;subIndex &quot;&quot; &quot;asdf&quot; -&gt; Just 0
&gt;subIndex &quot;test&quot; &quot;asdftestbartest&quot; -&gt; Just 4
&gt;subIndex [(1::Int), 2] [0, 5, 3, 2, 1, 2, 4] -&gt; Just 4
 -}</span><span>
</span><a name="line-456"></a><span class="hs-identifier">subIndex</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="#local-6989586621679057845"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679057845"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679057845"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-identifier hs-type">Int</span><span>
</span><a name="line-457"></a><a name="subIndex"><a href="Data.List.Utils.html#subIndex"><span class="hs-identifier">subIndex</span></a></a><span> </span><a name="local-6989586621679058133"><a href="#local-6989586621679058133"><span class="hs-identifier">substr</span></a></a><span> </span><a name="local-6989586621679058134"><a href="#local-6989586621679058134"><span class="hs-identifier">str</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">findIndex</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">isPrefixOf</span><span> </span><a href="#local-6989586621679058133"><span class="hs-identifier hs-var">substr</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">tails</span><span> </span><a href="#local-6989586621679058134"><span class="hs-identifier hs-var">str</span></a><span class="hs-special">)</span><span>
</span><a name="line-458"></a><span>
</span><a name="line-459"></a><span class="hs-comment">{- | Given a list, returns a new list with all duplicate elements removed.
For example:

&gt;uniq &quot;Mississippi&quot; -&gt; &quot;Misp&quot;

You should not rely on this function necessarily preserving order, though
the current implementation happens to.

This function is not compatible with infinite lists.

This is presently an alias for Data.List.nub
 -}</span><span>
</span><a name="line-471"></a><span class="hs-identifier">uniq</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="#local-6989586621679057844"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679057844"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679057844"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-472"></a><a name="uniq"><a href="Data.List.Utils.html#uniq"><span class="hs-identifier">uniq</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">nub</span><span>
</span><a name="line-473"></a><span>
</span><a name="line-474"></a><span class="hs-comment">----- same as</span><span>
</span><a name="line-475"></a><span class="hs-comment">--uniq (x:xs) = x : [y | y &lt;- uniq xs, y /= x]</span><span>
</span><a name="line-476"></a><span>
</span><a name="line-477"></a><span>
</span><a name="line-478"></a><span>
</span><a name="line-479"></a></pre></body></html>