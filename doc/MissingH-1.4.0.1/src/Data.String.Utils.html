<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">{- arch-tag: String utilities main file
Copyright (c) 2004-2011 John Goerzen &lt;jgoerzen@complete.org&gt;

All rights reserved.

For license and copyright information, see the file LICENSE
-}</span><span>
</span><a name="line-8"></a><span>
</span><a name="line-9"></a><span class="hs-comment">{- |
   Module     : Data.String.Utils
   Copyright  : Copyright (C) 2004-2011 John Goerzen
   License    : BSD3

   Maintainer : John Goerzen &lt;jgoerzen@complete.org&gt;
   Stability  : provisional
   Portability: portable

This module provides various helpful utilities for dealing with strings.

Written by John Goerzen, jgoerzen\@complete.org
-}</span><span>
</span><a name="line-22"></a><span>
</span><a name="line-23"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">String</span><span class="hs-operator">.</span><span class="hs-identifier">Utils</span><span>
</span><a name="line-24"></a><span>                       </span><span class="hs-special">(</span><span class="hs-comment">-- * Whitespace Removal</span><span>
</span><a name="line-25"></a><span>                        </span><a href="Data.String.Utils.html#strip"><span class="hs-identifier hs-var">strip</span></a><span class="hs-special">,</span><span> </span><a href="Data.String.Utils.html#lstrip"><span class="hs-identifier hs-var">lstrip</span></a><span class="hs-special">,</span><span> </span><a href="Data.String.Utils.html#rstrip"><span class="hs-identifier hs-var">rstrip</span></a><span class="hs-special">,</span><span>
</span><a name="line-26"></a><span>                        </span><span class="hs-comment">-- * Tests</span><span>
</span><a name="line-27"></a><span>                        </span><span class="hs-comment">-- | Note: These functions are aliases for functions</span><span>
</span><a name="line-28"></a><span>                        </span><span class="hs-comment">-- in &quot;Data.List.Utils&quot;.</span><span>
</span><a name="line-29"></a><span>                        </span><a href="Data.List.Utils.html#startswith"><span class="hs-identifier hs-var">startswith</span></a><span class="hs-special">,</span><span> </span><a href="Data.List.Utils.html#endswith"><span class="hs-identifier hs-var">endswith</span></a><span class="hs-special">,</span><span>
</span><a name="line-30"></a><span>                        </span><span class="hs-comment">-- * Conversions</span><span>
</span><a name="line-31"></a><span>                        </span><span class="hs-comment">-- | Note: Some of these functions are aliases for functions</span><span>
</span><a name="line-32"></a><span>                        </span><span class="hs-comment">-- in &quot;Data.List.Utils&quot;.</span><span>
</span><a name="line-33"></a><span>                        </span><a href="Data.List.Utils.html#join"><span class="hs-identifier hs-var">join</span></a><span class="hs-special">,</span><span> </span><a href="Data.List.Utils.html#split"><span class="hs-identifier hs-var">split</span></a><span class="hs-special">,</span><span> </span><a href="Data.String.Utils.html#splitWs"><span class="hs-identifier hs-var">splitWs</span></a><span class="hs-special">,</span><span> </span><a href="Data.List.Utils.html#replace"><span class="hs-identifier hs-var">replace</span></a><span class="hs-special">,</span><span> </span><a href="Data.String.Utils.html#escapeRe"><span class="hs-identifier hs-var">escapeRe</span></a><span class="hs-special">,</span><span>
</span><a name="line-34"></a><span>                        </span><span class="hs-comment">-- * Reading</span><span>
</span><a name="line-35"></a><span>                        </span><a href="Data.String.Utils.html#maybeRead"><span class="hs-identifier hs-var">maybeRead</span></a><span>
</span><a name="line-36"></a><span>                       </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-37"></a><span>
</span><a name="line-38"></a><span class="hs-keyword">import</span><span> </span><a href="Data.List.Utils.html"><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">List</span><span class="hs-operator">.</span><span class="hs-identifier">Utils</span></a><span> </span><span class="hs-special">(</span><a href="Data.List.Utils.html#startswith"><span class="hs-identifier hs-var">startswith</span></a><span class="hs-special">,</span><span> </span><a href="Data.List.Utils.html#endswith"><span class="hs-identifier hs-var">endswith</span></a><span class="hs-special">,</span><span> </span><a href="Data.List.Utils.html#join"><span class="hs-identifier hs-var">join</span></a><span class="hs-special">,</span><span> </span><a href="Data.List.Utils.html#split"><span class="hs-identifier hs-var">split</span></a><span class="hs-special">,</span><span> </span><a href="Data.List.Utils.html#replace"><span class="hs-identifier hs-var">replace</span></a><span class="hs-special">)</span><span>
</span><a name="line-39"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Char</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">isAlpha</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">isAscii</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">isDigit</span><span class="hs-special">)</span><span>
</span><a name="line-40"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Maybe</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">listToMaybe</span><span class="hs-special">)</span><span>
</span><a name="line-41"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Text</span><span class="hs-operator">.</span><span class="hs-identifier">Regex</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">mkRegex</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">splitRegex</span><span class="hs-special">)</span><span>
</span><a name="line-42"></a><span>
</span><a name="line-43"></a><span class="hs-identifier">wschars</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-44"></a><a name="wschars"><a href="Data.String.Utils.html#wschars"><span class="hs-identifier">wschars</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot; \t\r\n&quot;</span><span>
</span><a name="line-45"></a><span>
</span><a name="line-46"></a><span class="hs-comment">{- | Removes any whitespace characters that are present at the start
or end of a string. Does not alter the internal contents of a
string. If no whitespace characters are present at the start or end
of a string, returns the original string unmodified. Safe to use on
any string.

Note that this may differ from some other similar
functions from other authors in that:

1. If multiple whitespace
characters are present all in a row, they are all removed;

2. If no
whitespace characters are present, nothing is done.
-}</span><span>
</span><a name="line-61"></a><span class="hs-identifier">strip</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-62"></a><a name="strip"><a href="Data.String.Utils.html#strip"><span class="hs-identifier">strip</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Data.String.Utils.html#lstrip"><span class="hs-identifier hs-var">lstrip</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Data.String.Utils.html#rstrip"><span class="hs-identifier hs-var">rstrip</span></a><span>
</span><a name="line-63"></a><span>
</span><a name="line-64"></a><span class="hs-comment">-- | Same as 'strip', but applies only to the left side of the string.</span><span>
</span><a name="line-65"></a><span class="hs-identifier">lstrip</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-66"></a><a name="lstrip"><a href="Data.String.Utils.html#lstrip"><span class="hs-identifier">lstrip</span></a></a><span> </span><a name="local-6989586621679082243"><a href="#local-6989586621679082243"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679082243"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-67"></a><span>                  </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-68"></a><span>                  </span><span class="hs-special">(</span><a name="local-6989586621679082244"><a href="#local-6989586621679082244"><span class="hs-identifier">x</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679082245"><a href="#local-6989586621679082245"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier hs-var">elem</span><span> </span><a href="#local-6989586621679082244"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="Data.String.Utils.html#wschars"><span class="hs-identifier hs-var">wschars</span></a><span>
</span><a name="line-69"></a><span>                            </span><span class="hs-keyword">then</span><span> </span><a href="Data.String.Utils.html#lstrip"><span class="hs-identifier hs-var">lstrip</span></a><span> </span><a href="#local-6989586621679082245"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-70"></a><span>                            </span><span class="hs-keyword">else</span><span> </span><a href="#local-6989586621679082243"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-71"></a><span>
</span><a name="line-72"></a><span class="hs-comment">-- | Same as 'strip', but applies only to the right side of the string.</span><span>
</span><a name="line-73"></a><span class="hs-identifier">rstrip</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-74"></a><a name="rstrip"><a href="Data.String.Utils.html#rstrip"><span class="hs-identifier">rstrip</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">reverse</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Data.String.Utils.html#lstrip"><span class="hs-identifier hs-var">lstrip</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">reverse</span><span>
</span><a name="line-75"></a><span>
</span><a name="line-76"></a><span class="hs-comment">{- | Splits a string around whitespace.  Empty elements in the result
list are automatically removed. -}</span><span>
</span><a name="line-78"></a><span class="hs-identifier">splitWs</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">String</span><span class="hs-special">]</span><span>
</span><a name="line-79"></a><a name="splitWs"><a href="Data.String.Utils.html#splitWs"><span class="hs-identifier">splitWs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">filter</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679082246"><a href="#local-6989586621679082246"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679082246"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">/=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">splitRegex</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">mkRegex</span><span> </span><span class="hs-string">&quot;[ \t\n\r\v\f]+&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-80"></a><span>
</span><a name="line-81"></a><span class="hs-comment">{- | Escape all characters in the input pattern that are not alphanumeric.

Does not make special allowances for NULL, which isn't valid in a
Haskell regular expression pattern. -}</span><span>
</span><a name="line-85"></a><span class="hs-identifier">escapeRe</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-86"></a><a name="escapeRe"><a href="Data.String.Utils.html#escapeRe"><span class="hs-identifier">escapeRe</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-87"></a><span class="hs-identifier">escapeRe</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679082247"><a href="#local-6989586621679082247"><span class="hs-identifier">x</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679082248"><a href="#local-6989586621679082248"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-88"></a><span>    </span><span class="hs-comment">-- Chars that we never escape</span><span>
</span><a name="line-89"></a><span>    </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679082247"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">elem</span><span class="hs-special">`</span><span> </span><span class="hs-special">[</span><span class="hs-char">'\''</span><span class="hs-special">,</span><span> </span><span class="hs-char">'`'</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679082247"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="Data.String.Utils.html#escapeRe"><span class="hs-identifier hs-var">escapeRe</span></a><span> </span><a href="#local-6989586621679082248"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-90"></a><span>    </span><span class="hs-comment">-- General rules for chars we never escape</span><span>
</span><a name="line-91"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">isDigit</span><span> </span><a href="#local-6989586621679082247"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">||</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">isAscii</span><span> </span><a href="#local-6989586621679082247"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-operator hs-var">&amp;&amp;</span><span> </span><span class="hs-identifier hs-var">isAlpha</span><span> </span><a href="#local-6989586621679082247"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">||</span><span> </span><a href="#local-6989586621679082247"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">elem</span><span class="hs-special">`</span><span> </span><span class="hs-special">[</span><span class="hs-char">'&lt;'</span><span class="hs-special">,</span><span> </span><span class="hs-char">'&gt;'</span><span class="hs-special">]</span><span>
</span><a name="line-92"></a><span>        </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679082247"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="Data.String.Utils.html#escapeRe"><span class="hs-identifier hs-var">escapeRe</span></a><span> </span><a href="#local-6989586621679082248"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-93"></a><span>    </span><span class="hs-comment">-- Escape everything else</span><span>
</span><a name="line-94"></a><span>    </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier hs-var">otherwise</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-char">'\\'</span><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679082247"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-glyph">:</span><span> </span><a href="Data.String.Utils.html#escapeRe"><span class="hs-identifier hs-var">escapeRe</span></a><span> </span><a href="#local-6989586621679082248"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-95"></a><span>
</span><a name="line-96"></a><span class="hs-comment">-- | Attempts to parse a value from the front of the string.</span><span>
</span><a name="line-97"></a><span class="hs-identifier">maybeRead</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Read</span><span> </span><a href="#local-6989586621679082242"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621679082242"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-98"></a><a name="maybeRead"><a href="Data.String.Utils.html#maybeRead"><span class="hs-identifier">maybeRead</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-identifier hs-var">fst</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">listToMaybe</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">reads</span><span>
</span><a name="line-99"></a></pre></body></html>