<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE Safe #-}</span><span>
</span><a name="line-2"></a><span class="hs-comment">{- arch-tag: Time utilities main file
Copyright (c) 2004-2011 John Goerzen &lt;jgoerzen@complete.org&gt;

All rights reserved.

For license and copyright information, see the file LICENSE
-}</span><span>
</span><a name="line-9"></a><span>
</span><a name="line-10"></a><span class="hs-comment">{- |
   Module     : System.Time.Utils
   Copyright  : Copyright (C) 2004-2011 John Goerzen
   License    : BSD3

   Maintainer : John Goerzen &lt;jgoerzen@complete.org&gt; 
   Stability  : provisional
   Portability: portable

This module provides various Haskell utilities for dealing with times and
dates.

Written by John Goerzen, jgoerzen\@complete.org
-}</span><span>
</span><a name="line-24"></a><span>
</span><a name="line-25"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">System</span><span class="hs-operator">.</span><span class="hs-identifier">Time</span><span class="hs-operator">.</span><span class="hs-identifier">Utils</span><span class="hs-special">(</span><span>
</span><a name="line-26"></a><span>                     </span><a href="System.Time.Utils.html#timelocal"><span class="hs-identifier hs-var">timelocal</span></a><span class="hs-special">,</span><span>
</span><a name="line-27"></a><span>                     </span><a href="System.Time.Utils.html#timegm"><span class="hs-identifier hs-var">timegm</span></a><span class="hs-special">,</span><span>
</span><a name="line-28"></a><span>                     </span><a href="System.Time.Utils.html#timeDiffToSecs"><span class="hs-identifier hs-var">timeDiffToSecs</span></a><span class="hs-special">,</span><span>
</span><a name="line-29"></a><span>                     </span><a href="System.Time.Utils.html#epoch"><span class="hs-identifier hs-var">epoch</span></a><span class="hs-special">,</span><span>
</span><a name="line-30"></a><span>                     </span><a href="System.Time.Utils.html#epochToClockTime"><span class="hs-identifier hs-var">epochToClockTime</span></a><span class="hs-special">,</span><span>
</span><a name="line-31"></a><span>                     </span><a href="System.Time.Utils.html#clockTimeToEpoch"><span class="hs-identifier hs-var">clockTimeToEpoch</span></a><span class="hs-special">,</span><span>
</span><a name="line-32"></a><span>                     </span><a href="System.Time.Utils.html#renderSecs"><span class="hs-identifier hs-var">renderSecs</span></a><span class="hs-special">,</span><span> </span><a href="System.Time.Utils.html#renderTD"><span class="hs-identifier hs-var">renderTD</span></a><span>
</span><a name="line-33"></a><span>                    </span><span class="hs-special">)</span><span>
</span><a name="line-34"></a><span class="hs-keyword">where</span><span>
</span><a name="line-35"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">System</span><span class="hs-operator">.</span><span class="hs-identifier">Time</span><span>
</span><a name="line-36"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Ratio</span><span>
</span><a name="line-37"></a><span>
</span><a name="line-38"></a><span class="hs-comment">{- | January 1, 1970, midnight, UTC, represented as a CalendarTime. -}</span><span>
</span><a name="line-39"></a><span class="hs-identifier">epoch</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">CalendarTime</span><span>
</span><a name="line-40"></a><a name="epoch"><a href="System.Time.Utils.html#epoch"><span class="hs-identifier">epoch</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">CalendarTime</span><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">ctYear</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">1970</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">ctMonth</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">January</span><span class="hs-special">,</span><span>
</span><a name="line-41"></a><span>                       </span><span class="hs-identifier">ctDay</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">1</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">ctHour</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">0</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">ctMin</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">0</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">ctSec</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">0</span><span class="hs-special">,</span><span>
</span><a name="line-42"></a><span>                       </span><span class="hs-identifier">ctPicosec</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">0</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">ctWDay</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Thursday</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">ctYDay</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">0</span><span class="hs-special">,</span><span>
</span><a name="line-43"></a><span>                       </span><span class="hs-identifier">ctTZName</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;UTC&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">ctTZ</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">0</span><span class="hs-special">,</span><span> </span><span class="hs-identifier">ctIsDST</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span class="hs-special">}</span><span>
</span><a name="line-44"></a><span>
</span><a name="line-45"></a><span class="hs-comment">{- | Converts the specified CalendarTime (see System.Time) to seconds-since-epoch time.

This conversion does respect the timezone specified on the input object.
If you want a conversion from UTC, specify ctTZ = 0 and ctIsDST = False.

When called like that, the behavior is equivolent to the GNU C function
timegm().  Unlike the C library, Haskell's CalendarTime supports
timezone information, so if such information is specified, it will impact
the result.
-}</span><span>
</span><a name="line-55"></a><span>
</span><a name="line-56"></a><span class="hs-identifier">timegm</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">CalendarTime</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Integer</span><span>
</span><a name="line-57"></a><a name="timegm"><a href="System.Time.Utils.html#timegm"><span class="hs-identifier">timegm</span></a></a><span> </span><a name="local-6989586621679035244"><a href="#local-6989586621679035244"><span class="hs-identifier">ct</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-58"></a><span>    </span><a href="System.Time.Utils.html#timeDiffToSecs"><span class="hs-identifier hs-var">timeDiffToSecs</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">diffClockTimes</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">toClockTime</span><span> </span><a href="#local-6989586621679035244"><span class="hs-identifier hs-var">ct</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">toClockTime</span><span> </span><a href="System.Time.Utils.html#epoch"><span class="hs-identifier hs-var">epoch</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-59"></a><span>
</span><a name="line-60"></a><span class="hs-comment">{- | Converts the specified CalendarTime (see System.Time) to 
seconds-since-epoch format.

The input CalendarTime is assumed to be the time as given in your local
timezone.  All timezone and DST fields in the object are ignored.

This behavior is equivolent to the timelocal() and mktime() functions that
C programmers are accustomed to.

Please note that the behavior for this function during the hour immediately
before or after a DST switchover may produce a result with a different hour
than you expect.
-}</span><span>
</span><a name="line-73"></a><span>
</span><a name="line-74"></a><span class="hs-identifier">timelocal</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">CalendarTime</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-identifier hs-type">Integer</span><span>
</span><a name="line-75"></a><a name="timelocal"><a href="System.Time.Utils.html#timelocal"><span class="hs-identifier">timelocal</span></a></a><span> </span><a name="local-6989586621679035245"><a href="#local-6989586621679035245"><span class="hs-identifier">ct</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-76"></a><span>    </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621679035247"><a href="#local-6989586621679035247"><span class="hs-identifier">guessct</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">toCalendarTime</span><span> </span><a href="#local-6989586621679035246"><span class="hs-identifier hs-var">guesscl</span></a><span>
</span><a name="line-77"></a><span>       </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679035248"><a href="#local-6989586621679035248"><span class="hs-identifier">newct</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679035245"><span class="hs-identifier hs-var">ct</span></a><span> </span><span class="hs-special">{</span><span class="hs-identifier">ctTZ</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">ctTZ</span><span> </span><a href="#local-6989586621679035247"><span class="hs-identifier hs-var">guessct</span></a><span class="hs-special">}</span><span>
</span><a name="line-78"></a><span>       </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="System.Time.Utils.html#timegm"><span class="hs-identifier hs-var">timegm</span></a><span> </span><a href="#local-6989586621679035248"><span class="hs-identifier hs-var">newct</span></a><span>
</span><a name="line-79"></a><span>    </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679035246"><a href="#local-6989586621679035246"><span class="hs-identifier">guesscl</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">toClockTime</span><span> </span><a href="#local-6989586621679035245"><span class="hs-identifier hs-var">ct</span></a><span>
</span><a name="line-80"></a><span>    </span><span>
</span><a name="line-81"></a><span class="hs-comment">{- | Converts the given timeDiff to the number of seconds it represents. 

Uses the same algorithm as normalizeTimeDiff in GHC. -}</span><span>
</span><a name="line-84"></a><span class="hs-identifier">timeDiffToSecs</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">TimeDiff</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Integer</span><span>
</span><a name="line-85"></a><a name="timeDiffToSecs"><a href="System.Time.Utils.html#timeDiffToSecs"><span class="hs-identifier">timeDiffToSecs</span></a></a><span> </span><a name="local-6989586621679035249"><a href="#local-6989586621679035249"><span class="hs-identifier">td</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span>
</span><a name="line-86"></a><span>    </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">tdSec</span><span> </span><a href="#local-6989586621679035249"><span class="hs-identifier hs-var">td</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">+</span><span>
</span><a name="line-87"></a><span>    </span><span class="hs-number">60</span><span> </span><span class="hs-operator hs-var">*</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">tdMin</span><span> </span><a href="#local-6989586621679035249"><span class="hs-identifier hs-var">td</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">+</span><span>
</span><a name="line-88"></a><span>          </span><span class="hs-number">60</span><span> </span><span class="hs-operator hs-var">*</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">tdHour</span><span> </span><a href="#local-6989586621679035249"><span class="hs-identifier hs-var">td</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">+</span><span>
</span><a name="line-89"></a><span>                </span><span class="hs-number">24</span><span> </span><span class="hs-operator hs-var">*</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">tdDay</span><span> </span><a href="#local-6989586621679035249"><span class="hs-identifier hs-var">td</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">+</span><span>
</span><a name="line-90"></a><span>                      </span><span class="hs-number">30</span><span> </span><span class="hs-operator hs-var">*</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">tdMonth</span><span> </span><a href="#local-6989586621679035249"><span class="hs-identifier hs-var">td</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">+</span><span>
</span><a name="line-91"></a><span>                            </span><span class="hs-number">365</span><span> </span><span class="hs-operator hs-var">*</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">fromIntegral</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">tdYear</span><span> </span><a href="#local-6989586621679035249"><span class="hs-identifier hs-var">td</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-92"></a><span>
</span><a name="line-93"></a><span class="hs-comment">{- | Converts an Epoch time represented with an arbitrary Real to a ClockTime.
This input could be a CTime from Foreign.C.Types or an EpochTime from
System.Posix.Types. -}</span><span>
</span><a name="line-96"></a><span class="hs-identifier">epochToClockTime</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Real</span><span> </span><a href="#local-6989586621679034689"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679034689"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">ClockTime</span><span>
</span><a name="line-97"></a><a name="epochToClockTime"><a href="System.Time.Utils.html#epochToClockTime"><span class="hs-identifier">epochToClockTime</span></a></a><span> </span><a name="local-6989586621679035250"><a href="#local-6989586621679035250"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-98"></a><span>    </span><span class="hs-identifier hs-var">TOD</span><span> </span><a href="#local-6989586621679035252"><span class="hs-identifier hs-var">seconds</span></a><span> </span><a href="#local-6989586621679035253"><span class="hs-identifier hs-var">secfrac</span></a><span>
</span><a name="line-99"></a><span>    </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679035251"><a href="#local-6989586621679035251"><span class="hs-identifier">ratval</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">toRational</span><span> </span><a href="#local-6989586621679035250"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-100"></a><span>          </span><a name="local-6989586621679035252"><a href="#local-6989586621679035252"><span class="hs-identifier">seconds</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">floor</span><span> </span><a href="#local-6989586621679035251"><span class="hs-identifier hs-var">ratval</span></a><span>
</span><a name="line-101"></a><span>          </span><a name="local-6989586621679035253"><a href="#local-6989586621679035253"><span class="hs-identifier">secfrac</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">floor</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679035251"><span class="hs-identifier hs-var">ratval</span></a><span> </span><span class="hs-glyph">-</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679035252"><span class="hs-identifier hs-var">seconds</span></a><span> </span><span class="hs-operator hs-var">%</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">*</span><span> </span><a href="#local-6989586621679035254"><span class="hs-identifier hs-var">picosecondfactor</span></a><span>
</span><a name="line-102"></a><span>          </span><a name="local-6989586621679035254"><a href="#local-6989586621679035254"><span class="hs-identifier">picosecondfactor</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-number">10</span><span> </span><span class="hs-operator hs-var">^</span><span> </span><span class="hs-number">12</span><span>
</span><a name="line-103"></a><span>          </span><span>
</span><a name="line-104"></a><span class="hs-comment">{- | Converts a ClockTime to something represented with an arbitrary Real.
The result could be treated as a CTime from Foreign.C.Types or EpochTime from
System.Posix.Types.  The inverse of 'epochToClockTime'.

Fractions of a second are not preserved by this function. -}</span><span>
</span><a name="line-109"></a><span class="hs-identifier">clockTimeToEpoch</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Num</span><span> </span><a href="#local-6989586621679034624"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">ClockTime</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679034624"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-110"></a><a name="clockTimeToEpoch"><a href="System.Time.Utils.html#clockTimeToEpoch"><span class="hs-identifier">clockTimeToEpoch</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">TOD</span><span> </span><a name="local-6989586621679035255"><a href="#local-6989586621679035255"><span class="hs-identifier">sec</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fromInteger</span><span> </span><a href="#local-6989586621679035255"><span class="hs-identifier hs-var">sec</span></a><span>
</span><a name="line-111"></a><span>
</span><a name="line-112"></a><span class="hs-comment">{- | Render a number of seconds as a human-readable amount.  Shows the two
most significant places.  For instance:

&gt;renderSecs 121 = &quot;2m1s&quot;

See also 'renderTD' for a function that works on a TimeDiff.
-}</span><span>
</span><a name="line-119"></a><span class="hs-identifier">renderSecs</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Integer</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-120"></a><a name="renderSecs"><a href="System.Time.Utils.html#renderSecs"><span class="hs-identifier">renderSecs</span></a></a><span> </span><a name="local-6989586621679035256"><a href="#local-6989586621679035256"><span class="hs-identifier">i</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="System.Time.Utils.html#renderTD"><span class="hs-identifier hs-var">renderTD</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">diffClockTimes</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">TOD</span><span> </span><a href="#local-6989586621679035256"><span class="hs-identifier hs-var">i</span></a><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">TOD</span><span> </span><span class="hs-number">0</span><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span>
</span><a name="line-121"></a><span>
</span><a name="line-122"></a><span class="hs-comment">{- | Like 'renderSecs', but takes a TimeDiff instead of an integer second
count. -}</span><span>
</span><a name="line-124"></a><span class="hs-identifier">renderTD</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">TimeDiff</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span>
</span><a name="line-125"></a><a name="renderTD"><a href="System.Time.Utils.html#renderTD"><span class="hs-identifier">renderTD</span></a></a><span> </span><a name="local-6989586621679035257"><a href="#local-6989586621679035257"><span class="hs-identifier">itd</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-126"></a><span>    </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679035262"><span class="hs-identifier hs-var">workinglist</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-127"></a><span>      </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-string">&quot;0s&quot;</span><span>
</span><a name="line-128"></a><span>      </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">concat</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><a name="local-6989586621679035463"><a href="#local-6989586621679035463"><span class="hs-identifier">q</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679035464"><a href="#local-6989586621679035464"><span class="hs-identifier">s</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679035463"><span class="hs-identifier hs-var">q</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679035464"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679035262"><span class="hs-identifier hs-var">workinglist</span></a><span>
</span><a name="line-129"></a><span>    </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679035258"><a href="#local-6989586621679035258"><span class="hs-identifier">td</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">normalizeTimeDiff</span><span> </span><a href="#local-6989586621679035257"><span class="hs-identifier hs-var">itd</span></a><span>
</span><a name="line-130"></a><span>          </span><a name="local-6989586621679035259"><a href="#local-6989586621679035259"><span class="hs-identifier">suffixlist</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;yMdhms&quot;</span><span>
</span><a name="line-131"></a><span>          </span><a name="local-6989586621679035260"><a href="#local-6989586621679035260"><span class="hs-identifier">quantlist</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="hs-identifier hs-var">TimeDiff</span><span> </span><a name="local-6989586621679035263"><a href="#local-6989586621679035263"><span class="hs-identifier">y</span></a></a><span> </span><a name="local-6989586621679035264"><a href="#local-6989586621679035264"><span class="hs-identifier">mo</span></a></a><span> </span><a name="local-6989586621679035265"><a href="#local-6989586621679035265"><span class="hs-identifier">d</span></a></a><span> </span><a name="local-6989586621679035266"><a href="#local-6989586621679035266"><span class="hs-identifier">h</span></a></a><span> </span><a name="local-6989586621679035267"><a href="#local-6989586621679035267"><span class="hs-identifier">m</span></a></a><span> </span><a name="local-6989586621679035268"><a href="#local-6989586621679035268"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679035263"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679035264"><span class="hs-identifier hs-var">mo</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679035265"><span class="hs-identifier hs-var">d</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679035266"><span class="hs-identifier hs-var">h</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679035267"><span class="hs-identifier hs-var">m</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679035268"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679035258"><span class="hs-identifier hs-var">td</span></a><span>
</span><a name="line-132"></a><span>          </span><a name="local-6989586621679035261"><a href="#local-6989586621679035261"><span class="hs-identifier">zippedlist</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">zip</span><span> </span><a href="#local-6989586621679035260"><span class="hs-identifier hs-var">quantlist</span></a><span> </span><a href="#local-6989586621679035259"><span class="hs-identifier hs-var">suffixlist</span></a><span>
</span><a name="line-133"></a><span>          </span><span class="hs-comment">-- Drop all leading elements that are 0, then take at most 2</span><span>
</span><a name="line-134"></a><span>          </span><a name="local-6989586621679035262"><a href="#local-6989586621679035262"><span class="hs-identifier">workinglist</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">take</span><span> </span><span class="hs-number">2</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">dropWhile</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><a name="local-6989586621679035462"><a href="#local-6989586621679035462"><span class="hs-identifier">q</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679035462"><span class="hs-identifier hs-var">q</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-number">0</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679035261"><span class="hs-identifier hs-var">zippedlist</span></a><span>
</span><a name="line-135"></a><span>
</span><a name="line-136"></a></pre></body></html>