<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE CPP                    #-}</span><span>
</span><a name="line-2"></a><span class="hs-pragma">{-# LANGUAGE FlexibleInstances      #-}</span><span>
</span><a name="line-3"></a><span class="hs-pragma">{-# LANGUAGE FunctionalDependencies #-}</span><span>
</span><a name="line-4"></a><span class="hs-pragma">{-# LANGUAGE MultiParamTypeClasses  #-}</span><span>
</span><a name="line-5"></a><span class="hs-pragma">{-# LANGUAGE Safe                   #-}</span><span>
</span><a name="line-6"></a><span class="hs-pragma">{-# LANGUAGE UndecidableInstances   #-}</span><span>
</span><a name="line-7"></a><span>
</span><a name="line-8"></a><span class="hs-comment">{- |
Module       :  Control.Monad.Random.Class
Copyright    :  (c) Brent Yorgey 2016
License      :  BSD3 (see LICENSE)
Maintainer   :  byorgey@gmail.com

The 'MonadRandom', 'MonadSplit', and 'MonadInterleave' classes.

* 'MonadRandom' abstracts over monads with the capability of
  generating random values.

* 'MonadSplit' abstracts over random monads with the ability to get a
  split generator state.  It is not very useful but kept here for
  backwards compatibility.

* 'MonadInterleave' abstracts over random monads supporting an
  'interleave' operation, which allows sequencing computations which do
  not depend on each other's random generator state, by splitting the
  generator between them.

This module also defines convenience functions for sampling from a
given collection of values, either uniformly or according to given
weights.

-}</span><span>
</span><a name="line-33"></a><span>
</span><a name="line-34"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Control</span><span class="hs-operator">.</span><span class="hs-identifier">Monad</span><span class="hs-operator">.</span><span class="hs-identifier">Random</span><span class="hs-operator">.</span><span class="hs-identifier">Class</span><span> </span><span class="hs-special">(</span><span>
</span><a name="line-35"></a><span>
</span><a name="line-36"></a><span>    </span><span class="hs-comment">-- * MonadRandom</span><span>
</span><a name="line-37"></a><span>    </span><a href="Control.Monad.Random.Class.html#MonadRandom"><span class="hs-identifier hs-type">MonadRandom</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-38"></a><span>
</span><a name="line-39"></a><span>    </span><span class="hs-comment">-- * MonadSplit</span><span>
</span><a name="line-40"></a><span>    </span><a href="Control.Monad.Random.Class.html#MonadSplit"><span class="hs-identifier hs-type">MonadSplit</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-41"></a><span>
</span><a name="line-42"></a><span>    </span><span class="hs-comment">-- * MonadInterleave</span><span>
</span><a name="line-43"></a><span>    </span><a href="Control.Monad.Random.Class.html#MonadInterleave"><span class="hs-identifier hs-type">MonadInterleave</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-44"></a><span>
</span><a name="line-45"></a><span>    </span><span class="hs-comment">-- * Sampling functions</span><span>
</span><a name="line-46"></a><span>    </span><a href="Control.Monad.Random.Class.html#fromList"><span class="hs-identifier hs-var">fromList</span></a><span class="hs-special">,</span><span>
</span><a name="line-47"></a><span>    </span><a href="Control.Monad.Random.Class.html#fromListMay"><span class="hs-identifier hs-var">fromListMay</span></a><span class="hs-special">,</span><span>
</span><a name="line-48"></a><span>    </span><a href="Control.Monad.Random.Class.html#uniform"><span class="hs-identifier hs-var">uniform</span></a><span class="hs-special">,</span><span>
</span><a name="line-49"></a><span>    </span><a href="Control.Monad.Random.Class.html#uniformMay"><span class="hs-identifier hs-var">uniformMay</span></a><span class="hs-special">,</span><span>
</span><a name="line-50"></a><span>    </span><a href="Control.Monad.Random.Class.html#weighted"><span class="hs-identifier hs-var">weighted</span></a><span class="hs-special">,</span><span>
</span><a name="line-51"></a><span>    </span><a href="Control.Monad.Random.Class.html#weightedMay"><span class="hs-identifier hs-var">weightedMay</span></a><span>
</span><a name="line-52"></a><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-53"></a><span>
</span><a name="line-54"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Control</span><span class="hs-operator">.</span><span class="hs-identifier">Monad</span><span>
</span><a name="line-55"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Control</span><span class="hs-operator">.</span><span class="hs-identifier">Monad</span><span class="hs-operator">.</span><span class="hs-identifier">Trans</span><span class="hs-operator">.</span><span class="hs-identifier">Class</span><span>
</span><a name="line-56"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Control</span><span class="hs-operator">.</span><span class="hs-identifier">Monad</span><span class="hs-operator">.</span><span class="hs-identifier">Trans</span><span class="hs-operator">.</span><span class="hs-identifier">Cont</span><span>
</span><a name="line-57"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Control</span><span class="hs-operator">.</span><span class="hs-identifier">Monad</span><span class="hs-operator">.</span><span class="hs-identifier">Trans</span><span class="hs-operator">.</span><span class="hs-identifier">Error</span><span>
</span><a name="line-58"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Control</span><span class="hs-operator">.</span><span class="hs-identifier">Monad</span><span class="hs-operator">.</span><span class="hs-identifier">Trans</span><span class="hs-operator">.</span><span class="hs-identifier">Except</span><span>
</span><a name="line-59"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Control</span><span class="hs-operator">.</span><span class="hs-identifier">Monad</span><span class="hs-operator">.</span><span class="hs-identifier">Trans</span><span class="hs-operator">.</span><span class="hs-identifier">Identity</span><span>
</span><a name="line-60"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Control</span><span class="hs-operator">.</span><span class="hs-identifier">Monad</span><span class="hs-operator">.</span><span class="hs-identifier">Trans</span><span class="hs-operator">.</span><span class="hs-identifier">List</span><span>
</span><a name="line-61"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Control</span><span class="hs-operator">.</span><span class="hs-identifier">Monad</span><span class="hs-operator">.</span><span class="hs-identifier">Trans</span><span class="hs-operator">.</span><span class="hs-identifier">Maybe</span><span>
</span><a name="line-62"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Control</span><span class="hs-operator">.</span><span class="hs-identifier">Monad</span><span class="hs-operator">.</span><span class="hs-identifier">Trans</span><span class="hs-operator">.</span><span class="hs-identifier">Reader</span><span>
</span><a name="line-63"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Control</span><span class="hs-operator">.</span><span class="hs-identifier">Monad</span><span class="hs-operator">.</span><span class="hs-identifier">Trans</span><span class="hs-operator">.</span><span class="hs-identifier">RWS</span><span class="hs-operator">.</span><span class="hs-identifier">Lazy</span><span>      </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">LazyRWS</span><span>
</span><a name="line-64"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Control</span><span class="hs-operator">.</span><span class="hs-identifier">Monad</span><span class="hs-operator">.</span><span class="hs-identifier">Trans</span><span class="hs-operator">.</span><span class="hs-identifier">RWS</span><span class="hs-operator">.</span><span class="hs-identifier">Strict</span><span>    </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">StrictRWS</span><span>
</span><a name="line-65"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Control</span><span class="hs-operator">.</span><span class="hs-identifier">Monad</span><span class="hs-operator">.</span><span class="hs-identifier">Trans</span><span class="hs-operator">.</span><span class="hs-identifier">State</span><span class="hs-operator">.</span><span class="hs-identifier">Lazy</span><span>    </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">LazyState</span><span>
</span><a name="line-66"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Control</span><span class="hs-operator">.</span><span class="hs-identifier">Monad</span><span class="hs-operator">.</span><span class="hs-identifier">Trans</span><span class="hs-operator">.</span><span class="hs-identifier">State</span><span class="hs-operator">.</span><span class="hs-identifier">Strict</span><span>  </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">StrictState</span><span>
</span><a name="line-67"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Control</span><span class="hs-operator">.</span><span class="hs-identifier">Monad</span><span class="hs-operator">.</span><span class="hs-identifier">Trans</span><span class="hs-operator">.</span><span class="hs-identifier">Writer</span><span class="hs-operator">.</span><span class="hs-identifier">Lazy</span><span>   </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">LazyWriter</span><span>
</span><a name="line-68"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Control</span><span class="hs-operator">.</span><span class="hs-identifier">Monad</span><span class="hs-operator">.</span><span class="hs-identifier">Trans</span><span class="hs-operator">.</span><span class="hs-identifier">Writer</span><span class="hs-operator">.</span><span class="hs-identifier">Strict</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">StrictWriter</span><span>
</span><a name="line-69"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">System</span><span class="hs-operator">.</span><span class="hs-identifier">Random</span><span>
</span><a name="line-70"></a><span>
</span><a name="line-71"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Foldable</span><span>                     </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">F</span><span>
</span><a name="line-72"></a><span>
</span><a name="line-73"></a><span class="hs-cpp">#if MIN_VERSION_base(4,8,0)</span><span>
</span><a name="line-74"></a><span class="hs-cpp">#else</span><span>
</span><a name="line-75"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Monoid</span><span>                       </span><span class="hs-special">(</span><span class="hs-identifier">Monoid</span><span class="hs-special">)</span><span>
</span><a name="line-76"></a><span class="hs-cpp">#endif</span><span>
</span><a name="line-77"></a><span>
</span><a name="line-78"></a><span class="hs-comment">------------------------------------------------------------</span><span>
</span><a name="line-79"></a><span class="hs-comment">-- MonadRandom</span><span>
</span><a name="line-80"></a><span class="hs-comment">------------------------------------------------------------</span><span>
</span><a name="line-81"></a><span>
</span><a name="line-82"></a><span class="hs-comment">-- | With a source of random number supply in hand, the 'MonadRandom' class</span><span>
</span><a name="line-83"></a><span class="hs-comment">-- allows the programmer to extract random values of a variety of types.</span><span>
</span><a name="line-84"></a><span class="hs-keyword">class</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="#local-6989586621679024437"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a name="MonadRandom"><a href="Control.Monad.Random.Class.html#MonadRandom"><span class="hs-identifier">MonadRandom</span></a></a><span> </span><a name="local-6989586621679024437"><a href="#local-6989586621679024437"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-85"></a><span>  </span><span class="hs-comment">-- | Takes a range /(lo,hi)/ and a random number generator</span><span>
</span><a name="line-86"></a><span>  </span><span class="hs-comment">-- /g/, and returns a computation that returns a random value uniformly</span><span>
</span><a name="line-87"></a><span>  </span><span class="hs-comment">-- distributed in the closed interval /[lo,hi]/, together with a new</span><span>
</span><a name="line-88"></a><span>  </span><span class="hs-comment">-- generator. It is unspecified what happens if /lo&gt;hi/. For continuous</span><span>
</span><a name="line-89"></a><span>  </span><span class="hs-comment">-- types there is no requirement that the values /lo/ and /hi/ are ever</span><span>
</span><a name="line-90"></a><span>  </span><span class="hs-comment">-- produced, but they may be, depending on the implementation and the</span><span>
</span><a name="line-91"></a><span>  </span><span class="hs-comment">-- interval.</span><span>
</span><a name="line-92"></a><span>  </span><span class="hs-comment">--</span><span>
</span><a name="line-93"></a><span>  </span><span class="hs-comment">-- See 'System.Random.randomR' for details.</span><span>
</span><a name="line-94"></a><span>  </span><span class="hs-identifier">getRandomR</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Random</span><span> </span><a href="#local-6989586621679024438"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679024438"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679024438"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679024437"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679024438"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-95"></a><span>
</span><a name="line-96"></a><span>  </span><span class="hs-comment">-- | The same as 'getRandomR', but using a default range determined by the type:</span><span>
</span><a name="line-97"></a><span>  </span><span class="hs-comment">--</span><span>
</span><a name="line-98"></a><span>  </span><span class="hs-comment">-- * For bounded types (instances of 'Bounded', such as 'Char'),</span><span>
</span><a name="line-99"></a><span>  </span><span class="hs-comment">--   the range is normally the whole type.</span><span>
</span><a name="line-100"></a><span>  </span><span class="hs-comment">--</span><span>
</span><a name="line-101"></a><span>  </span><span class="hs-comment">-- * For fractional types, the range is normally the semi-closed interval</span><span>
</span><a name="line-102"></a><span>  </span><span class="hs-comment">-- @[0,1)@.</span><span>
</span><a name="line-103"></a><span>  </span><span class="hs-comment">--</span><span>
</span><a name="line-104"></a><span>  </span><span class="hs-comment">-- * For 'Integer', the range is (arbitrarily) the range of 'Int'.</span><span>
</span><a name="line-105"></a><span>  </span><span class="hs-comment">--</span><span>
</span><a name="line-106"></a><span>  </span><span class="hs-comment">-- See 'System.Random.random' for details.</span><span>
</span><a name="line-107"></a><span>  </span><span class="hs-identifier">getRandom</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Random</span><span> </span><a href="#local-6989586621679024439"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679024437"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679024439"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-108"></a><span>
</span><a name="line-109"></a><span>  </span><span class="hs-comment">-- | Plural variant of 'getRandomR', producing an infinite list of</span><span>
</span><a name="line-110"></a><span>  </span><span class="hs-comment">-- random values instead of returning a new generator.</span><span>
</span><a name="line-111"></a><span>  </span><span class="hs-comment">--</span><span>
</span><a name="line-112"></a><span>  </span><span class="hs-comment">-- See 'System.Random.randomRs' for details.</span><span>
</span><a name="line-113"></a><span>  </span><span class="hs-identifier">getRandomRs</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Random</span><span> </span><a href="#local-6989586621679024440"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679024440"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679024440"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679024437"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679024440"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-114"></a><span>
</span><a name="line-115"></a><span>  </span><span class="hs-comment">-- | Plural variant of 'getRandom', producing an infinite list of</span><span>
</span><a name="line-116"></a><span>  </span><span class="hs-comment">-- random values instead of returning a new generator.</span><span>
</span><a name="line-117"></a><span>  </span><span class="hs-comment">--</span><span>
</span><a name="line-118"></a><span>  </span><span class="hs-comment">-- See 'System.Random.randoms' for details.</span><span>
</span><a name="line-119"></a><span>  </span><span class="hs-identifier">getRandoms</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Random</span><span> </span><a href="#local-6989586621679024441"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679024437"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679024441"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-120"></a><span>
</span><a name="line-121"></a><span class="hs-keyword">instance</span><span> </span><a href="Control.Monad.Random.Class.html#MonadRandom"><span class="hs-identifier hs-type">MonadRandom</span></a><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-122"></a><span>  </span><a name="local-8214565720323799334"><a href="Control.Monad.Random.Class.html#getRandomR"><span class="hs-identifier">getRandomR</span></a></a><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">randomRIO</span><span>
</span><a name="line-123"></a><span>  </span><a name="local-8214565720323799335"><a href="Control.Monad.Random.Class.html#getRandom"><span class="hs-identifier">getRandom</span></a></a><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">randomIO</span><span>
</span><a name="line-124"></a><span>  </span><a name="local-8214565720323799336"><a href="Control.Monad.Random.Class.html#getRandomRs"><span class="hs-identifier">getRandomRs</span></a></a><span> </span><a name="local-6989586621679026363"><a href="#local-6989586621679026363"><span class="hs-identifier">lohi</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">liftM</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">randomRs</span><span> </span><a href="#local-6989586621679026363"><span class="hs-identifier hs-var">lohi</span></a><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">newStdGen</span><span>
</span><a name="line-125"></a><span>  </span><a name="local-8214565720323799337"><a href="Control.Monad.Random.Class.html#getRandoms"><span class="hs-identifier">getRandoms</span></a></a><span>       </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">liftM</span><span> </span><span class="hs-identifier hs-var">randoms</span><span> </span><span class="hs-identifier hs-var">newStdGen</span><span>
</span><a name="line-126"></a><span>
</span><a name="line-127"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><a href="Control.Monad.Random.Class.html#MonadRandom"><span class="hs-identifier hs-type">MonadRandom</span></a><span> </span><a href="#local-6989586621679026361"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Control.Monad.Random.Class.html#MonadRandom"><span class="hs-identifier hs-type">MonadRandom</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">ContT</span><span> </span><a href="#local-6989586621679026362"><span class="hs-identifier hs-type">r</span></a><span> </span><a href="#local-6989586621679026361"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-128"></a><span>  </span><a name="local-8214565720323799334"><a href="Control.Monad.Random.Class.html#getRandomR"><span class="hs-identifier">getRandomR</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">lift</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Control.Monad.Random.Class.html#getRandomR"><span class="hs-identifier hs-var">getRandomR</span></a><span>
</span><a name="line-129"></a><span>  </span><a name="local-8214565720323799335"><a href="Control.Monad.Random.Class.html#getRandom"><span class="hs-identifier">getRandom</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">lift</span><span> </span><a href="Control.Monad.Random.Class.html#getRandom"><span class="hs-identifier hs-var">getRandom</span></a><span>
</span><a name="line-130"></a><span>  </span><a name="local-8214565720323799336"><a href="Control.Monad.Random.Class.html#getRandomRs"><span class="hs-identifier">getRandomRs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">lift</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Control.Monad.Random.Class.html#getRandomRs"><span class="hs-identifier hs-var">getRandomRs</span></a><span>
</span><a name="line-131"></a><span>  </span><a name="local-8214565720323799337"><a href="Control.Monad.Random.Class.html#getRandoms"><span class="hs-identifier">getRandoms</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">lift</span><span> </span><a href="Control.Monad.Random.Class.html#getRandoms"><span class="hs-identifier hs-var">getRandoms</span></a><span>
</span><a name="line-132"></a><span>
</span><a name="line-133"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Error</span><span> </span><a href="#local-6989586621679026359"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">,</span><span> </span><a href="Control.Monad.Random.Class.html#MonadRandom"><span class="hs-identifier hs-type">MonadRandom</span></a><span> </span><a href="#local-6989586621679026360"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Control.Monad.Random.Class.html#MonadRandom"><span class="hs-identifier hs-type">MonadRandom</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">ErrorT</span><span> </span><a href="#local-6989586621679026359"><span class="hs-identifier hs-type">e</span></a><span> </span><a href="#local-6989586621679026360"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-134"></a><span>  </span><a name="local-8214565720323799334"><a href="Control.Monad.Random.Class.html#getRandomR"><span class="hs-identifier">getRandomR</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">lift</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Control.Monad.Random.Class.html#getRandomR"><span class="hs-identifier hs-var">getRandomR</span></a><span>
</span><a name="line-135"></a><span>  </span><a name="local-8214565720323799335"><a href="Control.Monad.Random.Class.html#getRandom"><span class="hs-identifier">getRandom</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">lift</span><span> </span><a href="Control.Monad.Random.Class.html#getRandom"><span class="hs-identifier hs-var">getRandom</span></a><span>
</span><a name="line-136"></a><span>  </span><a name="local-8214565720323799336"><a href="Control.Monad.Random.Class.html#getRandomRs"><span class="hs-identifier">getRandomRs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">lift</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Control.Monad.Random.Class.html#getRandomRs"><span class="hs-identifier hs-var">getRandomRs</span></a><span>
</span><a name="line-137"></a><span>  </span><a name="local-8214565720323799337"><a href="Control.Monad.Random.Class.html#getRandoms"><span class="hs-identifier">getRandoms</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">lift</span><span> </span><a href="Control.Monad.Random.Class.html#getRandoms"><span class="hs-identifier hs-var">getRandoms</span></a><span>
</span><a name="line-138"></a><span>
</span><a name="line-139"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><a href="Control.Monad.Random.Class.html#MonadRandom"><span class="hs-identifier hs-type">MonadRandom</span></a><span> </span><a href="#local-6989586621679026357"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Control.Monad.Random.Class.html#MonadRandom"><span class="hs-identifier hs-type">MonadRandom</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">ExceptT</span><span> </span><a href="#local-6989586621679026358"><span class="hs-identifier hs-type">e</span></a><span> </span><a href="#local-6989586621679026357"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-140"></a><span>  </span><a name="local-8214565720323799334"><a href="Control.Monad.Random.Class.html#getRandomR"><span class="hs-identifier">getRandomR</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">lift</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Control.Monad.Random.Class.html#getRandomR"><span class="hs-identifier hs-var">getRandomR</span></a><span>
</span><a name="line-141"></a><span>  </span><a name="local-8214565720323799335"><a href="Control.Monad.Random.Class.html#getRandom"><span class="hs-identifier">getRandom</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">lift</span><span> </span><a href="Control.Monad.Random.Class.html#getRandom"><span class="hs-identifier hs-var">getRandom</span></a><span>
</span><a name="line-142"></a><span>  </span><a name="local-8214565720323799336"><a href="Control.Monad.Random.Class.html#getRandomRs"><span class="hs-identifier">getRandomRs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">lift</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Control.Monad.Random.Class.html#getRandomRs"><span class="hs-identifier hs-var">getRandomRs</span></a><span>
</span><a name="line-143"></a><span>  </span><a name="local-8214565720323799337"><a href="Control.Monad.Random.Class.html#getRandoms"><span class="hs-identifier">getRandoms</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">lift</span><span> </span><a href="Control.Monad.Random.Class.html#getRandoms"><span class="hs-identifier hs-var">getRandoms</span></a><span>
</span><a name="line-144"></a><span>
</span><a name="line-145"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><a href="Control.Monad.Random.Class.html#MonadRandom"><span class="hs-identifier hs-type">MonadRandom</span></a><span> </span><a href="#local-6989586621679026356"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Control.Monad.Random.Class.html#MonadRandom"><span class="hs-identifier hs-type">MonadRandom</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">IdentityT</span><span> </span><a href="#local-6989586621679026356"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-146"></a><span>  </span><a name="local-8214565720323799334"><a href="Control.Monad.Random.Class.html#getRandomR"><span class="hs-identifier">getRandomR</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">lift</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Control.Monad.Random.Class.html#getRandomR"><span class="hs-identifier hs-var">getRandomR</span></a><span>
</span><a name="line-147"></a><span>  </span><a name="local-8214565720323799335"><a href="Control.Monad.Random.Class.html#getRandom"><span class="hs-identifier">getRandom</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">lift</span><span> </span><a href="Control.Monad.Random.Class.html#getRandom"><span class="hs-identifier hs-var">getRandom</span></a><span>
</span><a name="line-148"></a><span>  </span><a name="local-8214565720323799336"><a href="Control.Monad.Random.Class.html#getRandomRs"><span class="hs-identifier">getRandomRs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">lift</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Control.Monad.Random.Class.html#getRandomRs"><span class="hs-identifier hs-var">getRandomRs</span></a><span>
</span><a name="line-149"></a><span>  </span><a name="local-8214565720323799337"><a href="Control.Monad.Random.Class.html#getRandoms"><span class="hs-identifier">getRandoms</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">lift</span><span> </span><a href="Control.Monad.Random.Class.html#getRandoms"><span class="hs-identifier hs-var">getRandoms</span></a><span>
</span><a name="line-150"></a><span>
</span><a name="line-151"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><a href="Control.Monad.Random.Class.html#MonadRandom"><span class="hs-identifier hs-type">MonadRandom</span></a><span> </span><a href="#local-6989586621679026355"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Control.Monad.Random.Class.html#MonadRandom"><span class="hs-identifier hs-type">MonadRandom</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">ListT</span><span> </span><a href="#local-6989586621679026355"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-152"></a><span>  </span><a name="local-8214565720323799334"><a href="Control.Monad.Random.Class.html#getRandomR"><span class="hs-identifier">getRandomR</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">lift</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Control.Monad.Random.Class.html#getRandomR"><span class="hs-identifier hs-var">getRandomR</span></a><span>
</span><a name="line-153"></a><span>  </span><a name="local-8214565720323799335"><a href="Control.Monad.Random.Class.html#getRandom"><span class="hs-identifier">getRandom</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">lift</span><span> </span><a href="Control.Monad.Random.Class.html#getRandom"><span class="hs-identifier hs-var">getRandom</span></a><span>
</span><a name="line-154"></a><span>  </span><a name="local-8214565720323799336"><a href="Control.Monad.Random.Class.html#getRandomRs"><span class="hs-identifier">getRandomRs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">lift</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Control.Monad.Random.Class.html#getRandomRs"><span class="hs-identifier hs-var">getRandomRs</span></a><span>
</span><a name="line-155"></a><span>  </span><a name="local-8214565720323799337"><a href="Control.Monad.Random.Class.html#getRandoms"><span class="hs-identifier">getRandoms</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">lift</span><span> </span><a href="Control.Monad.Random.Class.html#getRandoms"><span class="hs-identifier hs-var">getRandoms</span></a><span>
</span><a name="line-156"></a><span>
</span><a name="line-157"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><a href="Control.Monad.Random.Class.html#MonadRandom"><span class="hs-identifier hs-type">MonadRandom</span></a><span> </span><a href="#local-6989586621679026354"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Control.Monad.Random.Class.html#MonadRandom"><span class="hs-identifier hs-type">MonadRandom</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">MaybeT</span><span> </span><a href="#local-6989586621679026354"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-158"></a><span>  </span><a name="local-8214565720323799334"><a href="Control.Monad.Random.Class.html#getRandomR"><span class="hs-identifier">getRandomR</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">lift</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Control.Monad.Random.Class.html#getRandomR"><span class="hs-identifier hs-var">getRandomR</span></a><span>
</span><a name="line-159"></a><span>  </span><a name="local-8214565720323799335"><a href="Control.Monad.Random.Class.html#getRandom"><span class="hs-identifier">getRandom</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">lift</span><span> </span><a href="Control.Monad.Random.Class.html#getRandom"><span class="hs-identifier hs-var">getRandom</span></a><span>
</span><a name="line-160"></a><span>  </span><a name="local-8214565720323799336"><a href="Control.Monad.Random.Class.html#getRandomRs"><span class="hs-identifier">getRandomRs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">lift</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Control.Monad.Random.Class.html#getRandomRs"><span class="hs-identifier hs-var">getRandomRs</span></a><span>
</span><a name="line-161"></a><span>  </span><a name="local-8214565720323799337"><a href="Control.Monad.Random.Class.html#getRandoms"><span class="hs-identifier">getRandoms</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">lift</span><span> </span><a href="Control.Monad.Random.Class.html#getRandoms"><span class="hs-identifier hs-var">getRandoms</span></a><span>
</span><a name="line-162"></a><span>
</span><a name="line-163"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Monoid</span><span> </span><a href="#local-6989586621679026350"><span class="hs-identifier hs-type">w</span></a><span class="hs-special">,</span><span> </span><a href="Control.Monad.Random.Class.html#MonadRandom"><span class="hs-identifier hs-type">MonadRandom</span></a><span> </span><a href="#local-6989586621679026351"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Control.Monad.Random.Class.html#MonadRandom"><span class="hs-identifier hs-type">MonadRandom</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LazyRWS</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">RWST</span><span> </span><a href="#local-6989586621679026352"><span class="hs-identifier hs-type">r</span></a><span> </span><a href="#local-6989586621679026350"><span class="hs-identifier hs-type">w</span></a><span> </span><a href="#local-6989586621679026353"><span class="hs-identifier hs-type">s</span></a><span> </span><a href="#local-6989586621679026351"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-164"></a><span>  </span><a name="local-8214565720323799334"><a href="Control.Monad.Random.Class.html#getRandomR"><span class="hs-identifier">getRandomR</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">lift</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Control.Monad.Random.Class.html#getRandomR"><span class="hs-identifier hs-var">getRandomR</span></a><span>
</span><a name="line-165"></a><span>  </span><a name="local-8214565720323799335"><a href="Control.Monad.Random.Class.html#getRandom"><span class="hs-identifier">getRandom</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">lift</span><span> </span><a href="Control.Monad.Random.Class.html#getRandom"><span class="hs-identifier hs-var">getRandom</span></a><span>
</span><a name="line-166"></a><span>  </span><a name="local-8214565720323799336"><a href="Control.Monad.Random.Class.html#getRandomRs"><span class="hs-identifier">getRandomRs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">lift</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Control.Monad.Random.Class.html#getRandomRs"><span class="hs-identifier hs-var">getRandomRs</span></a><span>
</span><a name="line-167"></a><span>  </span><a name="local-8214565720323799337"><a href="Control.Monad.Random.Class.html#getRandoms"><span class="hs-identifier">getRandoms</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">lift</span><span> </span><a href="Control.Monad.Random.Class.html#getRandoms"><span class="hs-identifier hs-var">getRandoms</span></a><span>
</span><a name="line-168"></a><span>
</span><a name="line-169"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Monoid</span><span> </span><a href="#local-6989586621679026346"><span class="hs-identifier hs-type">w</span></a><span class="hs-special">,</span><span> </span><a href="Control.Monad.Random.Class.html#MonadRandom"><span class="hs-identifier hs-type">MonadRandom</span></a><span> </span><a href="#local-6989586621679026347"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Control.Monad.Random.Class.html#MonadRandom"><span class="hs-identifier hs-type">MonadRandom</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">StrictRWS</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">RWST</span><span> </span><a href="#local-6989586621679026348"><span class="hs-identifier hs-type">r</span></a><span> </span><a href="#local-6989586621679026346"><span class="hs-identifier hs-type">w</span></a><span> </span><a href="#local-6989586621679026349"><span class="hs-identifier hs-type">s</span></a><span> </span><a href="#local-6989586621679026347"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-170"></a><span>  </span><a name="local-8214565720323799334"><a href="Control.Monad.Random.Class.html#getRandomR"><span class="hs-identifier">getRandomR</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">lift</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Control.Monad.Random.Class.html#getRandomR"><span class="hs-identifier hs-var">getRandomR</span></a><span>
</span><a name="line-171"></a><span>  </span><a name="local-8214565720323799335"><a href="Control.Monad.Random.Class.html#getRandom"><span class="hs-identifier">getRandom</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">lift</span><span> </span><a href="Control.Monad.Random.Class.html#getRandom"><span class="hs-identifier hs-var">getRandom</span></a><span>
</span><a name="line-172"></a><span>  </span><a name="local-8214565720323799336"><a href="Control.Monad.Random.Class.html#getRandomRs"><span class="hs-identifier">getRandomRs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">lift</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Control.Monad.Random.Class.html#getRandomRs"><span class="hs-identifier hs-var">getRandomRs</span></a><span>
</span><a name="line-173"></a><span>  </span><a name="local-8214565720323799337"><a href="Control.Monad.Random.Class.html#getRandoms"><span class="hs-identifier">getRandoms</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">lift</span><span> </span><a href="Control.Monad.Random.Class.html#getRandoms"><span class="hs-identifier hs-var">getRandoms</span></a><span>
</span><a name="line-174"></a><span>
</span><a name="line-175"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><a href="Control.Monad.Random.Class.html#MonadRandom"><span class="hs-identifier hs-type">MonadRandom</span></a><span> </span><a href="#local-6989586621679026344"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Control.Monad.Random.Class.html#MonadRandom"><span class="hs-identifier hs-type">MonadRandom</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">ReaderT</span><span> </span><a href="#local-6989586621679026345"><span class="hs-identifier hs-type">r</span></a><span> </span><a href="#local-6989586621679026344"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-176"></a><span>  </span><a name="local-8214565720323799334"><a href="Control.Monad.Random.Class.html#getRandomR"><span class="hs-identifier">getRandomR</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">lift</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Control.Monad.Random.Class.html#getRandomR"><span class="hs-identifier hs-var">getRandomR</span></a><span>
</span><a name="line-177"></a><span>  </span><a name="local-8214565720323799335"><a href="Control.Monad.Random.Class.html#getRandom"><span class="hs-identifier">getRandom</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">lift</span><span> </span><a href="Control.Monad.Random.Class.html#getRandom"><span class="hs-identifier hs-var">getRandom</span></a><span>
</span><a name="line-178"></a><span>  </span><a name="local-8214565720323799336"><a href="Control.Monad.Random.Class.html#getRandomRs"><span class="hs-identifier">getRandomRs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">lift</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Control.Monad.Random.Class.html#getRandomRs"><span class="hs-identifier hs-var">getRandomRs</span></a><span>
</span><a name="line-179"></a><span>  </span><a name="local-8214565720323799337"><a href="Control.Monad.Random.Class.html#getRandoms"><span class="hs-identifier">getRandoms</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">lift</span><span> </span><a href="Control.Monad.Random.Class.html#getRandoms"><span class="hs-identifier hs-var">getRandoms</span></a><span>
</span><a name="line-180"></a><span>
</span><a name="line-181"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><a href="Control.Monad.Random.Class.html#MonadRandom"><span class="hs-identifier hs-type">MonadRandom</span></a><span> </span><a href="#local-6989586621679026342"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Control.Monad.Random.Class.html#MonadRandom"><span class="hs-identifier hs-type">MonadRandom</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LazyState</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">StateT</span><span> </span><a href="#local-6989586621679026343"><span class="hs-identifier hs-type">s</span></a><span> </span><a href="#local-6989586621679026342"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-182"></a><span>  </span><a name="local-8214565720323799334"><a href="Control.Monad.Random.Class.html#getRandomR"><span class="hs-identifier">getRandomR</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">lift</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Control.Monad.Random.Class.html#getRandomR"><span class="hs-identifier hs-var">getRandomR</span></a><span>
</span><a name="line-183"></a><span>  </span><a name="local-8214565720323799335"><a href="Control.Monad.Random.Class.html#getRandom"><span class="hs-identifier">getRandom</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">lift</span><span> </span><a href="Control.Monad.Random.Class.html#getRandom"><span class="hs-identifier hs-var">getRandom</span></a><span>
</span><a name="line-184"></a><span>  </span><a name="local-8214565720323799336"><a href="Control.Monad.Random.Class.html#getRandomRs"><span class="hs-identifier">getRandomRs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">lift</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Control.Monad.Random.Class.html#getRandomRs"><span class="hs-identifier hs-var">getRandomRs</span></a><span>
</span><a name="line-185"></a><span>  </span><a name="local-8214565720323799337"><a href="Control.Monad.Random.Class.html#getRandoms"><span class="hs-identifier">getRandoms</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">lift</span><span> </span><a href="Control.Monad.Random.Class.html#getRandoms"><span class="hs-identifier hs-var">getRandoms</span></a><span>
</span><a name="line-186"></a><span>
</span><a name="line-187"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><a href="Control.Monad.Random.Class.html#MonadRandom"><span class="hs-identifier hs-type">MonadRandom</span></a><span> </span><a href="#local-6989586621679026340"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Control.Monad.Random.Class.html#MonadRandom"><span class="hs-identifier hs-type">MonadRandom</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">StrictState</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">StateT</span><span> </span><a href="#local-6989586621679026341"><span class="hs-identifier hs-type">s</span></a><span> </span><a href="#local-6989586621679026340"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-188"></a><span>  </span><a name="local-8214565720323799334"><a href="Control.Monad.Random.Class.html#getRandomR"><span class="hs-identifier">getRandomR</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">lift</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Control.Monad.Random.Class.html#getRandomR"><span class="hs-identifier hs-var">getRandomR</span></a><span>
</span><a name="line-189"></a><span>  </span><a name="local-8214565720323799335"><a href="Control.Monad.Random.Class.html#getRandom"><span class="hs-identifier">getRandom</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">lift</span><span> </span><a href="Control.Monad.Random.Class.html#getRandom"><span class="hs-identifier hs-var">getRandom</span></a><span>
</span><a name="line-190"></a><span>  </span><a name="local-8214565720323799336"><a href="Control.Monad.Random.Class.html#getRandomRs"><span class="hs-identifier">getRandomRs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">lift</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Control.Monad.Random.Class.html#getRandomRs"><span class="hs-identifier hs-var">getRandomRs</span></a><span>
</span><a name="line-191"></a><span>  </span><a name="local-8214565720323799337"><a href="Control.Monad.Random.Class.html#getRandoms"><span class="hs-identifier">getRandoms</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">lift</span><span> </span><a href="Control.Monad.Random.Class.html#getRandoms"><span class="hs-identifier hs-var">getRandoms</span></a><span>
</span><a name="line-192"></a><span>
</span><a name="line-193"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><a href="Control.Monad.Random.Class.html#MonadRandom"><span class="hs-identifier hs-type">MonadRandom</span></a><span> </span><a href="#local-6989586621679026338"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Monoid</span><span> </span><a href="#local-6989586621679026339"><span class="hs-identifier hs-type">w</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Control.Monad.Random.Class.html#MonadRandom"><span class="hs-identifier hs-type">MonadRandom</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LazyWriter</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">WriterT</span><span> </span><a href="#local-6989586621679026339"><span class="hs-identifier hs-type">w</span></a><span> </span><a href="#local-6989586621679026338"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-194"></a><span>  </span><a name="local-8214565720323799334"><a href="Control.Monad.Random.Class.html#getRandomR"><span class="hs-identifier">getRandomR</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">lift</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Control.Monad.Random.Class.html#getRandomR"><span class="hs-identifier hs-var">getRandomR</span></a><span>
</span><a name="line-195"></a><span>  </span><a name="local-8214565720323799335"><a href="Control.Monad.Random.Class.html#getRandom"><span class="hs-identifier">getRandom</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">lift</span><span> </span><a href="Control.Monad.Random.Class.html#getRandom"><span class="hs-identifier hs-var">getRandom</span></a><span>
</span><a name="line-196"></a><span>  </span><a name="local-8214565720323799336"><a href="Control.Monad.Random.Class.html#getRandomRs"><span class="hs-identifier">getRandomRs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">lift</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Control.Monad.Random.Class.html#getRandomRs"><span class="hs-identifier hs-var">getRandomRs</span></a><span>
</span><a name="line-197"></a><span>  </span><a name="local-8214565720323799337"><a href="Control.Monad.Random.Class.html#getRandoms"><span class="hs-identifier">getRandoms</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">lift</span><span> </span><a href="Control.Monad.Random.Class.html#getRandoms"><span class="hs-identifier hs-var">getRandoms</span></a><span>
</span><a name="line-198"></a><span>
</span><a name="line-199"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><a href="Control.Monad.Random.Class.html#MonadRandom"><span class="hs-identifier hs-type">MonadRandom</span></a><span> </span><a href="#local-6989586621679026336"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Monoid</span><span> </span><a href="#local-6989586621679026337"><span class="hs-identifier hs-type">w</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Control.Monad.Random.Class.html#MonadRandom"><span class="hs-identifier hs-type">MonadRandom</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">StrictWriter</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">WriterT</span><span> </span><a href="#local-6989586621679026337"><span class="hs-identifier hs-type">w</span></a><span> </span><a href="#local-6989586621679026336"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-200"></a><span>  </span><a name="local-8214565720323799334"><a href="Control.Monad.Random.Class.html#getRandomR"><span class="hs-identifier">getRandomR</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">lift</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Control.Monad.Random.Class.html#getRandomR"><span class="hs-identifier hs-var">getRandomR</span></a><span>
</span><a name="line-201"></a><span>  </span><a name="local-8214565720323799335"><a href="Control.Monad.Random.Class.html#getRandom"><span class="hs-identifier">getRandom</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">lift</span><span> </span><a href="Control.Monad.Random.Class.html#getRandom"><span class="hs-identifier hs-var">getRandom</span></a><span>
</span><a name="line-202"></a><span>  </span><a name="local-8214565720323799336"><a href="Control.Monad.Random.Class.html#getRandomRs"><span class="hs-identifier">getRandomRs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">lift</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Control.Monad.Random.Class.html#getRandomRs"><span class="hs-identifier hs-var">getRandomRs</span></a><span>
</span><a name="line-203"></a><span>  </span><a name="local-8214565720323799337"><a href="Control.Monad.Random.Class.html#getRandoms"><span class="hs-identifier">getRandoms</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">lift</span><span> </span><a href="Control.Monad.Random.Class.html#getRandoms"><span class="hs-identifier hs-var">getRandoms</span></a><span>
</span><a name="line-204"></a><span>
</span><a name="line-205"></a><span class="hs-comment">------------------------------------------------------------</span><span>
</span><a name="line-206"></a><span class="hs-comment">-- MonadSplit</span><span>
</span><a name="line-207"></a><span class="hs-comment">------------------------------------------------------------</span><span>
</span><a name="line-208"></a><span>
</span><a name="line-209"></a><span class="hs-comment">-- | The class 'MonadSplit' proivides a way to specify a random number</span><span>
</span><a name="line-210"></a><span class="hs-comment">--   generator that can be split into two new generators.</span><span>
</span><a name="line-211"></a><span class="hs-comment">--</span><span>
</span><a name="line-212"></a><span class="hs-comment">--   This class is not very useful in practice: typically, one cannot</span><span>
</span><a name="line-213"></a><span class="hs-comment">--   actually do anything with a generator.  It remains here to avoid</span><span>
</span><a name="line-214"></a><span class="hs-comment">--   breaking existing code unnecessarily.  For a more practically</span><span>
</span><a name="line-215"></a><span class="hs-comment">--   useful interface, see 'MonadInterleave'.</span><span>
</span><a name="line-216"></a><span class="hs-keyword">class</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Monad</span><span> </span><a href="#local-6989586621679024436"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a name="MonadSplit"><a href="Control.Monad.Random.Class.html#MonadSplit"><span class="hs-identifier">MonadSplit</span></a></a><span> </span><a name="local-6989586621679024435"><a href="#local-6989586621679024435"><span class="hs-identifier">g</span></a></a><span> </span><a name="local-6989586621679024436"><a href="#local-6989586621679024436"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-identifier">m</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier">g</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-217"></a><span>
</span><a name="line-218"></a><span>  </span><span class="hs-comment">-- | The 'getSplit' operation allows one to obtain two distinct random number</span><span>
</span><a name="line-219"></a><span>  </span><span class="hs-comment">-- generators.</span><span>
</span><a name="line-220"></a><span>  </span><span class="hs-comment">--</span><span>
</span><a name="line-221"></a><span>  </span><span class="hs-comment">-- See 'System.Random.split' for details.</span><span>
</span><a name="line-222"></a><span>  </span><span class="hs-identifier">getSplit</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679024436"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679024435"><span class="hs-identifier hs-type">g</span></a><span>
</span><a name="line-223"></a><span>
</span><a name="line-224"></a><span class="hs-keyword">instance</span><span> </span><a href="Control.Monad.Random.Class.html#MonadSplit"><span class="hs-identifier hs-type">MonadSplit</span></a><span> </span><span class="hs-identifier hs-type">StdGen</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-225"></a><span>  </span><a name="local-8214565720323799332"><a href="Control.Monad.Random.Class.html#getSplit"><span class="hs-identifier">getSplit</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">newStdGen</span><span>
</span><a name="line-226"></a><span>
</span><a name="line-227"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><a href="Control.Monad.Random.Class.html#MonadSplit"><span class="hs-identifier hs-type">MonadSplit</span></a><span> </span><a href="#local-6989586621679024506"><span class="hs-identifier hs-type">g</span></a><span> </span><a href="#local-6989586621679024507"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Control.Monad.Random.Class.html#MonadSplit"><span class="hs-identifier hs-type">MonadSplit</span></a><span> </span><a href="#local-6989586621679024506"><span class="hs-identifier hs-type">g</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">ContT</span><span> </span><a href="#local-6989586621679024508"><span class="hs-identifier hs-type">r</span></a><span> </span><a href="#local-6989586621679024507"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-228"></a><span>  </span><a name="local-8214565720323799332"><a href="Control.Monad.Random.Class.html#getSplit"><span class="hs-identifier">getSplit</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">lift</span><span> </span><a href="Control.Monad.Random.Class.html#getSplit"><span class="hs-identifier hs-var">getSplit</span></a><span>
</span><a name="line-229"></a><span>
</span><a name="line-230"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Error</span><span> </span><a href="#local-6989586621679024503"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">,</span><span> </span><a href="Control.Monad.Random.Class.html#MonadSplit"><span class="hs-identifier hs-type">MonadSplit</span></a><span> </span><a href="#local-6989586621679024504"><span class="hs-identifier hs-type">g</span></a><span> </span><a href="#local-6989586621679024505"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Control.Monad.Random.Class.html#MonadSplit"><span class="hs-identifier hs-type">MonadSplit</span></a><span> </span><a href="#local-6989586621679024504"><span class="hs-identifier hs-type">g</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">ErrorT</span><span> </span><a href="#local-6989586621679024503"><span class="hs-identifier hs-type">e</span></a><span> </span><a href="#local-6989586621679024505"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-231"></a><span>  </span><a name="local-8214565720323799332"><a href="Control.Monad.Random.Class.html#getSplit"><span class="hs-identifier">getSplit</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">lift</span><span> </span><a href="Control.Monad.Random.Class.html#getSplit"><span class="hs-identifier hs-var">getSplit</span></a><span>
</span><a name="line-232"></a><span>
</span><a name="line-233"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><a href="Control.Monad.Random.Class.html#MonadSplit"><span class="hs-identifier hs-type">MonadSplit</span></a><span> </span><a href="#local-6989586621679024500"><span class="hs-identifier hs-type">g</span></a><span> </span><a href="#local-6989586621679024501"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Control.Monad.Random.Class.html#MonadSplit"><span class="hs-identifier hs-type">MonadSplit</span></a><span> </span><a href="#local-6989586621679024500"><span class="hs-identifier hs-type">g</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">ExceptT</span><span> </span><a href="#local-6989586621679024502"><span class="hs-identifier hs-type">e</span></a><span> </span><a href="#local-6989586621679024501"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-234"></a><span>  </span><a name="local-8214565720323799332"><a href="Control.Monad.Random.Class.html#getSplit"><span class="hs-identifier">getSplit</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">lift</span><span> </span><a href="Control.Monad.Random.Class.html#getSplit"><span class="hs-identifier hs-var">getSplit</span></a><span>
</span><a name="line-235"></a><span>
</span><a name="line-236"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><a href="Control.Monad.Random.Class.html#MonadSplit"><span class="hs-identifier hs-type">MonadSplit</span></a><span> </span><a href="#local-6989586621679024498"><span class="hs-identifier hs-type">g</span></a><span> </span><a href="#local-6989586621679024499"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Control.Monad.Random.Class.html#MonadSplit"><span class="hs-identifier hs-type">MonadSplit</span></a><span> </span><a href="#local-6989586621679024498"><span class="hs-identifier hs-type">g</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">IdentityT</span><span> </span><a href="#local-6989586621679024499"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-237"></a><span>  </span><a name="local-8214565720323799332"><a href="Control.Monad.Random.Class.html#getSplit"><span class="hs-identifier">getSplit</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">lift</span><span> </span><a href="Control.Monad.Random.Class.html#getSplit"><span class="hs-identifier hs-var">getSplit</span></a><span>
</span><a name="line-238"></a><span>
</span><a name="line-239"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><a href="Control.Monad.Random.Class.html#MonadSplit"><span class="hs-identifier hs-type">MonadSplit</span></a><span> </span><a href="#local-6989586621679024496"><span class="hs-identifier hs-type">g</span></a><span> </span><a href="#local-6989586621679024497"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Control.Monad.Random.Class.html#MonadSplit"><span class="hs-identifier hs-type">MonadSplit</span></a><span> </span><a href="#local-6989586621679024496"><span class="hs-identifier hs-type">g</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">ListT</span><span> </span><a href="#local-6989586621679024497"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-240"></a><span>  </span><a name="local-8214565720323799332"><a href="Control.Monad.Random.Class.html#getSplit"><span class="hs-identifier">getSplit</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">lift</span><span> </span><a href="Control.Monad.Random.Class.html#getSplit"><span class="hs-identifier hs-var">getSplit</span></a><span>
</span><a name="line-241"></a><span>
</span><a name="line-242"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><a href="Control.Monad.Random.Class.html#MonadSplit"><span class="hs-identifier hs-type">MonadSplit</span></a><span> </span><a href="#local-6989586621679024494"><span class="hs-identifier hs-type">g</span></a><span> </span><a href="#local-6989586621679024495"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Control.Monad.Random.Class.html#MonadSplit"><span class="hs-identifier hs-type">MonadSplit</span></a><span> </span><a href="#local-6989586621679024494"><span class="hs-identifier hs-type">g</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">MaybeT</span><span> </span><a href="#local-6989586621679024495"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-243"></a><span>  </span><a name="local-8214565720323799332"><a href="Control.Monad.Random.Class.html#getSplit"><span class="hs-identifier">getSplit</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">lift</span><span> </span><a href="Control.Monad.Random.Class.html#getSplit"><span class="hs-identifier hs-var">getSplit</span></a><span>
</span><a name="line-244"></a><span>
</span><a name="line-245"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Monoid</span><span> </span><a href="#local-6989586621679024489"><span class="hs-identifier hs-type">w</span></a><span class="hs-special">,</span><span> </span><a href="Control.Monad.Random.Class.html#MonadSplit"><span class="hs-identifier hs-type">MonadSplit</span></a><span> </span><a href="#local-6989586621679024490"><span class="hs-identifier hs-type">g</span></a><span> </span><a href="#local-6989586621679024491"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Control.Monad.Random.Class.html#MonadSplit"><span class="hs-identifier hs-type">MonadSplit</span></a><span> </span><a href="#local-6989586621679024490"><span class="hs-identifier hs-type">g</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LazyRWS</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">RWST</span><span> </span><a href="#local-6989586621679024492"><span class="hs-identifier hs-type">r</span></a><span> </span><a href="#local-6989586621679024489"><span class="hs-identifier hs-type">w</span></a><span> </span><a href="#local-6989586621679024493"><span class="hs-identifier hs-type">s</span></a><span> </span><a href="#local-6989586621679024491"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-246"></a><span>  </span><a name="local-8214565720323799332"><a href="Control.Monad.Random.Class.html#getSplit"><span class="hs-identifier">getSplit</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">lift</span><span> </span><a href="Control.Monad.Random.Class.html#getSplit"><span class="hs-identifier hs-var">getSplit</span></a><span>
</span><a name="line-247"></a><span>
</span><a name="line-248"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Monoid</span><span> </span><a href="#local-6989586621679024484"><span class="hs-identifier hs-type">w</span></a><span class="hs-special">,</span><span> </span><a href="Control.Monad.Random.Class.html#MonadSplit"><span class="hs-identifier hs-type">MonadSplit</span></a><span> </span><a href="#local-6989586621679024485"><span class="hs-identifier hs-type">g</span></a><span> </span><a href="#local-6989586621679024486"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Control.Monad.Random.Class.html#MonadSplit"><span class="hs-identifier hs-type">MonadSplit</span></a><span> </span><a href="#local-6989586621679024485"><span class="hs-identifier hs-type">g</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">StrictRWS</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">RWST</span><span> </span><a href="#local-6989586621679024487"><span class="hs-identifier hs-type">r</span></a><span> </span><a href="#local-6989586621679024484"><span class="hs-identifier hs-type">w</span></a><span> </span><a href="#local-6989586621679024488"><span class="hs-identifier hs-type">s</span></a><span> </span><a href="#local-6989586621679024486"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-249"></a><span>  </span><a name="local-8214565720323799332"><a href="Control.Monad.Random.Class.html#getSplit"><span class="hs-identifier">getSplit</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">lift</span><span> </span><a href="Control.Monad.Random.Class.html#getSplit"><span class="hs-identifier hs-var">getSplit</span></a><span>
</span><a name="line-250"></a><span>
</span><a name="line-251"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><a href="Control.Monad.Random.Class.html#MonadSplit"><span class="hs-identifier hs-type">MonadSplit</span></a><span> </span><a href="#local-6989586621679024481"><span class="hs-identifier hs-type">g</span></a><span> </span><a href="#local-6989586621679024482"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Control.Monad.Random.Class.html#MonadSplit"><span class="hs-identifier hs-type">MonadSplit</span></a><span> </span><a href="#local-6989586621679024481"><span class="hs-identifier hs-type">g</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">ReaderT</span><span> </span><a href="#local-6989586621679024483"><span class="hs-identifier hs-type">r</span></a><span> </span><a href="#local-6989586621679024482"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-252"></a><span>  </span><a name="local-8214565720323799332"><a href="Control.Monad.Random.Class.html#getSplit"><span class="hs-identifier">getSplit</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">lift</span><span> </span><a href="Control.Monad.Random.Class.html#getSplit"><span class="hs-identifier hs-var">getSplit</span></a><span>
</span><a name="line-253"></a><span>
</span><a name="line-254"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><a href="Control.Monad.Random.Class.html#MonadSplit"><span class="hs-identifier hs-type">MonadSplit</span></a><span> </span><a href="#local-6989586621679024478"><span class="hs-identifier hs-type">g</span></a><span> </span><a href="#local-6989586621679024479"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Control.Monad.Random.Class.html#MonadSplit"><span class="hs-identifier hs-type">MonadSplit</span></a><span> </span><a href="#local-6989586621679024478"><span class="hs-identifier hs-type">g</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LazyState</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">StateT</span><span> </span><a href="#local-6989586621679024480"><span class="hs-identifier hs-type">s</span></a><span> </span><a href="#local-6989586621679024479"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-255"></a><span>  </span><a name="local-8214565720323799332"><a href="Control.Monad.Random.Class.html#getSplit"><span class="hs-identifier">getSplit</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">lift</span><span> </span><a href="Control.Monad.Random.Class.html#getSplit"><span class="hs-identifier hs-var">getSplit</span></a><span>
</span><a name="line-256"></a><span>
</span><a name="line-257"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><a href="Control.Monad.Random.Class.html#MonadSplit"><span class="hs-identifier hs-type">MonadSplit</span></a><span> </span><a href="#local-6989586621679024475"><span class="hs-identifier hs-type">g</span></a><span> </span><a href="#local-6989586621679024476"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Control.Monad.Random.Class.html#MonadSplit"><span class="hs-identifier hs-type">MonadSplit</span></a><span> </span><a href="#local-6989586621679024475"><span class="hs-identifier hs-type">g</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">StrictState</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">StateT</span><span> </span><a href="#local-6989586621679024477"><span class="hs-identifier hs-type">s</span></a><span> </span><a href="#local-6989586621679024476"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-258"></a><span>  </span><a name="local-8214565720323799332"><a href="Control.Monad.Random.Class.html#getSplit"><span class="hs-identifier">getSplit</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">lift</span><span> </span><a href="Control.Monad.Random.Class.html#getSplit"><span class="hs-identifier hs-var">getSplit</span></a><span>
</span><a name="line-259"></a><span>
</span><a name="line-260"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Monoid</span><span> </span><a href="#local-6989586621679024472"><span class="hs-identifier hs-type">w</span></a><span class="hs-special">,</span><span> </span><a href="Control.Monad.Random.Class.html#MonadSplit"><span class="hs-identifier hs-type">MonadSplit</span></a><span> </span><a href="#local-6989586621679024473"><span class="hs-identifier hs-type">g</span></a><span> </span><a href="#local-6989586621679024474"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Control.Monad.Random.Class.html#MonadSplit"><span class="hs-identifier hs-type">MonadSplit</span></a><span> </span><a href="#local-6989586621679024473"><span class="hs-identifier hs-type">g</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LazyWriter</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">WriterT</span><span> </span><a href="#local-6989586621679024472"><span class="hs-identifier hs-type">w</span></a><span> </span><a href="#local-6989586621679024474"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-261"></a><span>  </span><a name="local-8214565720323799332"><a href="Control.Monad.Random.Class.html#getSplit"><span class="hs-identifier">getSplit</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">lift</span><span> </span><a href="Control.Monad.Random.Class.html#getSplit"><span class="hs-identifier hs-var">getSplit</span></a><span>
</span><a name="line-262"></a><span>
</span><a name="line-263"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Monoid</span><span> </span><a href="#local-6989586621679024469"><span class="hs-identifier hs-type">w</span></a><span class="hs-special">,</span><span> </span><a href="Control.Monad.Random.Class.html#MonadSplit"><span class="hs-identifier hs-type">MonadSplit</span></a><span> </span><a href="#local-6989586621679024470"><span class="hs-identifier hs-type">g</span></a><span> </span><a href="#local-6989586621679024471"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Control.Monad.Random.Class.html#MonadSplit"><span class="hs-identifier hs-type">MonadSplit</span></a><span> </span><a href="#local-6989586621679024470"><span class="hs-identifier hs-type">g</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">StrictWriter</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">WriterT</span><span> </span><a href="#local-6989586621679024469"><span class="hs-identifier hs-type">w</span></a><span> </span><a href="#local-6989586621679024471"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-264"></a><span>  </span><a name="local-8214565720323799332"><a href="Control.Monad.Random.Class.html#getSplit"><span class="hs-identifier">getSplit</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">lift</span><span> </span><a href="Control.Monad.Random.Class.html#getSplit"><span class="hs-identifier hs-var">getSplit</span></a><span>
</span><a name="line-265"></a><span>
</span><a name="line-266"></a><span class="hs-comment">------------------------------------------------------------</span><span>
</span><a name="line-267"></a><span class="hs-comment">-- MonadInterleave</span><span>
</span><a name="line-268"></a><span class="hs-comment">------------------------------------------------------------</span><span>
</span><a name="line-269"></a><span>
</span><a name="line-270"></a><span class="hs-comment">-- | The class 'MonadInterleave' proivides a convenient interface atop</span><span>
</span><a name="line-271"></a><span class="hs-comment">--   a 'split' operation on a random generator.</span><span>
</span><a name="line-272"></a><span class="hs-keyword">class</span><span> </span><a href="Control.Monad.Random.Class.html#MonadRandom"><span class="hs-identifier hs-type">MonadRandom</span></a><span> </span><a href="#local-6989586621679024433"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a name="MonadInterleave"><a href="Control.Monad.Random.Class.html#MonadInterleave"><span class="hs-identifier">MonadInterleave</span></a></a><span> </span><a name="local-6989586621679024433"><a href="#local-6989586621679024433"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-273"></a><span>
</span><a name="line-274"></a><span>  </span><span class="hs-comment">-- | If @x :: m a@ is a computation in some random monad, then</span><span>
</span><a name="line-275"></a><span>  </span><span class="hs-comment">--   @interleave x@ works by splitting the generator, running @x@</span><span>
</span><a name="line-276"></a><span>  </span><span class="hs-comment">--   using one half, and using the other half as the final generator</span><span>
</span><a name="line-277"></a><span>  </span><span class="hs-comment">--   state of @interleave x@ (replacing whatever the final generator</span><span>
</span><a name="line-278"></a><span>  </span><span class="hs-comment">--   state otherwise would have been).  This means that computation</span><span>
</span><a name="line-279"></a><span>  </span><span class="hs-comment">--   needing random values which comes after @interleave x@ does not</span><span>
</span><a name="line-280"></a><span>  </span><span class="hs-comment">--   necessarily depend on the computation of @x@.  For example:</span><span>
</span><a name="line-281"></a><span>  </span><span class="hs-comment">--</span><span>
</span><a name="line-282"></a><span>  </span><span class="hs-comment">--   &gt; &gt;&gt;&gt; evalRandIO $ snd &lt;$&gt; ((,) &lt;$&gt; undefined &lt;*&gt; getRandom)</span><span>
</span><a name="line-283"></a><span>  </span><span class="hs-comment">--   &gt; *** Exception: Prelude.undefined</span><span>
</span><a name="line-284"></a><span>  </span><span class="hs-comment">--   &gt; &gt;&gt;&gt; evalRandIO $ snd &lt;$&gt; ((,) &lt;$&gt; interleave undefined &lt;*&gt; getRandom)</span><span>
</span><a name="line-285"></a><span>  </span><span class="hs-comment">--   &gt; 6192322188769041625</span><span>
</span><a name="line-286"></a><span>  </span><span class="hs-comment">--</span><span>
</span><a name="line-287"></a><span>  </span><span class="hs-comment">--   This can be used, for example, to allow random computations to</span><span>
</span><a name="line-288"></a><span>  </span><span class="hs-comment">--   run in parallel, or to create lazy infinite structures of</span><span>
</span><a name="line-289"></a><span>  </span><span class="hs-comment">--   random values.  In the example below, the infinite tree</span><span>
</span><a name="line-290"></a><span>  </span><span class="hs-comment">--   @randTree@ cannot be evaluated lazily: even though it is cut</span><span>
</span><a name="line-291"></a><span>  </span><span class="hs-comment">--   off at two levels deep by @hew 2@, the random value in the</span><span>
</span><a name="line-292"></a><span>  </span><span class="hs-comment">--   right subtree still depends on generation of all the random</span><span>
</span><a name="line-293"></a><span>  </span><span class="hs-comment">--   values in the (infinite) left subtree, even though they are</span><span>
</span><a name="line-294"></a><span>  </span><span class="hs-comment">--   ultimately unneeded.  Inserting a call to @interleave@, as in</span><span>
</span><a name="line-295"></a><span>  </span><span class="hs-comment">--   @randTreeI@, solves the problem: the generator splits at each</span><span>
</span><a name="line-296"></a><span>  </span><span class="hs-comment">--   @Node@, so random values in the left and right subtrees are</span><span>
</span><a name="line-297"></a><span>  </span><span class="hs-comment">--   generated independently.</span><span>
</span><a name="line-298"></a><span>  </span><span class="hs-comment">--</span><span>
</span><a name="line-299"></a><span>  </span><span class="hs-comment">--   &gt; data Tree = Leaf | Node Int Tree Tree deriving Show</span><span>
</span><a name="line-300"></a><span>  </span><span class="hs-comment">--   &gt;</span><span>
</span><a name="line-301"></a><span>  </span><span class="hs-comment">--   &gt; hew :: Int -&gt; Tree -&gt; Tree</span><span>
</span><a name="line-302"></a><span>  </span><span class="hs-comment">--   &gt; hew 0 _    = Leaf</span><span>
</span><a name="line-303"></a><span>  </span><span class="hs-comment">--   &gt; hew _ Leaf = Leaf</span><span>
</span><a name="line-304"></a><span>  </span><span class="hs-comment">--   &gt; hew n (Node x l r) = Node x (hew (n-1) l) (hew (n-1) r)</span><span>
</span><a name="line-305"></a><span>  </span><span class="hs-comment">--   &gt;</span><span>
</span><a name="line-306"></a><span>  </span><span class="hs-comment">--   &gt; randTree :: Rand StdGen Tree</span><span>
</span><a name="line-307"></a><span>  </span><span class="hs-comment">--   &gt; randTree = Node &lt;$&gt; getRandom &lt;*&gt; randTree &lt;*&gt; randTree</span><span>
</span><a name="line-308"></a><span>  </span><span class="hs-comment">--   &gt;</span><span>
</span><a name="line-309"></a><span>  </span><span class="hs-comment">--   &gt; randTreeI :: Rand StdGen Tree</span><span>
</span><a name="line-310"></a><span>  </span><span class="hs-comment">--   &gt; randTreeI = interleave $ Node &lt;$&gt; getRandom &lt;*&gt; randTreeI &lt;*&gt; randTreeI</span><span>
</span><a name="line-311"></a><span>  </span><span class="hs-comment">--</span><span>
</span><a name="line-312"></a><span>  </span><span class="hs-comment">--   &gt; &gt;&gt;&gt; hew 2 &lt;$&gt; evalRandIO randTree</span><span>
</span><a name="line-313"></a><span>  </span><span class="hs-comment">--   &gt; Node 2168685089479838995 (Node (-1040559818952481847) Leaf Leaf) (Node ^CInterrupted.</span><span>
</span><a name="line-314"></a><span>  </span><span class="hs-comment">--   &gt; &gt;&gt;&gt; hew 2 &lt;$&gt; evalRandIO randTreeI</span><span>
</span><a name="line-315"></a><span>  </span><span class="hs-comment">--   &gt; Node 8243316398511136358 (Node 4139784028141790719 Leaf Leaf) (Node 4473998613878251948 Leaf Leaf)</span><span>
</span><a name="line-316"></a><span>  </span><span class="hs-identifier">interleave</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679024433"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679024434"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679024433"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679024434"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-317"></a><span>
</span><a name="line-318"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><a href="Control.Monad.Random.Class.html#MonadInterleave"><span class="hs-identifier hs-type">MonadInterleave</span></a><span> </span><a href="#local-6989586621679024467"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Control.Monad.Random.Class.html#MonadInterleave"><span class="hs-identifier hs-type">MonadInterleave</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">ContT</span><span> </span><a href="#local-6989586621679024468"><span class="hs-identifier hs-type">r</span></a><span> </span><a href="#local-6989586621679024467"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-319"></a><span>  </span><a name="local-8214565720323799330"><a href="Control.Monad.Random.Class.html#interleave"><span class="hs-identifier">interleave</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">mapContT</span><span> </span><a href="Control.Monad.Random.Class.html#interleave"><span class="hs-identifier hs-var">interleave</span></a><span>
</span><a name="line-320"></a><span>
</span><a name="line-321"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Error</span><span> </span><a href="#local-6989586621679024465"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">,</span><span> </span><a href="Control.Monad.Random.Class.html#MonadInterleave"><span class="hs-identifier hs-type">MonadInterleave</span></a><span> </span><a href="#local-6989586621679024466"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Control.Monad.Random.Class.html#MonadInterleave"><span class="hs-identifier hs-type">MonadInterleave</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">ErrorT</span><span> </span><a href="#local-6989586621679024465"><span class="hs-identifier hs-type">e</span></a><span> </span><a href="#local-6989586621679024466"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-322"></a><span>  </span><a name="local-8214565720323799330"><a href="Control.Monad.Random.Class.html#interleave"><span class="hs-identifier">interleave</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">mapErrorT</span><span> </span><a href="Control.Monad.Random.Class.html#interleave"><span class="hs-identifier hs-var">interleave</span></a><span>
</span><a name="line-323"></a><span>
</span><a name="line-324"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><a href="Control.Monad.Random.Class.html#MonadInterleave"><span class="hs-identifier hs-type">MonadInterleave</span></a><span> </span><a href="#local-6989586621679024463"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Control.Monad.Random.Class.html#MonadInterleave"><span class="hs-identifier hs-type">MonadInterleave</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">ExceptT</span><span> </span><a href="#local-6989586621679024464"><span class="hs-identifier hs-type">e</span></a><span> </span><a href="#local-6989586621679024463"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-325"></a><span>  </span><a name="local-8214565720323799330"><a href="Control.Monad.Random.Class.html#interleave"><span class="hs-identifier">interleave</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">mapExceptT</span><span> </span><a href="Control.Monad.Random.Class.html#interleave"><span class="hs-identifier hs-var">interleave</span></a><span>
</span><a name="line-326"></a><span>
</span><a name="line-327"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><a href="Control.Monad.Random.Class.html#MonadInterleave"><span class="hs-identifier hs-type">MonadInterleave</span></a><span> </span><a href="#local-6989586621679024462"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Control.Monad.Random.Class.html#MonadInterleave"><span class="hs-identifier hs-type">MonadInterleave</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">IdentityT</span><span> </span><a href="#local-6989586621679024462"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-328"></a><span>  </span><a name="local-8214565720323799330"><a href="Control.Monad.Random.Class.html#interleave"><span class="hs-identifier">interleave</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">mapIdentityT</span><span> </span><a href="Control.Monad.Random.Class.html#interleave"><span class="hs-identifier hs-var">interleave</span></a><span>
</span><a name="line-329"></a><span>
</span><a name="line-330"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><a href="Control.Monad.Random.Class.html#MonadInterleave"><span class="hs-identifier hs-type">MonadInterleave</span></a><span> </span><a href="#local-6989586621679024461"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Control.Monad.Random.Class.html#MonadInterleave"><span class="hs-identifier hs-type">MonadInterleave</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">ListT</span><span> </span><a href="#local-6989586621679024461"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-331"></a><span>  </span><a name="local-8214565720323799330"><a href="Control.Monad.Random.Class.html#interleave"><span class="hs-identifier">interleave</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">mapListT</span><span> </span><a href="Control.Monad.Random.Class.html#interleave"><span class="hs-identifier hs-var">interleave</span></a><span>
</span><a name="line-332"></a><span>
</span><a name="line-333"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><a href="Control.Monad.Random.Class.html#MonadInterleave"><span class="hs-identifier hs-type">MonadInterleave</span></a><span> </span><a href="#local-6989586621679024460"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Control.Monad.Random.Class.html#MonadInterleave"><span class="hs-identifier hs-type">MonadInterleave</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">MaybeT</span><span> </span><a href="#local-6989586621679024460"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-334"></a><span>  </span><a name="local-8214565720323799330"><a href="Control.Monad.Random.Class.html#interleave"><span class="hs-identifier">interleave</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">mapMaybeT</span><span> </span><a href="Control.Monad.Random.Class.html#interleave"><span class="hs-identifier hs-var">interleave</span></a><span>
</span><a name="line-335"></a><span>
</span><a name="line-336"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Monoid</span><span> </span><a href="#local-6989586621679024456"><span class="hs-identifier hs-type">w</span></a><span class="hs-special">,</span><span> </span><a href="Control.Monad.Random.Class.html#MonadInterleave"><span class="hs-identifier hs-type">MonadInterleave</span></a><span> </span><a href="#local-6989586621679024457"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Control.Monad.Random.Class.html#MonadInterleave"><span class="hs-identifier hs-type">MonadInterleave</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LazyRWS</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">RWST</span><span> </span><a href="#local-6989586621679024458"><span class="hs-identifier hs-type">r</span></a><span> </span><a href="#local-6989586621679024456"><span class="hs-identifier hs-type">w</span></a><span> </span><a href="#local-6989586621679024459"><span class="hs-identifier hs-type">s</span></a><span> </span><a href="#local-6989586621679024457"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-337"></a><span>  </span><a name="local-8214565720323799330"><a href="Control.Monad.Random.Class.html#interleave"><span class="hs-identifier">interleave</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">LazyRWS</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">mapRWST</span><span> </span><a href="Control.Monad.Random.Class.html#interleave"><span class="hs-identifier hs-var">interleave</span></a><span>
</span><a name="line-338"></a><span>
</span><a name="line-339"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Monoid</span><span> </span><a href="#local-6989586621679024452"><span class="hs-identifier hs-type">w</span></a><span class="hs-special">,</span><span> </span><a href="Control.Monad.Random.Class.html#MonadInterleave"><span class="hs-identifier hs-type">MonadInterleave</span></a><span> </span><a href="#local-6989586621679024453"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Control.Monad.Random.Class.html#MonadInterleave"><span class="hs-identifier hs-type">MonadInterleave</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">StrictRWS</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">RWST</span><span> </span><a href="#local-6989586621679024454"><span class="hs-identifier hs-type">r</span></a><span> </span><a href="#local-6989586621679024452"><span class="hs-identifier hs-type">w</span></a><span> </span><a href="#local-6989586621679024455"><span class="hs-identifier hs-type">s</span></a><span> </span><a href="#local-6989586621679024453"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-340"></a><span>  </span><a name="local-8214565720323799330"><a href="Control.Monad.Random.Class.html#interleave"><span class="hs-identifier">interleave</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">StrictRWS</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">mapRWST</span><span> </span><a href="Control.Monad.Random.Class.html#interleave"><span class="hs-identifier hs-var">interleave</span></a><span>
</span><a name="line-341"></a><span>
</span><a name="line-342"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><a href="Control.Monad.Random.Class.html#MonadInterleave"><span class="hs-identifier hs-type">MonadInterleave</span></a><span> </span><a href="#local-6989586621679024450"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Control.Monad.Random.Class.html#MonadInterleave"><span class="hs-identifier hs-type">MonadInterleave</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">ReaderT</span><span> </span><a href="#local-6989586621679024451"><span class="hs-identifier hs-type">r</span></a><span> </span><a href="#local-6989586621679024450"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-343"></a><span>  </span><a name="local-8214565720323799330"><a href="Control.Monad.Random.Class.html#interleave"><span class="hs-identifier">interleave</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">mapReaderT</span><span> </span><a href="Control.Monad.Random.Class.html#interleave"><span class="hs-identifier hs-var">interleave</span></a><span>
</span><a name="line-344"></a><span>
</span><a name="line-345"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><a href="Control.Monad.Random.Class.html#MonadInterleave"><span class="hs-identifier hs-type">MonadInterleave</span></a><span> </span><a href="#local-6989586621679024448"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Control.Monad.Random.Class.html#MonadInterleave"><span class="hs-identifier hs-type">MonadInterleave</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LazyState</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">StateT</span><span> </span><a href="#local-6989586621679024449"><span class="hs-identifier hs-type">s</span></a><span> </span><a href="#local-6989586621679024448"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-346"></a><span>  </span><a name="local-8214565720323799330"><a href="Control.Monad.Random.Class.html#interleave"><span class="hs-identifier">interleave</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">LazyState</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">mapStateT</span><span> </span><a href="Control.Monad.Random.Class.html#interleave"><span class="hs-identifier hs-var">interleave</span></a><span>
</span><a name="line-347"></a><span>
</span><a name="line-348"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><a href="Control.Monad.Random.Class.html#MonadInterleave"><span class="hs-identifier hs-type">MonadInterleave</span></a><span> </span><a href="#local-6989586621679024446"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Control.Monad.Random.Class.html#MonadInterleave"><span class="hs-identifier hs-type">MonadInterleave</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">StrictState</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">StateT</span><span> </span><a href="#local-6989586621679024447"><span class="hs-identifier hs-type">s</span></a><span> </span><a href="#local-6989586621679024446"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-349"></a><span>  </span><a name="local-8214565720323799330"><a href="Control.Monad.Random.Class.html#interleave"><span class="hs-identifier">interleave</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">StrictState</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">mapStateT</span><span> </span><a href="Control.Monad.Random.Class.html#interleave"><span class="hs-identifier hs-var">interleave</span></a><span>
</span><a name="line-350"></a><span>
</span><a name="line-351"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Monoid</span><span> </span><a href="#local-6989586621679024444"><span class="hs-identifier hs-type">w</span></a><span class="hs-special">,</span><span> </span><a href="Control.Monad.Random.Class.html#MonadInterleave"><span class="hs-identifier hs-type">MonadInterleave</span></a><span> </span><a href="#local-6989586621679024445"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Control.Monad.Random.Class.html#MonadInterleave"><span class="hs-identifier hs-type">MonadInterleave</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">LazyWriter</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">WriterT</span><span> </span><a href="#local-6989586621679024444"><span class="hs-identifier hs-type">w</span></a><span> </span><a href="#local-6989586621679024445"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-352"></a><span>  </span><a name="local-8214565720323799330"><a href="Control.Monad.Random.Class.html#interleave"><span class="hs-identifier">interleave</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">LazyWriter</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">mapWriterT</span><span> </span><a href="Control.Monad.Random.Class.html#interleave"><span class="hs-identifier hs-var">interleave</span></a><span>
</span><a name="line-353"></a><span>
</span><a name="line-354"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Monoid</span><span> </span><a href="#local-6989586621679024442"><span class="hs-identifier hs-type">w</span></a><span class="hs-special">,</span><span> </span><a href="Control.Monad.Random.Class.html#MonadInterleave"><span class="hs-identifier hs-type">MonadInterleave</span></a><span> </span><a href="#local-6989586621679024443"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Control.Monad.Random.Class.html#MonadInterleave"><span class="hs-identifier hs-type">MonadInterleave</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">StrictWriter</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">WriterT</span><span> </span><a href="#local-6989586621679024442"><span class="hs-identifier hs-type">w</span></a><span> </span><a href="#local-6989586621679024443"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-355"></a><span>  </span><a name="local-8214565720323799330"><a href="Control.Monad.Random.Class.html#interleave"><span class="hs-identifier">interleave</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">StrictWriter</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">mapWriterT</span><span> </span><a href="Control.Monad.Random.Class.html#interleave"><span class="hs-identifier hs-var">interleave</span></a><span>
</span><a name="line-356"></a><span>
</span><a name="line-357"></a><span class="hs-comment">------------------------------------------------------------</span><span>
</span><a name="line-358"></a><span class="hs-comment">-- Convenience samplers</span><span>
</span><a name="line-359"></a><span class="hs-comment">------------------------------------------------------------</span><span>
</span><a name="line-360"></a><span>
</span><a name="line-361"></a><span class="hs-comment">-- | Sample a random value from a weighted nonempty collection of</span><span>
</span><a name="line-362"></a><span class="hs-comment">--   elements.  Crashes with a call to @error@ if the collection is</span><span>
</span><a name="line-363"></a><span class="hs-comment">--   empty or the total weight is zero.</span><span>
</span><a name="line-364"></a><span class="hs-identifier">weighted</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">F</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">Foldable</span><span> </span><a href="#local-6989586621679026877"><span class="hs-identifier hs-type">t</span></a><span class="hs-special">,</span><span> </span><a href="Control.Monad.Random.Class.html#MonadRandom"><span class="hs-identifier hs-type">MonadRandom</span></a><span> </span><a href="#local-6989586621679026878"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679026877"><span class="hs-identifier hs-type">t</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679026879"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Rational</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679026878"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679026879"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-365"></a><a name="weighted"><a href="Control.Monad.Random.Class.html#weighted"><span class="hs-identifier">weighted</span></a></a><span> </span><a name="local-6989586621679026880"><a href="#local-6989586621679026880"><span class="hs-identifier">t</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-366"></a><span>  </span><a name="local-6989586621679026881"><a href="#local-6989586621679026881"><span class="hs-identifier">ma</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Control.Monad.Random.Class.html#weightedMay"><span class="hs-identifier hs-var">weightedMay</span></a><span> </span><a href="#local-6989586621679026880"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-367"></a><span>  </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679026881"><span class="hs-identifier hs-var">ma</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-368"></a><span>    </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-string">&quot;Control.Monad.Random.Class.weighted: empty collection, or total weight = 0&quot;</span><span>
</span><a name="line-369"></a><span>    </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679026896"><a href="#local-6989586621679026896"><span class="hs-identifier">a</span></a></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-6989586621679026896"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-370"></a><span>
</span><a name="line-371"></a><span class="hs-comment">-- | Sample a random value from a weighted collection of elements.</span><span>
</span><a name="line-372"></a><span class="hs-comment">--   Returns @Nothing@ if the collection is empty or the total weight is</span><span>
</span><a name="line-373"></a><span class="hs-comment">--   zero.</span><span>
</span><a name="line-374"></a><span class="hs-identifier">weightedMay</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">F</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">Foldable</span><span> </span><a href="#local-6989586621679026874"><span class="hs-identifier hs-type">t</span></a><span class="hs-special">,</span><span> </span><a href="Control.Monad.Random.Class.html#MonadRandom"><span class="hs-identifier hs-type">MonadRandom</span></a><span> </span><a href="#local-6989586621679026875"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679026874"><span class="hs-identifier hs-type">t</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679026876"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Rational</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679026875"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621679026876"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-375"></a><a name="weightedMay"><a href="Control.Monad.Random.Class.html#weightedMay"><span class="hs-identifier">weightedMay</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Control.Monad.Random.Class.html#fromListMay"><span class="hs-identifier hs-var">fromListMay</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">F</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">toList</span><span>
</span><a name="line-376"></a><span>
</span><a name="line-377"></a><span class="hs-comment">-- | Sample a random value from a weighted list.  The list must be</span><span>
</span><a name="line-378"></a><span class="hs-comment">--   non-empty and the total weight must be non-zero.</span><span>
</span><a name="line-379"></a><span class="hs-identifier">fromList</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="Control.Monad.Random.Class.html#MonadRandom"><span class="hs-identifier hs-type">MonadRandom</span></a><span> </span><a href="#local-6989586621679026872"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="#local-6989586621679026873"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Rational</span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679026872"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679026873"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-380"></a><a name="fromList"><a href="Control.Monad.Random.Class.html#fromList"><span class="hs-identifier">fromList</span></a></a><span> </span><a name="local-6989586621679026897"><a href="#local-6989586621679026897"><span class="hs-identifier">ws</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-381"></a><span>  </span><a name="local-6989586621679026898"><a href="#local-6989586621679026898"><span class="hs-identifier">ma</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Control.Monad.Random.Class.html#fromListMay"><span class="hs-identifier hs-var">fromListMay</span></a><span> </span><a href="#local-6989586621679026897"><span class="hs-identifier hs-var">ws</span></a><span>
</span><a name="line-382"></a><span>  </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679026898"><span class="hs-identifier hs-var">ma</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-383"></a><span>    </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-string">&quot;Control.Monad.Random.Class.fromList: empty list, or total weight = 0&quot;</span><span>
</span><a name="line-384"></a><span>    </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679026899"><a href="#local-6989586621679026899"><span class="hs-identifier">a</span></a></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-6989586621679026899"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-385"></a><span>
</span><a name="line-386"></a><span class="hs-comment">-- | Sample a random value from a weighted list.  Return @Nothing@ if</span><span>
</span><a name="line-387"></a><span class="hs-comment">--   the list is empty or the total weight is zero.</span><span>
</span><a name="line-388"></a><span class="hs-identifier">fromListMay</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="Control.Monad.Random.Class.html#MonadRandom"><span class="hs-identifier hs-type">MonadRandom</span></a><span> </span><a href="#local-6989586621679026370"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="#local-6989586621679026371"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Rational</span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679026370"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621679026371"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-389"></a><a name="fromListMay"><a href="Control.Monad.Random.Class.html#fromListMay"><span class="hs-identifier">fromListMay</span></a></a><span> </span><a name="local-6989586621679026900"><a href="#local-6989586621679026900"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-390"></a><span>  </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679026901"><a href="#local-6989586621679026901"><span class="hs-identifier">s</span></a></a><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fromRational</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">sum</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-identifier hs-var">snd</span><span> </span><a href="#local-6989586621679026900"><span class="hs-identifier hs-var">xs</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Double</span><span>
</span><a name="line-391"></a><span>      </span><a name="local-6989586621679026902"><a href="#local-6989586621679026902"><span class="hs-identifier">cums</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">scanl1</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><span class="hs-glyph">~</span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><a name="local-6989586621679027096"><a href="#local-6989586621679027096"><span class="hs-identifier">q</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">~</span><span class="hs-special">(</span><a name="local-6989586621679027097"><a href="#local-6989586621679027097"><span class="hs-identifier">y</span></a></a><span class="hs-special">,</span><a name="local-6989586621679027098"><a href="#local-6989586621679027098"><span class="hs-identifier">s'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679027097"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679027098"><span class="hs-identifier hs-var">s'</span></a><span class="hs-operator hs-var">+</span><a href="#local-6989586621679027096"><span class="hs-identifier hs-var">q</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679026900"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-392"></a><span>  </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679026901"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-393"></a><span>    </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span>
</span><a name="line-394"></a><span>    </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-395"></a><span>      </span><a name="local-6989586621679027179"><a href="#local-6989586621679027179"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">liftM</span><span> </span><span class="hs-identifier hs-var">toRational</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Control.Monad.Random.Class.html#getRandomR"><span class="hs-identifier hs-var">getRandomR</span></a><span> </span><span class="hs-special">(</span><span class="hs-number">0</span><span class="hs-special">,</span><span> </span><a href="#local-6989586621679026901"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span>
</span><a name="line-396"></a><span>      </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">fst</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">head</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">dropWhile</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-operator hs-var">&lt;</span><span> </span><a href="#local-6989586621679027179"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">snd</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679026902"><span class="hs-identifier hs-var">cums</span></a><span>
</span><a name="line-397"></a><span>
</span><a name="line-398"></a><span class="hs-comment">-- | Sample a value uniformly from a nonempty collection of elements.</span><span>
</span><a name="line-399"></a><span class="hs-identifier">uniform</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">F</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">Foldable</span><span> </span><a href="#local-6989586621679026367"><span class="hs-identifier hs-type">t</span></a><span class="hs-special">,</span><span> </span><a href="Control.Monad.Random.Class.html#MonadRandom"><span class="hs-identifier hs-type">MonadRandom</span></a><span> </span><a href="#local-6989586621679026368"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679026367"><span class="hs-identifier hs-type">t</span></a><span> </span><a href="#local-6989586621679026369"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679026368"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679026369"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-400"></a><a name="uniform"><a href="Control.Monad.Random.Class.html#uniform"><span class="hs-identifier">uniform</span></a></a><span> </span><a name="local-6989586621679031068"><a href="#local-6989586621679031068"><span class="hs-identifier">t</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-401"></a><span>  </span><a name="local-6989586621679031069"><a href="#local-6989586621679031069"><span class="hs-identifier">ma</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Control.Monad.Random.Class.html#uniformMay"><span class="hs-identifier hs-var">uniformMay</span></a><span> </span><a href="#local-6989586621679031068"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-402"></a><span>  </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679031069"><span class="hs-identifier hs-var">ma</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-403"></a><span>    </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-string">&quot;Control.Monad.Random.Class.uniform: empty collection&quot;</span><span>
</span><a name="line-404"></a><span>    </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679031070"><a href="#local-6989586621679031070"><span class="hs-identifier">a</span></a></a><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-6989586621679031070"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-405"></a><span>
</span><a name="line-406"></a><span class="hs-comment">-- | Sample a value uniformly from a collection of elements.  Return</span><span>
</span><a name="line-407"></a><span class="hs-comment">--   @Nothing@ if the collection is empty.</span><span>
</span><a name="line-408"></a><span class="hs-identifier">uniformMay</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">F</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">Foldable</span><span> </span><a href="#local-6989586621679026364"><span class="hs-identifier hs-type">t</span></a><span class="hs-special">,</span><span> </span><a href="Control.Monad.Random.Class.html#MonadRandom"><span class="hs-identifier hs-type">MonadRandom</span></a><span> </span><a href="#local-6989586621679026365"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679026364"><span class="hs-identifier hs-type">t</span></a><span> </span><a href="#local-6989586621679026366"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679026365"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Maybe</span><span> </span><a href="#local-6989586621679026366"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-409"></a><a name="uniformMay"><a href="Control.Monad.Random.Class.html#uniformMay"><span class="hs-identifier">uniformMay</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Control.Monad.Random.Class.html#fromListMay"><span class="hs-identifier hs-var">fromListMay</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">flip</span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="hs-number">1</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">F</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">toList</span><span>
</span><a name="line-410"></a></pre></body></html>