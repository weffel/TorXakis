<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">{-
TorXakis - Model Based Testing
Copyright (c) 2015-2017 TNO and Radboud University
See LICENSE at root directory of this repository.
-}</span><span>
</span><a name="line-6"></a><span class="hs-pragma">{-# LANGUAGE AllowAmbiguousTypes   #-}</span><span>
</span><a name="line-7"></a><span class="hs-pragma">{-# LANGUAGE DataKinds             #-}</span><span>
</span><a name="line-8"></a><span class="hs-pragma">{-# LANGUAGE ExplicitNamespaces    #-}</span><span>
</span><a name="line-9"></a><span class="hs-pragma">{-# LANGUAGE FlexibleContexts      #-}</span><span>
</span><a name="line-10"></a><span class="hs-pragma">{-# LANGUAGE FlexibleInstances     #-}</span><span>
</span><a name="line-11"></a><span class="hs-pragma">{-# LANGUAGE MultiParamTypeClasses #-}</span><span>
</span><a name="line-12"></a><span class="hs-pragma">{-# LANGUAGE OverloadedStrings     #-}</span><span>
</span><a name="line-13"></a><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables   #-}</span><span>
</span><a name="line-14"></a><span class="hs-pragma">{-# LANGUAGE TypeFamilies          #-}</span><span>
</span><a name="line-15"></a><span class="hs-pragma">{-# LANGUAGE TypeOperators         #-}</span><span>
</span><a name="line-16"></a><span class="hs-pragma">{-# LANGUAGE UndecidableInstances  #-}</span><span>
</span><a name="line-17"></a><span class="hs-pragma">{-# OPTIONS_GHC -Wno-redundant-constraints #-}</span><span>
</span><a name="line-18"></a><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><a name="line-19"></a><span class="hs-comment">-- |</span><span>
</span><a name="line-20"></a><span class="hs-comment">-- Module      :  TorXakis.Compiler.MapsTo</span><span>
</span><a name="line-21"></a><span class="hs-comment">-- Copyright   :  (c) TNO and Radboud University</span><span>
</span><a name="line-22"></a><span class="hs-comment">-- License     :  BSD3 (see the file license.txt)</span><span>
</span><a name="line-23"></a><span class="hs-comment">--</span><span>
</span><a name="line-24"></a><span class="hs-comment">-- Maintainer  :  damian.nadales@gmail.com (Embedded Systems Innovation by TNO)</span><span>
</span><a name="line-25"></a><span class="hs-comment">-- Stability   :  experimental</span><span>
</span><a name="line-26"></a><span class="hs-comment">-- Portability :  portable</span><span>
</span><a name="line-27"></a><span class="hs-comment">--</span><span>
</span><a name="line-28"></a><span class="hs-comment">-- Definition for the 'MapsTo' class, and associated operators.</span><span>
</span><a name="line-29"></a><span class="hs-comment">--</span><span>
</span><a name="line-30"></a><span class="hs-comment">-- A constraint of the form 'MapsTo k v mm' denotes that 'mm' contains a map</span><span>
</span><a name="line-31"></a><span class="hs-comment">-- from keys of type 'k' to values of type 't'.</span><span>
</span><a name="line-32"></a><span class="hs-comment">--------------------------------------------------------------------------------</span><span>
</span><a name="line-33"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">TorXakis</span><span class="hs-operator">.</span><span class="hs-identifier">Compiler</span><span class="hs-operator">.</span><span class="hs-identifier">MapsTo</span><span>
</span><a name="line-34"></a><span>    </span><span class="hs-special">(</span><span> </span><span class="hs-comment">-- * Predicates on maps</span><span>
</span><a name="line-35"></a><span>      </span><a href="TorXakis.Compiler.MapsTo.html#MapsTo"><span class="hs-identifier hs-type">MapsTo</span></a><span>
</span><a name="line-36"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="TorXakis.Compiler.MapsTo.html#In"><span class="hs-identifier hs-type">In</span></a><span>
</span><a name="line-37"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="TorXakis.Compiler.MapsTo.html#Contents"><span class="hs-identifier hs-type">Contents</span></a><span>
</span><a name="line-38"></a><span>      </span><span class="hs-comment">-- * Lookup</span><span>
</span><a name="line-39"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="TorXakis.Compiler.MapsTo.html#lookup"><span class="hs-identifier hs-var">lookup</span></a><span>
</span><a name="line-40"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="TorXakis.Compiler.MapsTo.html#lookupM"><span class="hs-identifier hs-var">lookupM</span></a><span>
</span><a name="line-41"></a><span>    </span><span class="hs-comment">-- * Extraction of maps, keys and values</span><span>
</span><a name="line-42"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="TorXakis.Compiler.MapsTo.html#keys"><span class="hs-identifier hs-var">keys</span></a><span>
</span><a name="line-43"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="TorXakis.Compiler.MapsTo.html#values"><span class="hs-identifier hs-var">values</span></a><span>
</span><a name="line-44"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="TorXakis.Compiler.MapsTo.html#innerMap"><span class="hs-identifier hs-var">innerMap</span></a><span>
</span><a name="line-45"></a><span>    </span><span class="hs-comment">-- * Combination of maps</span><span>
</span><a name="line-46"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="TorXakis.Compiler.MapsTo.html#%3A%26"><span class="hs-operator hs-type">:&amp;</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="TorXakis.Compiler.MapsTo.html#%3A%26"><span class="hs-operator hs-var">:&amp;</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-47"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="TorXakis.Compiler.MapsTo.html#%3C.%2B%3E"><span class="hs-operator hs-var">&lt;.+&gt;</span></a><span class="hs-special">)</span><span>
</span><a name="line-48"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="TorXakis.Compiler.MapsTo.html#%3C.%2B%2B%3E"><span class="hs-operator hs-var">&lt;.++&gt;</span></a><span class="hs-special">)</span><span>
</span><a name="line-49"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="TorXakis.Compiler.MapsTo.html#.%26"><span class="hs-operator hs-var">.&amp;</span></a><span class="hs-special">)</span><span>
</span><a name="line-50"></a><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="TorXakis.Compiler.MapsTo.html#.%26."><span class="hs-operator hs-var">.&amp;.</span></a><span class="hs-special">)</span><span>
</span><a name="line-51"></a><span>    </span><span class="hs-special">,</span><span> </span><a href="TorXakis.Compiler.MapsTo.html#replaceInnerMap"><span class="hs-identifier hs-var">replaceInnerMap</span></a><span>
</span><a name="line-52"></a><span>    </span><span class="hs-special">)</span><span>
</span><a name="line-53"></a><span class="hs-keyword">where</span><span>
</span><a name="line-54"></a><span>
</span><a name="line-55"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Control</span><span class="hs-operator">.</span><span class="hs-identifier">Monad</span><span class="hs-operator">.</span><span class="hs-identifier">Except</span><span>    </span><span class="hs-special">(</span><span class="hs-identifier hs-var">liftEither</span><span class="hs-special">)</span><span>
</span><a name="line-56"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Either</span><span class="hs-operator">.</span><span class="hs-identifier">Utils</span><span>       </span><span class="hs-special">(</span><span class="hs-identifier hs-var">maybeToEither</span><span class="hs-special">)</span><span>
</span><a name="line-57"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Map</span><span>                </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Map</span><span class="hs-special">)</span><span>
</span><a name="line-58"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Map</span><span>                </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">Map</span><span>
</span><a name="line-59"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Proxy</span><span>              </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Proxy</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Proxy</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-60"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Semigroup</span><span>          </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-operator hs-var">&lt;&gt;</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-61"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Text</span><span>               </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">T</span><span>
</span><a name="line-62"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Type</span><span class="hs-operator">.</span><span class="hs-identifier">Bool</span><span>          </span><span class="hs-special">(</span><span class="hs-keyword">type</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-type">||</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-63"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Typeable</span><span>           </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Typeable</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">typeOf</span><span class="hs-special">)</span><span>
</span><a name="line-64"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">GHC</span><span class="hs-operator">.</span><span class="hs-identifier">TypeLits</span><span>            </span><span class="hs-special">(</span><span class="hs-identifier hs-type">ErrorMessage</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-operator hs-var">:&lt;&gt;:</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">ShowType</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">Text</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-65"></a><span>                                          </span><span class="hs-identifier hs-type">TypeError</span><span class="hs-special">)</span><span>
</span><a name="line-66"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Prelude</span><span>                 </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">lookup</span><span class="hs-special">)</span><span>
</span><a name="line-67"></a><span>
</span><a name="line-68"></a><span class="hs-keyword">import</span><span>           </span><a href="TorXakis.Compiler.Data.html"><span class="hs-identifier">TorXakis</span><span class="hs-operator">.</span><span class="hs-identifier">Compiler</span><span class="hs-operator">.</span><span class="hs-identifier">Data</span></a><span>  </span><span class="hs-special">(</span><a href="TorXakis.Compiler.Data.html#CompilerM"><span class="hs-identifier hs-type">CompilerM</span></a><span class="hs-special">)</span><span>
</span><a name="line-69"></a><span class="hs-keyword">import</span><span>           </span><a href="TorXakis.Compiler.Error.html"><span class="hs-identifier">TorXakis</span><span class="hs-operator">.</span><span class="hs-identifier">Compiler</span><span class="hs-operator">.</span><span class="hs-identifier">Error</span></a><span> </span><span class="hs-special">(</span><a href="TorXakis.Compiler.Error.html#Entity"><span class="hs-identifier hs-type">Entity</span></a><span> </span><span class="hs-special">(</span><a href="TorXakis.Compiler.Error.html#Entity"><span class="hs-identifier hs-var">Entity</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="TorXakis.Compiler.Error.html#Error"><span class="hs-identifier hs-type">Error</span></a><span> </span><span class="hs-special">(</span><a href="TorXakis.Compiler.Error.html#Error"><span class="hs-identifier hs-var">Error</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-70"></a><span>                                          </span><a href="TorXakis.Compiler.Error.html#ErrorLoc"><span class="hs-identifier hs-type">ErrorLoc</span></a><span> </span><span class="hs-special">(</span><a href="TorXakis.Compiler.Error.html#NoErrorLoc"><span class="hs-identifier hs-var">NoErrorLoc</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-71"></a><span>                                          </span><a href="TorXakis.Compiler.Error.html#ErrorType"><span class="hs-identifier hs-type">ErrorType</span></a><span> </span><span class="hs-special">(</span><a href="TorXakis.Compiler.Error.html#Undefined"><span class="hs-identifier hs-var">Undefined</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="TorXakis.Compiler.Error.html#_errorLoc"><span class="hs-identifier hs-var">_errorLoc</span></a><span class="hs-special">,</span><span>
</span><a name="line-72"></a><span>                                          </span><a href="TorXakis.Compiler.Error.html#_errorMsg"><span class="hs-identifier hs-var">_errorMsg</span></a><span class="hs-special">,</span><span> </span><a href="TorXakis.Compiler.Error.html#_errorType"><span class="hs-identifier hs-var">_errorType</span></a><span class="hs-special">)</span><span>
</span><a name="line-73"></a><span>
</span><a name="line-74"></a><span class="hs-comment">-- | 'mm' maps keys of type 'k' onto values of type 'v'. The type 'mm' can be</span><span>
</span><a name="line-75"></a><span class="hs-comment">-- thought as a composite map, which contains multiple maps. See @:&amp;@ for more</span><span>
</span><a name="line-76"></a><span class="hs-comment">-- details.</span><span>
</span><a name="line-77"></a><span class="hs-keyword">class</span><span> </span><span class="hs-special">(</span><a href="TorXakis.Compiler.MapsTo.html#In"><span class="hs-identifier hs-type">In</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679081861"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679081862"><span class="hs-identifier hs-type">v</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="TorXakis.Compiler.MapsTo.html#Contents"><span class="hs-identifier hs-type">Contents</span></a><span> </span><a href="#local-6989586621679081863"><span class="hs-identifier hs-type">mm</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">~</span><span> </span><span class="hs-special">'</span><span class="hs-identifier hs-type">True</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a name="MapsTo"><a href="TorXakis.Compiler.MapsTo.html#MapsTo"><span class="hs-identifier">MapsTo</span></a></a><span> </span><a name="local-6989586621679081861"><a href="#local-6989586621679081861"><span class="hs-identifier">k</span></a></a><span> </span><a name="local-6989586621679081862"><a href="#local-6989586621679081862"><span class="hs-identifier">v</span></a></a><span> </span><a name="local-6989586621679081863"><a href="#local-6989586621679081863"><span class="hs-identifier">mm</span></a></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-78"></a><span>    </span><span class="hs-comment">-- | Lookup a key in the map.</span><span>
</span><a name="line-79"></a><span>    </span><span class="hs-identifier">lookup</span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679081861"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><a href="#local-6989586621679081861"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Typeable</span><span> </span><a href="#local-6989586621679081861"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Typeable</span><span> </span><a href="#local-6989586621679081862"><span class="hs-identifier hs-type">v</span></a><span class="hs-special">)</span><span>
</span><a name="line-80"></a><span>            </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679081861"><span class="hs-identifier hs-type">k</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679081863"><span class="hs-identifier hs-type">mm</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Either</span><span> </span><a href="TorXakis.Compiler.Error.html#Error"><span class="hs-identifier hs-type">Error</span></a><span> </span><a href="#local-6989586621679081862"><span class="hs-identifier hs-type">v</span></a><span>
</span><a name="line-81"></a><span>    </span><span class="hs-comment">-- | Monadic version of @lookup@.</span><span>
</span><a name="line-82"></a><span>    </span><span class="hs-identifier">lookupM</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679081861"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><a href="#local-6989586621679081861"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Typeable</span><span> </span><a href="#local-6989586621679081861"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Typeable</span><span> </span><a href="#local-6989586621679081862"><span class="hs-identifier hs-type">v</span></a><span class="hs-special">)</span><span>
</span><a name="line-83"></a><span>            </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679081861"><span class="hs-identifier hs-type">k</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679081863"><span class="hs-identifier hs-type">mm</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="TorXakis.Compiler.Data.html#CompilerM"><span class="hs-identifier hs-type">CompilerM</span></a><span> </span><a href="#local-6989586621679081862"><span class="hs-identifier hs-type">v</span></a><span>
</span><a name="line-84"></a><span>    </span><a name="local-8214565720323855219"><a href="TorXakis.Compiler.MapsTo.html#lookupM"><span class="hs-identifier">lookupM</span></a></a><span> </span><a name="local-6989586621679081864"><a href="#local-6989586621679081864"><span class="hs-identifier">k</span></a></a><span> </span><a name="local-6989586621679081865"><a href="#local-6989586621679081865"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">liftEither</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="TorXakis.Compiler.MapsTo.html#lookup"><span class="hs-identifier hs-var">lookup</span></a><span> </span><a href="#local-6989586621679081864"><span class="hs-identifier hs-var">k</span></a><span> </span><a href="#local-6989586621679081865"><span class="hs-identifier hs-var">m</span></a><span>
</span><a name="line-85"></a><span>    </span><span class="hs-comment">-- | Get the inner map.</span><span>
</span><a name="line-86"></a><span>    </span><span class="hs-identifier">innerMap</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679081863"><span class="hs-identifier hs-type">mm</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Map</span><span> </span><a href="#local-6989586621679081861"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-6989586621679081862"><span class="hs-identifier hs-type">v</span></a><span>
</span><a name="line-87"></a><span>    </span><span class="hs-comment">-- | Add a map. The addition is biased towards the new map. If the two maps</span><span>
</span><a name="line-88"></a><span>    </span><span class="hs-comment">-- have the same key, then the value of the right map is discarded, and the</span><span>
</span><a name="line-89"></a><span>    </span><span class="hs-comment">-- value of the left map is kept.</span><span>
</span><a name="line-90"></a><span>    </span><span class="hs-special">(</span><span class="hs-operator">&lt;.+&gt;</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679081861"><span class="hs-identifier hs-type">k</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Map</span><span> </span><a href="#local-6989586621679081861"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-6989586621679081862"><span class="hs-identifier hs-type">v</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679081863"><span class="hs-identifier hs-type">mm</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679081863"><span class="hs-identifier hs-type">mm</span></a><span>
</span><a name="line-91"></a><span>    </span><span class="hs-keyword">infixl</span><span> </span><span class="hs-number">4</span><span> </span><span class="hs-operator">&lt;.+&gt;</span><span>
</span><a name="line-92"></a><span>    </span><span class="hs-comment">-- | Replace the inner map with the given one.</span><span>
</span><a name="line-93"></a><span>    </span><span class="hs-identifier">replaceInnerMap</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679081863"><span class="hs-identifier hs-type">mm</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Map</span><span> </span><a href="#local-6989586621679081861"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-6989586621679081862"><span class="hs-identifier hs-type">v</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679081863"><span class="hs-identifier hs-type">mm</span></a><span>
</span><a name="line-94"></a><span>
</span><a name="line-95"></a><span class="hs-comment">-- | Get all the keys of type 'k' that are associated to values of type 'v' in</span><span>
</span><a name="line-96"></a><span class="hs-comment">-- the given map.</span><span>
</span><a name="line-97"></a><span class="hs-identifier">keys</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><a name="local-6989586621679081943"><a href="#local-6989586621679081943"><span class="hs-identifier">k</span></a></a><span> </span><a name="local-6989586621679081944"><a href="#local-6989586621679081944"><span class="hs-identifier">v</span></a></a><span> </span><a name="local-6989586621679081945"><a href="#local-6989586621679081945"><span class="hs-identifier">mm</span></a></a><span> </span><span class="hs-operator">.</span><span> </span><a href="TorXakis.Compiler.MapsTo.html#MapsTo"><span class="hs-identifier hs-type">MapsTo</span></a><span> </span><a href="#local-6989586621679081943"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-6989586621679081944"><span class="hs-identifier hs-type">v</span></a><span> </span><a href="#local-6989586621679081945"><span class="hs-identifier hs-type">mm</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679081945"><span class="hs-identifier hs-type">mm</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679081943"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">]</span><span>
</span><a name="line-98"></a><a name="keys"><a href="TorXakis.Compiler.MapsTo.html#keys"><span class="hs-identifier">keys</span></a></a><span> </span><a name="local-6989586621679081946"><a href="#local-6989586621679081946"><span class="hs-identifier">mm</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Map</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">keys</span><span> </span><a href="#local-6989586621679081947"><span class="hs-identifier hs-var">im</span></a><span>
</span><a name="line-99"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-100"></a><span>      </span><span class="hs-identifier">im</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Map</span><span> </span><a href="#local-6989586621679081943"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-6989586621679081944"><span class="hs-identifier hs-type">v</span></a><span>
</span><a name="line-101"></a><span>      </span><a name="local-6989586621679081947"><a href="#local-6989586621679081947"><span class="hs-identifier">im</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TorXakis.Compiler.MapsTo.html#innerMap"><span class="hs-identifier hs-var">innerMap</span></a><span> </span><a href="#local-6989586621679081946"><span class="hs-identifier hs-var">mm</span></a><span>
</span><a name="line-102"></a><span>
</span><a name="line-103"></a><span class="hs-comment">-- | Get all the values of type 'v' that are associated to keys of type 'k' in</span><span>
</span><a name="line-104"></a><span class="hs-comment">-- the given map.</span><span>
</span><a name="line-105"></a><span class="hs-identifier">values</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><a name="local-6989586621679081940"><a href="#local-6989586621679081940"><span class="hs-identifier">k</span></a></a><span> </span><a name="local-6989586621679081941"><a href="#local-6989586621679081941"><span class="hs-identifier">v</span></a></a><span> </span><a name="local-6989586621679081942"><a href="#local-6989586621679081942"><span class="hs-identifier">mm</span></a></a><span> </span><span class="hs-operator">.</span><span> </span><a href="TorXakis.Compiler.MapsTo.html#MapsTo"><span class="hs-identifier hs-type">MapsTo</span></a><span> </span><a href="#local-6989586621679081940"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-6989586621679081941"><span class="hs-identifier hs-type">v</span></a><span> </span><a href="#local-6989586621679081942"><span class="hs-identifier hs-type">mm</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679081942"><span class="hs-identifier hs-type">mm</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679081941"><span class="hs-identifier hs-type">v</span></a><span class="hs-special">]</span><span>
</span><a name="line-106"></a><a name="values"><a href="TorXakis.Compiler.MapsTo.html#values"><span class="hs-identifier">values</span></a></a><span> </span><a name="local-6989586621679081948"><a href="#local-6989586621679081948"><span class="hs-identifier">mm</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Map</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">elems</span><span> </span><a href="#local-6989586621679081949"><span class="hs-identifier hs-var">im</span></a><span>
</span><a name="line-107"></a><span>    </span><span class="hs-keyword">where</span><span>
</span><a name="line-108"></a><span>      </span><span class="hs-identifier">im</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Map</span><span> </span><a href="#local-6989586621679081940"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-6989586621679081941"><span class="hs-identifier hs-type">v</span></a><span>
</span><a name="line-109"></a><span>      </span><a name="local-6989586621679081949"><a href="#local-6989586621679081949"><span class="hs-identifier">im</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TorXakis.Compiler.MapsTo.html#innerMap"><span class="hs-identifier hs-var">innerMap</span></a><span> </span><a href="#local-6989586621679081948"><span class="hs-identifier hs-var">mm</span></a><span>
</span><a name="line-110"></a><span>
</span><a name="line-111"></a><span class="hs-comment">-- | Compute when a type is in a tree.</span><span>
</span><a name="line-112"></a><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span> </span><a name="In"><a href="TorXakis.Compiler.MapsTo.html#In"><span class="hs-identifier">In</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679081854"><a href="#local-6989586621679081854"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-operator hs-type">*</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679081855"><a href="#local-6989586621679081855"><span class="hs-identifier">ys</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="TorXakis.Compiler.MapsTo.html#Tree"><span class="hs-identifier hs-type">Tree</span></a><span> </span><span class="hs-operator hs-type">*</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Bool</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-113"></a><span>    </span><span class="hs-identifier">In</span><span> </span><a href="#local-6989586621679081856"><span class="hs-identifier hs-type">x</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><a href="TorXakis.Compiler.MapsTo.html#Leaf"><span class="hs-identifier hs-type">Leaf</span></a><span> </span><a href="#local-6989586621679081857"><span class="hs-identifier hs-type">y</span></a><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679081856"><span class="hs-identifier hs-type">x</span></a><span> </span><span class="hs-operator">==</span><span> </span><a href="#local-6989586621679081857"><span class="hs-identifier hs-type">y</span></a><span>
</span><a name="line-114"></a><span>    </span><span class="hs-identifier">In</span><span> </span><a href="#local-6989586621679081858"><span class="hs-identifier hs-type">x</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">'</span><a href="TorXakis.Compiler.MapsTo.html#Node"><span class="hs-identifier hs-type">Node</span></a><span> </span><a href="#local-6989586621679081859"><span class="hs-identifier hs-type">l</span></a><span> </span><a href="#local-6989586621679081860"><span class="hs-identifier hs-type">r</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TorXakis.Compiler.MapsTo.html#In"><span class="hs-identifier hs-type">In</span></a><span> </span><a href="#local-6989586621679081858"><span class="hs-identifier hs-type">x</span></a><span> </span><a href="#local-6989586621679081859"><span class="hs-identifier hs-type">l</span></a><span> </span><span class="hs-operator">||</span><span> </span><a href="TorXakis.Compiler.MapsTo.html#In"><span class="hs-identifier hs-type">In</span></a><span> </span><a href="#local-6989586621679081858"><span class="hs-identifier hs-type">x</span></a><span> </span><a href="#local-6989586621679081860"><span class="hs-identifier hs-type">r</span></a><span>
</span><a name="line-115"></a><span>
</span><a name="line-116"></a><span class="hs-comment">-- | Compute when two types are the same.</span><span>
</span><a name="line-117"></a><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span> </span><a name="local-6989586621679081849"><a href="#local-6989586621679081849"><span class="hs-identifier">y</span></a></a><span> </span><a name="%3D%3D"><a href="TorXakis.Compiler.MapsTo.html#%3D%3D"><span class="hs-operator">==</span></a></a><span> </span><a name="local-6989586621679081850"><a href="#local-6989586621679081850"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Bool</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-118"></a><span>    </span><a href="#local-6989586621679081851"><span class="hs-identifier hs-type">x</span></a><span> </span><span class="hs-operator">==</span><span> </span><a href="#local-6989586621679081851"><span class="hs-identifier hs-type">x</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">'</span><span class="hs-identifier hs-type">True</span><span>
</span><a name="line-119"></a><span>    </span><a href="#local-6989586621679081852"><span class="hs-identifier hs-type">x</span></a><span> </span><span class="hs-operator">==</span><span> </span><a href="#local-6989586621679081853"><span class="hs-identifier hs-type">y</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">'</span><span class="hs-identifier hs-type">False</span><span>
</span><a name="line-120"></a><span>
</span><a name="line-121"></a><span class="hs-comment">-- | Type family that represents the contents of a map.</span><span>
</span><a name="line-122"></a><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">family</span><span> </span><a name="Contents"><a href="TorXakis.Compiler.MapsTo.html#Contents"><span class="hs-identifier">Contents</span></a></a><span> </span><a name="local-6989586621679081848"><a href="#local-6989586621679081848"><span class="hs-identifier">mm</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="TorXakis.Compiler.MapsTo.html#Tree"><span class="hs-identifier hs-type">Tree</span></a><span> </span><span class="hs-operator hs-type">*</span><span>
</span><a name="line-123"></a><span>
</span><a name="line-124"></a><span class="hs-comment">-- | Search tree for types. This type would contain the key-value pairs found</span><span>
</span><a name="line-125"></a><span class="hs-comment">-- in a composite map.</span><span>
</span><a name="line-126"></a><span class="hs-keyword">data</span><span> </span><a name="Tree"><a href="TorXakis.Compiler.MapsTo.html#Tree"><span class="hs-identifier">Tree</span></a></a><span> </span><a name="local-6989586621679081847"><a href="#local-6989586621679081847"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="Leaf"><a href="TorXakis.Compiler.MapsTo.html#Leaf"><span class="hs-identifier">Leaf</span></a></a><span> </span><a href="#local-6989586621679081847"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="Node"><a href="TorXakis.Compiler.MapsTo.html#Node"><span class="hs-identifier">Node</span></a></a><span> </span><span class="hs-special">(</span><a href="TorXakis.Compiler.MapsTo.html#Tree"><span class="hs-identifier hs-type">Tree</span></a><span> </span><a href="#local-6989586621679081847"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="TorXakis.Compiler.MapsTo.html#Tree"><span class="hs-identifier hs-type">Tree</span></a><span> </span><a href="#local-6989586621679081847"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-127"></a><span>
</span><a name="line-128"></a><span class="hs-comment">-- | A map from 'k' to 'v' is defined to contain a 'k' 'v' association.</span><span>
</span><a name="line-129"></a><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">instance</span><span> </span><a href="TorXakis.Compiler.MapsTo.html#Contents"><span class="hs-identifier hs-type">Contents</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Map</span><span> </span><a href="#local-6989586621679081928"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-6989586621679081929"><span class="hs-identifier hs-type">v</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">'</span><a href="TorXakis.Compiler.MapsTo.html#Leaf"><span class="hs-identifier hs-type">Leaf</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679081928"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679081929"><span class="hs-identifier hs-type">v</span></a><span class="hs-special">)</span><span>
</span><a name="line-130"></a><span>
</span><a name="line-131"></a><span class="hs-comment">-- | A list of any type is not a map.</span><span>
</span><a name="line-132"></a><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">instance</span><span> </span><a href="TorXakis.Compiler.MapsTo.html#Contents"><span class="hs-identifier hs-type">Contents</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679081927"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">'</span><a href="TorXakis.Compiler.MapsTo.html#Leaf"><span class="hs-identifier hs-type">Leaf</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-133"></a><span>
</span><a name="line-134"></a><span class="hs-comment">-- | Canonical instance: a map from 'k' to 'v' maps 'k' to 'v'.</span><span>
</span><a name="line-135"></a><span class="hs-keyword">instance</span><span> </span><a href="TorXakis.Compiler.MapsTo.html#MapsTo"><span class="hs-identifier hs-type">MapsTo</span></a><span> </span><a href="#local-6989586621679081922"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-6989586621679081923"><span class="hs-identifier hs-type">v</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Map</span><span> </span><a href="#local-6989586621679081922"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-6989586621679081923"><span class="hs-identifier hs-type">v</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-136"></a><span>    </span><a name="local-8214565720323855218"><a href="TorXakis.Compiler.MapsTo.html#lookup"><span class="hs-identifier">lookup</span></a></a><span> </span><a name="local-6989586621679081924"><a href="#local-6989586621679081924"><span class="hs-identifier">k</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">maybeToEither</span><span> </span><a href="#local-6989586621679081925"><span class="hs-identifier hs-var">err</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">Map</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">lookup</span><span> </span><a href="#local-6989586621679081924"><span class="hs-identifier hs-var">k</span></a><span>
</span><a name="line-137"></a><span>        </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679081925"><a href="#local-6989586621679081925"><span class="hs-identifier">err</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TorXakis.Compiler.Error.html#Error"><span class="hs-identifier hs-var">Error</span></a><span>
</span><a name="line-138"></a><span>                  </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">_errorType</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TorXakis.Compiler.Error.html#Undefined"><span class="hs-identifier hs-var">Undefined</span></a><span> </span><a href="TorXakis.Compiler.Error.html#Entity"><span class="hs-identifier hs-var">Entity</span></a><span>
</span><a name="line-139"></a><span>                  </span><span class="hs-comment">-- No error location can be given. However the error location</span><span>
</span><a name="line-140"></a><span>                  </span><span class="hs-comment">-- could be overwritten by the caller of 'lookup'.</span><span>
</span><a name="line-141"></a><span>                  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_errorLoc</span><span>  </span><span class="hs-glyph">=</span><span> </span><a href="TorXakis.Compiler.Error.html#NoErrorLoc"><span class="hs-identifier hs-var">NoErrorLoc</span></a><span>
</span><a name="line-142"></a><span>                  </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">_errorMsg</span><span>  </span><span class="hs-glyph">=</span><span>  </span><span class="hs-string">&quot;Could not find key &quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-identifier hs-var">T</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">pack</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679081924"><span class="hs-identifier hs-var">k</span></a><span class="hs-special">)</span><span>
</span><a name="line-143"></a><span>                               </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot; of type &quot;</span><span> </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">T</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">pack</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">typeOf</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679081924"><span class="hs-identifier hs-var">k</span></a><span class="hs-special">)</span><span>
</span><a name="line-144"></a><span>                               </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-string">&quot; when looking for a value of type &quot;</span><span>
</span><a name="line-145"></a><span>                               </span><span class="hs-operator hs-var">&lt;&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">T</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">pack</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">typeOf</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Proxy</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Proxy</span><span> </span><a href="#local-6989586621679081923"><span class="hs-identifier hs-type">v</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-146"></a><span>                  </span><span class="hs-special">}</span><span>
</span><a name="line-147"></a><span>    </span><a name="local-8214565720323855220"><a href="TorXakis.Compiler.MapsTo.html#innerMap"><span class="hs-identifier">innerMap</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">id</span><span>
</span><a name="line-148"></a><span>    </span><span class="hs-comment">-- Note that here we're using the monoidal implementation of &lt;&gt; for maps,</span><span>
</span><a name="line-149"></a><span>    </span><span class="hs-comment">-- which overwrites the keys of 'm1'.</span><span>
</span><a name="line-150"></a><span>    </span><span class="hs-special">(</span><a name="local-8214565720323855221"><a href="TorXakis.Compiler.MapsTo.html#%3C.%2B%3E"><span class="hs-operator">&lt;.+&gt;</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">&lt;&gt;</span><span class="hs-special">)</span><span>
</span><a name="line-151"></a><span>    </span><a name="local-8214565720323855222"><a href="TorXakis.Compiler.MapsTo.html#replaceInnerMap"><span class="hs-identifier">replaceInnerMap</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679081926"><a href="#local-6989586621679081926"><span class="hs-identifier">new</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679081926"><span class="hs-identifier hs-var">new</span></a><span>
</span><a name="line-152"></a><span>
</span><a name="line-153"></a><span class="hs-comment">-- | Combinator for maps.</span><span>
</span><a name="line-154"></a><span class="hs-keyword">data</span><span> </span><a name="local-6989586621679081845"><a href="#local-6989586621679081845"><span class="hs-identifier">a</span></a></a><span> </span><a name="%3A%26"><a href="TorXakis.Compiler.MapsTo.html#%3A%26"><span class="hs-operator">:&amp;</span></a></a><span> </span><a name="local-6989586621679081846"><a href="#local-6989586621679081846"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679081845"><span class="hs-identifier hs-type">a</span></a><span> </span><a name="%3A%26"><a href="TorXakis.Compiler.MapsTo.html#%3A%26"><span class="hs-operator">:&amp;</span></a></a><span> </span><a href="#local-6989586621679081846"><span class="hs-identifier hs-type">b</span></a><span>
</span><a name="line-155"></a><span class="hs-keyword">infixr</span><span> </span><span class="hs-number">5</span><span> </span><span class="hs-operator">:&amp;</span><span>
</span><a name="line-156"></a><span>
</span><a name="line-157"></a><span class="hs-comment">-- | Combine lists of key values pairs into a pair of maps.</span><span>
</span><a name="line-158"></a><span class="hs-special">(</span><span class="hs-operator">.&amp;.</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679081936"><span class="hs-identifier hs-type">k0</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679081937"><span class="hs-identifier hs-type">k1</span></a><span class="hs-special">)</span><span>
</span><a name="line-159"></a><span>      </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="#local-6989586621679081936"><span class="hs-identifier hs-type">k0</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679081938"><span class="hs-identifier hs-type">v0</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="#local-6989586621679081937"><span class="hs-identifier hs-type">k1</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679081939"><span class="hs-identifier hs-type">v1</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Map</span><span> </span><a href="#local-6989586621679081936"><span class="hs-identifier hs-type">k0</span></a><span> </span><a href="#local-6989586621679081938"><span class="hs-identifier hs-type">v0</span></a><span> </span><span class="hs-operator">:&amp;</span><span> </span><span class="hs-identifier hs-type">Map</span><span> </span><a href="#local-6989586621679081937"><span class="hs-identifier hs-type">k1</span></a><span> </span><a href="#local-6989586621679081939"><span class="hs-identifier hs-type">v1</span></a><span>
</span><a name="line-160"></a><a name="local-6989586621679081950"><a href="#local-6989586621679081950"><span class="hs-identifier">kv0</span></a></a><span> </span><a name=".%26."><a href="TorXakis.Compiler.MapsTo.html#.%26."><span class="hs-operator">.&amp;.</span></a></a><span> </span><a name="local-6989586621679081951"><a href="#local-6989586621679081951"><span class="hs-identifier">kv1</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Map</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">fromList</span><span> </span><a href="#local-6989586621679081950"><span class="hs-identifier hs-var">kv0</span></a><span> </span><a href="TorXakis.Compiler.MapsTo.html#%3A%26"><span class="hs-operator hs-var">:&amp;</span></a><span> </span><span class="hs-identifier hs-var">Map</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">fromList</span><span> </span><a href="#local-6989586621679081951"><span class="hs-identifier hs-var">kv1</span></a><span>
</span><a name="line-161"></a><span class="hs-keyword">infixr</span><span> </span><span class="hs-number">6</span><span> </span><span class="hs-operator">.&amp;.</span><span>
</span><a name="line-162"></a><span>
</span><a name="line-163"></a><span class="hs-comment">-- | Combine a list of key values pairs with an existing map.</span><span>
</span><a name="line-164"></a><span class="hs-special">(</span><span class="hs-operator">.&amp;</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679081933"><span class="hs-identifier hs-type">k0</span></a><span class="hs-special">)</span><span>
</span><a name="line-165"></a><span>      </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="#local-6989586621679081933"><span class="hs-identifier hs-type">k0</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679081934"><span class="hs-identifier hs-type">v0</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679081935"><span class="hs-identifier hs-type">mm</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Map</span><span> </span><a href="#local-6989586621679081933"><span class="hs-identifier hs-type">k0</span></a><span> </span><a href="#local-6989586621679081934"><span class="hs-identifier hs-type">v0</span></a><span> </span><span class="hs-operator">:&amp;</span><span> </span><a href="#local-6989586621679081935"><span class="hs-identifier hs-type">mm</span></a><span>
</span><a name="line-166"></a><a name="local-6989586621679081952"><a href="#local-6989586621679081952"><span class="hs-identifier">kv0</span></a></a><span> </span><a name=".%26"><a href="TorXakis.Compiler.MapsTo.html#.%26"><span class="hs-operator">.&amp;</span></a></a><span> </span><a name="local-6989586621679081953"><a href="#local-6989586621679081953"><span class="hs-identifier">mm</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Map</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">fromList</span><span> </span><a href="#local-6989586621679081952"><span class="hs-identifier hs-var">kv0</span></a><span> </span><a href="TorXakis.Compiler.MapsTo.html#%3A%26"><span class="hs-operator hs-var">:&amp;</span></a><span> </span><a href="#local-6989586621679081953"><span class="hs-identifier hs-var">mm</span></a><span>
</span><a name="line-167"></a><span class="hs-keyword">infixr</span><span> </span><span class="hs-number">6</span><span> </span><span class="hs-operator">.&amp;</span><span>
</span><a name="line-168"></a><span>
</span><a name="line-169"></a><span class="hs-comment">-- | Like @&lt;.+&gt;@ but its left argument is a list instead of a map. Useful when</span><span>
</span><a name="line-170"></a><span class="hs-comment">-- we want to add a list to a composite map.</span><span>
</span><a name="line-171"></a><span class="hs-special">(</span><span class="hs-operator">&lt;.++&gt;</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span class="hs-special">(</span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679081930"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">,</span><span> </span><a href="TorXakis.Compiler.MapsTo.html#MapsTo"><span class="hs-identifier hs-type">MapsTo</span></a><span> </span><a href="#local-6989586621679081930"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-6989586621679081931"><span class="hs-identifier hs-type">v</span></a><span> </span><a href="#local-6989586621679081932"><span class="hs-identifier hs-type">mm</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="#local-6989586621679081930"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679081931"><span class="hs-identifier hs-type">v</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679081932"><span class="hs-identifier hs-type">mm</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679081932"><span class="hs-identifier hs-type">mm</span></a><span>
</span><a name="line-172"></a><a name="local-6989586621679081954"><a href="#local-6989586621679081954"><span class="hs-identifier">xs</span></a></a><span> </span><a name="%3C.%2B%2B%3E"><a href="TorXakis.Compiler.MapsTo.html#%3C.%2B%2B%3E"><span class="hs-operator">&lt;.++&gt;</span></a></a><span> </span><a name="local-6989586621679081955"><a href="#local-6989586621679081955"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Map</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">fromList</span><span> </span><a href="#local-6989586621679081954"><span class="hs-identifier hs-var">xs</span></a><span> </span><a href="TorXakis.Compiler.MapsTo.html#%3C.%2B%3E"><span class="hs-operator hs-var">&lt;.+&gt;</span></a><span> </span><a href="#local-6989586621679081955"><span class="hs-identifier hs-var">m</span></a><span>
</span><a name="line-173"></a><span class="hs-keyword">infixr</span><span> </span><span class="hs-number">6</span><span> </span><span class="hs-operator">&lt;.++&gt;</span><span>
</span><a name="line-174"></a><span>
</span><a name="line-175"></a><span class="hs-comment">-- | The composite structure contains the contents of 'a' and 'b'.</span><span>
</span><a name="line-176"></a><span class="hs-keyword">type</span><span> </span><span class="hs-keyword">instance</span><span> </span><a href="TorXakis.Compiler.MapsTo.html#Contents"><span class="hs-identifier hs-type">Contents</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679081920"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-operator">:&amp;</span><span> </span><a href="#local-6989586621679081921"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">'</span><a href="TorXakis.Compiler.MapsTo.html#Node"><span class="hs-identifier hs-type">Node</span></a><span> </span><span class="hs-special">(</span><a href="TorXakis.Compiler.MapsTo.html#Contents"><span class="hs-identifier hs-type">Contents</span></a><span> </span><a href="#local-6989586621679081920"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="TorXakis.Compiler.MapsTo.html#Contents"><span class="hs-identifier hs-type">Contents</span></a><span> </span><a href="#local-6989586621679081921"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-177"></a><span>
</span><a name="line-178"></a><span class="hs-comment">-- | The pair 'm0 :&amp; m1' maps values of type 'k' onto values of type 'v'</span><span>
</span><a name="line-179"></a><span class="hs-keyword">class</span><span> </span><span class="hs-special">(</span><span> </span><a href="TorXakis.Compiler.MapsTo.html#In"><span class="hs-identifier hs-type">In</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679080317"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679080318"><span class="hs-identifier hs-type">v</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="TorXakis.Compiler.MapsTo.html#Contents"><span class="hs-identifier hs-type">Contents</span></a><span> </span><a href="#local-6989586621679080319"><span class="hs-identifier hs-type">m0</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">~</span><span> </span><a href="#local-6989586621679080321"><span class="hs-identifier hs-type">inM0</span></a><span>
</span><a name="line-180"></a><span>      </span><span class="hs-special">,</span><span> </span><a href="TorXakis.Compiler.MapsTo.html#In"><span class="hs-identifier hs-type">In</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679080317"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679080318"><span class="hs-identifier hs-type">v</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="TorXakis.Compiler.MapsTo.html#Contents"><span class="hs-identifier hs-type">Contents</span></a><span> </span><a href="#local-6989586621679080320"><span class="hs-identifier hs-type">m1</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">~</span><span> </span><a href="#local-6989586621679080322"><span class="hs-identifier hs-type">inM1</span></a><span>
</span><a name="line-181"></a><span>      </span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679080321"><span class="hs-identifier hs-type">inM0</span></a><span> </span><span class="hs-operator">||</span><span> </span><a href="#local-6989586621679080322"><span class="hs-identifier hs-type">inM1</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">~</span><span> </span><span class="hs-special">'</span><span class="hs-identifier hs-type">True</span><span>
</span><a name="line-182"></a><span>      </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a name="PairMapsTo"><a href="TorXakis.Compiler.MapsTo.html#PairMapsTo"><span class="hs-identifier">PairMapsTo</span></a></a><span> </span><a name="local-6989586621679080317"><a href="#local-6989586621679080317"><span class="hs-identifier">k</span></a></a><span> </span><a name="local-6989586621679080318"><a href="#local-6989586621679080318"><span class="hs-identifier">v</span></a></a><span> </span><a name="local-6989586621679080319"><a href="#local-6989586621679080319"><span class="hs-identifier">m0</span></a></a><span> </span><a name="local-6989586621679080320"><a href="#local-6989586621679080320"><span class="hs-identifier">m1</span></a></a><span> </span><a name="local-6989586621679080321"><a href="#local-6989586621679080321"><span class="hs-identifier">inM0</span></a></a><span> </span><a name="local-6989586621679080322"><a href="#local-6989586621679080322"><span class="hs-identifier">inM1</span></a></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-183"></a><span>    </span><span class="hs-identifier">lookupPair</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679080317"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Show</span><span> </span><a href="#local-6989586621679080317"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Typeable</span><span> </span><a href="#local-6989586621679080317"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Typeable</span><span> </span><a href="#local-6989586621679080318"><span class="hs-identifier hs-type">v</span></a><span class="hs-special">)</span><span>
</span><a name="line-184"></a><span>               </span><span class="hs-glyph">=&gt;</span><span> </span><a href="#local-6989586621679080317"><span class="hs-identifier hs-type">k</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679080319"><span class="hs-identifier hs-type">m0</span></a><span> </span><span class="hs-operator">:&amp;</span><span> </span><a href="#local-6989586621679080320"><span class="hs-identifier hs-type">m1</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Either</span><span> </span><a href="TorXakis.Compiler.Error.html#Error"><span class="hs-identifier hs-type">Error</span></a><span> </span><a href="#local-6989586621679080318"><span class="hs-identifier hs-type">v</span></a><span>
</span><a name="line-185"></a><span>    </span><span class="hs-identifier">innerMapPair</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679080319"><span class="hs-identifier hs-type">m0</span></a><span> </span><span class="hs-operator">:&amp;</span><span> </span><a href="#local-6989586621679080320"><span class="hs-identifier hs-type">m1</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Map</span><span> </span><a href="#local-6989586621679080317"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-6989586621679080318"><span class="hs-identifier hs-type">v</span></a><span>
</span><a name="line-186"></a><span>    </span><span class="hs-identifier">addMapPair</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679080317"><span class="hs-identifier hs-type">k</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Map</span><span> </span><a href="#local-6989586621679080317"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-6989586621679080318"><span class="hs-identifier hs-type">v</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679080319"><span class="hs-identifier hs-type">m0</span></a><span> </span><span class="hs-operator">:&amp;</span><span> </span><a href="#local-6989586621679080320"><span class="hs-identifier hs-type">m1</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679080319"><span class="hs-identifier hs-type">m0</span></a><span> </span><span class="hs-operator">:&amp;</span><span> </span><a href="#local-6989586621679080320"><span class="hs-identifier hs-type">m1</span></a><span>
</span><a name="line-187"></a><span>    </span><span class="hs-identifier">replaceInnerMapPair</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679080319"><span class="hs-identifier hs-type">m0</span></a><span> </span><span class="hs-operator">:&amp;</span><span> </span><a href="#local-6989586621679080320"><span class="hs-identifier hs-type">m1</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Map</span><span> </span><a href="#local-6989586621679080317"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-6989586621679080318"><span class="hs-identifier hs-type">v</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679080319"><span class="hs-identifier hs-type">m0</span></a><span> </span><span class="hs-operator">:&amp;</span><span> </span><a href="#local-6989586621679080320"><span class="hs-identifier hs-type">m1</span></a><span>
</span><a name="line-188"></a><span>
</span><a name="line-189"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span> </span><a href="TorXakis.Compiler.MapsTo.html#MapsTo"><span class="hs-identifier hs-type">MapsTo</span></a><span> </span><a href="#local-6989586621679081907"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-6989586621679081908"><span class="hs-identifier hs-type">v</span></a><span> </span><a href="#local-6989586621679081909"><span class="hs-identifier hs-type">m0</span></a><span class="hs-special">,</span><span> </span><a href="TorXakis.Compiler.MapsTo.html#In"><span class="hs-identifier hs-type">In</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679081907"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679081908"><span class="hs-identifier hs-type">v</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="TorXakis.Compiler.MapsTo.html#Contents"><span class="hs-identifier hs-type">Contents</span></a><span> </span><a href="#local-6989586621679081910"><span class="hs-identifier hs-type">m1</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">~</span><span> </span><span class="hs-special">'</span><span class="hs-identifier hs-type">False</span><span>
</span><a name="line-190"></a><span>         </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="TorXakis.Compiler.MapsTo.html#PairMapsTo"><span class="hs-identifier hs-type">PairMapsTo</span></a><span> </span><a href="#local-6989586621679081907"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-6989586621679081908"><span class="hs-identifier hs-type">v</span></a><span> </span><a href="#local-6989586621679081909"><span class="hs-identifier hs-type">m0</span></a><span> </span><a href="#local-6989586621679081910"><span class="hs-identifier hs-type">m1</span></a><span> </span><span class="hs-special">'</span><span class="hs-identifier hs-type">True</span><span> </span><span class="hs-special">'</span><span class="hs-identifier hs-type">False</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-191"></a><span>    </span><a name="local-8214565720323855205"><a href="TorXakis.Compiler.MapsTo.html#lookupPair"><span class="hs-identifier">lookupPair</span></a></a><span> </span><a name="local-6989586621679081911"><a href="#local-6989586621679081911"><span class="hs-identifier">k</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679081912"><a href="#local-6989586621679081912"><span class="hs-identifier">m0</span></a></a><span> </span><a href="TorXakis.Compiler.MapsTo.html#%3A%26"><span class="hs-operator hs-var">:&amp;</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><a href="TorXakis.Compiler.MapsTo.html#lookup"><span class="hs-identifier hs-var">lookup</span></a><span> </span><a href="#local-6989586621679081911"><span class="hs-identifier hs-var">k</span></a><span> </span><a href="#local-6989586621679081912"><span class="hs-identifier hs-var">m0</span></a><span>
</span><a name="line-192"></a><span>    </span><a name="local-8214565720323855206"><a href="TorXakis.Compiler.MapsTo.html#innerMapPair"><span class="hs-identifier">innerMapPair</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679081913"><a href="#local-6989586621679081913"><span class="hs-identifier">m0</span></a></a><span> </span><a href="TorXakis.Compiler.MapsTo.html#%3A%26"><span class="hs-operator hs-var">:&amp;</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><a href="TorXakis.Compiler.MapsTo.html#innerMap"><span class="hs-identifier hs-var">innerMap</span></a><span> </span><a href="#local-6989586621679081913"><span class="hs-identifier hs-var">m0</span></a><span>
</span><a name="line-193"></a><span>    </span><a name="local-8214565720323855207"><a href="TorXakis.Compiler.MapsTo.html#addMapPair"><span class="hs-identifier">addMapPair</span></a></a><span> </span><a name="local-6989586621679081914"><a href="#local-6989586621679081914"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679081915"><a href="#local-6989586621679081915"><span class="hs-identifier">m0</span></a></a><span> </span><a href="TorXakis.Compiler.MapsTo.html#%3A%26"><span class="hs-operator hs-var">:&amp;</span></a><span> </span><a name="local-6989586621679081916"><a href="#local-6989586621679081916"><span class="hs-identifier">m1</span></a></a><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679081914"><span class="hs-identifier hs-var">m</span></a><span> </span><a href="TorXakis.Compiler.MapsTo.html#%3C.%2B%3E"><span class="hs-operator hs-var">&lt;.+&gt;</span></a><span> </span><a href="#local-6989586621679081915"><span class="hs-identifier hs-var">m0</span></a><span class="hs-special">)</span><span> </span><a href="TorXakis.Compiler.MapsTo.html#%3A%26"><span class="hs-operator hs-var">:&amp;</span></a><span> </span><a href="#local-6989586621679081916"><span class="hs-identifier hs-var">m1</span></a><span>
</span><a name="line-194"></a><span>    </span><a name="local-8214565720323855208"><a href="TorXakis.Compiler.MapsTo.html#replaceInnerMapPair"><span class="hs-identifier">replaceInnerMapPair</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679081917"><a href="#local-6989586621679081917"><span class="hs-identifier">m0</span></a></a><span> </span><a href="TorXakis.Compiler.MapsTo.html#%3A%26"><span class="hs-operator hs-var">:&amp;</span></a><span> </span><a name="local-6989586621679081918"><a href="#local-6989586621679081918"><span class="hs-identifier">m1</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679081919"><a href="#local-6989586621679081919"><span class="hs-identifier">new</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TorXakis.Compiler.MapsTo.html#replaceInnerMap"><span class="hs-identifier hs-var">replaceInnerMap</span></a><span> </span><a href="#local-6989586621679081917"><span class="hs-identifier hs-var">m0</span></a><span> </span><a href="#local-6989586621679081919"><span class="hs-identifier hs-var">new</span></a><span> </span><a href="TorXakis.Compiler.MapsTo.html#%3A%26"><span class="hs-operator hs-var">:&amp;</span></a><span> </span><a href="#local-6989586621679081918"><span class="hs-identifier hs-var">m1</span></a><span>
</span><a name="line-195"></a><span>
</span><a name="line-196"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span> </span><a href="TorXakis.Compiler.MapsTo.html#In"><span class="hs-identifier hs-type">In</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679081894"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679081895"><span class="hs-identifier hs-type">v</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="TorXakis.Compiler.MapsTo.html#Contents"><span class="hs-identifier hs-type">Contents</span></a><span> </span><a href="#local-6989586621679081896"><span class="hs-identifier hs-type">m0</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">~</span><span> </span><span class="hs-special">'</span><span class="hs-identifier hs-type">False</span><span class="hs-special">,</span><span> </span><a href="TorXakis.Compiler.MapsTo.html#MapsTo"><span class="hs-identifier hs-type">MapsTo</span></a><span> </span><a href="#local-6989586621679081894"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-6989586621679081895"><span class="hs-identifier hs-type">v</span></a><span> </span><a href="#local-6989586621679081897"><span class="hs-identifier hs-type">m1</span></a><span>
</span><a name="line-197"></a><span>         </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="TorXakis.Compiler.MapsTo.html#PairMapsTo"><span class="hs-identifier hs-type">PairMapsTo</span></a><span> </span><a href="#local-6989586621679081894"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-6989586621679081895"><span class="hs-identifier hs-type">v</span></a><span> </span><a href="#local-6989586621679081896"><span class="hs-identifier hs-type">m0</span></a><span> </span><a href="#local-6989586621679081897"><span class="hs-identifier hs-type">m1</span></a><span> </span><span class="hs-special">'</span><span class="hs-identifier hs-type">False</span><span> </span><span class="hs-special">'</span><span class="hs-identifier hs-type">True</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-198"></a><span>    </span><a name="local-8214565720323855205"><a href="TorXakis.Compiler.MapsTo.html#lookupPair"><span class="hs-identifier">lookupPair</span></a></a><span> </span><a name="local-6989586621679081898"><a href="#local-6989586621679081898"><span class="hs-identifier">k</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span> </span><a href="TorXakis.Compiler.MapsTo.html#%3A%26"><span class="hs-operator hs-var">:&amp;</span></a><span> </span><a name="local-6989586621679081899"><a href="#local-6989586621679081899"><span class="hs-identifier">m1</span></a></a><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><a href="TorXakis.Compiler.MapsTo.html#lookup"><span class="hs-identifier hs-var">lookup</span></a><span> </span><a href="#local-6989586621679081898"><span class="hs-identifier hs-var">k</span></a><span> </span><a href="#local-6989586621679081899"><span class="hs-identifier hs-var">m1</span></a><span>
</span><a name="line-199"></a><span>    </span><a name="local-8214565720323855206"><a href="TorXakis.Compiler.MapsTo.html#innerMapPair"><span class="hs-identifier">innerMapPair</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span> </span><a href="TorXakis.Compiler.MapsTo.html#%3A%26"><span class="hs-operator hs-var">:&amp;</span></a><span> </span><a name="local-6989586621679081900"><a href="#local-6989586621679081900"><span class="hs-identifier">m1</span></a></a><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><a href="TorXakis.Compiler.MapsTo.html#innerMap"><span class="hs-identifier hs-var">innerMap</span></a><span> </span><a href="#local-6989586621679081900"><span class="hs-identifier hs-var">m1</span></a><span>
</span><a name="line-200"></a><span>    </span><a name="local-8214565720323855207"><a href="TorXakis.Compiler.MapsTo.html#addMapPair"><span class="hs-identifier">addMapPair</span></a></a><span> </span><a name="local-6989586621679081901"><a href="#local-6989586621679081901"><span class="hs-identifier">m</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679081902"><a href="#local-6989586621679081902"><span class="hs-identifier">m0</span></a></a><span> </span><a href="TorXakis.Compiler.MapsTo.html#%3A%26"><span class="hs-operator hs-var">:&amp;</span></a><span> </span><a name="local-6989586621679081903"><a href="#local-6989586621679081903"><span class="hs-identifier">m1</span></a></a><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679081902"><span class="hs-identifier hs-var">m0</span></a><span> </span><a href="TorXakis.Compiler.MapsTo.html#%3A%26"><span class="hs-operator hs-var">:&amp;</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679081901"><span class="hs-identifier hs-var">m</span></a><span> </span><a href="TorXakis.Compiler.MapsTo.html#%3C.%2B%3E"><span class="hs-operator hs-var">&lt;.+&gt;</span></a><span> </span><a href="#local-6989586621679081903"><span class="hs-identifier hs-var">m1</span></a><span class="hs-special">)</span><span>
</span><a name="line-201"></a><span>    </span><a name="local-8214565720323855208"><a href="TorXakis.Compiler.MapsTo.html#replaceInnerMapPair"><span class="hs-identifier">replaceInnerMapPair</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679081904"><a href="#local-6989586621679081904"><span class="hs-identifier">m0</span></a></a><span> </span><a href="TorXakis.Compiler.MapsTo.html#%3A%26"><span class="hs-operator hs-var">:&amp;</span></a><span> </span><a name="local-6989586621679081905"><a href="#local-6989586621679081905"><span class="hs-identifier">m1</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679081906"><a href="#local-6989586621679081906"><span class="hs-identifier">new</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679081904"><span class="hs-identifier hs-var">m0</span></a><span> </span><a href="TorXakis.Compiler.MapsTo.html#%3A%26"><span class="hs-operator hs-var">:&amp;</span></a><span> </span><a href="TorXakis.Compiler.MapsTo.html#replaceInnerMap"><span class="hs-identifier hs-var">replaceInnerMap</span></a><span> </span><a href="#local-6989586621679081905"><span class="hs-identifier hs-var">m1</span></a><span> </span><a href="#local-6989586621679081906"><span class="hs-identifier hs-var">new</span></a><span>
</span><a name="line-202"></a><span>
</span><a name="line-203"></a><span class="hs-keyword">instance</span><span> </span><a href="TorXakis.Compiler.MapsTo.html#PairMapsTo"><span class="hs-identifier hs-type">PairMapsTo</span></a><span> </span><a href="#local-6989586621679081888"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-6989586621679081889"><span class="hs-identifier hs-type">v</span></a><span> </span><a href="#local-6989586621679081890"><span class="hs-identifier hs-type">m0</span></a><span> </span><a href="#local-6989586621679081891"><span class="hs-identifier hs-type">m1</span></a><span> </span><a href="#local-6989586621679081892"><span class="hs-identifier hs-type">inM0</span></a><span> </span><a href="#local-6989586621679081893"><span class="hs-identifier hs-type">inM1</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="TorXakis.Compiler.MapsTo.html#MapsTo"><span class="hs-identifier hs-type">MapsTo</span></a><span> </span><a href="#local-6989586621679081888"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-6989586621679081889"><span class="hs-identifier hs-type">v</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679081890"><span class="hs-identifier hs-type">m0</span></a><span> </span><span class="hs-operator">:&amp;</span><span> </span><a href="#local-6989586621679081891"><span class="hs-identifier hs-type">m1</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-204"></a><span>    </span><a name="local-8214565720323855218"><a href="TorXakis.Compiler.MapsTo.html#lookup"><span class="hs-identifier">lookup</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TorXakis.Compiler.MapsTo.html#lookupPair"><span class="hs-identifier hs-var">lookupPair</span></a><span>
</span><a name="line-205"></a><span>    </span><a name="local-8214565720323855220"><a href="TorXakis.Compiler.MapsTo.html#innerMap"><span class="hs-identifier">innerMap</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TorXakis.Compiler.MapsTo.html#innerMapPair"><span class="hs-identifier hs-var">innerMapPair</span></a><span>
</span><a name="line-206"></a><span>    </span><span class="hs-special">(</span><a name="local-8214565720323855221"><a href="TorXakis.Compiler.MapsTo.html#%3C.%2B%3E"><span class="hs-operator">&lt;.+&gt;</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="TorXakis.Compiler.MapsTo.html#addMapPair"><span class="hs-identifier hs-var">addMapPair</span></a><span>
</span><a name="line-207"></a><span>    </span><a name="local-8214565720323855222"><a href="TorXakis.Compiler.MapsTo.html#replaceInnerMap"><span class="hs-identifier">replaceInnerMap</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="TorXakis.Compiler.MapsTo.html#replaceInnerMapPair"><span class="hs-identifier hs-var">replaceInnerMapPair</span></a><span>
</span><a name="line-208"></a><span>
</span><a name="line-209"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-type">TypeError</span><span> </span><span class="hs-special">(</span><span>      </span><span class="hs-special">'</span><span class="hs-identifier hs-type">Text</span><span> </span><span class="hs-string">&quot;No map found: \&quot;&quot;</span><span>
</span><a name="line-210"></a><span>                      </span><span class="hs-special">'</span><span class="hs-operator">:&lt;&gt;:</span><span> </span><span class="hs-special">'</span><span class="hs-identifier hs-type">ShowType</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679081884"><span class="hs-identifier hs-type">m0</span></a><span> </span><span class="hs-operator">:&amp;</span><span> </span><a href="#local-6989586621679081885"><span class="hs-identifier hs-type">m1</span></a><span class="hs-special">)</span><span>
</span><a name="line-211"></a><span>                      </span><span class="hs-special">'</span><span class="hs-operator">:&lt;&gt;:</span><span> </span><span class="hs-special">'</span><span class="hs-identifier hs-type">Text</span><span> </span><span class="hs-string">&quot;\&quot; does not contain a map from &quot;</span><span>
</span><a name="line-212"></a><span>                      </span><span class="hs-special">'</span><span class="hs-operator">:&lt;&gt;:</span><span> </span><span class="hs-special">'</span><span class="hs-identifier hs-type">ShowType</span><span> </span><a href="#local-6989586621679081886"><span class="hs-identifier hs-type">k</span></a><span>
</span><a name="line-213"></a><span>                      </span><span class="hs-special">'</span><span class="hs-operator">:&lt;&gt;:</span><span> </span><span class="hs-special">'</span><span class="hs-identifier hs-type">Text</span><span> </span><span class="hs-string">&quot; to &quot;</span><span>
</span><a name="line-214"></a><span>                      </span><span class="hs-special">'</span><span class="hs-operator">:&lt;&gt;:</span><span> </span><span class="hs-special">'</span><span class="hs-identifier hs-type">ShowType</span><span> </span><a href="#local-6989586621679081887"><span class="hs-identifier hs-type">v</span></a><span>
</span><a name="line-215"></a><span>                     </span><span class="hs-special">)</span><span>
</span><a name="line-216"></a><span>         </span><span class="hs-special">,</span><span> </span><a href="TorXakis.Compiler.MapsTo.html#In"><span class="hs-identifier hs-type">In</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679081886"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679081887"><span class="hs-identifier hs-type">v</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="TorXakis.Compiler.MapsTo.html#Contents"><span class="hs-identifier hs-type">Contents</span></a><span> </span><a href="#local-6989586621679081884"><span class="hs-identifier hs-type">m0</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">~</span><span> </span><span class="hs-special">'</span><span class="hs-identifier hs-type">False</span><span>
</span><a name="line-217"></a><span>         </span><span class="hs-special">,</span><span> </span><a href="TorXakis.Compiler.MapsTo.html#In"><span class="hs-identifier hs-type">In</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679081886"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679081887"><span class="hs-identifier hs-type">v</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="TorXakis.Compiler.MapsTo.html#Contents"><span class="hs-identifier hs-type">Contents</span></a><span> </span><a href="#local-6989586621679081885"><span class="hs-identifier hs-type">m1</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">~</span><span> </span><span class="hs-special">'</span><span class="hs-identifier hs-type">False</span><span>
</span><a name="line-218"></a><span>         </span><span class="hs-special">,</span><span> </span><span class="hs-special">'</span><span class="hs-identifier hs-type">False</span><span> </span><span class="hs-glyph">~</span><span> </span><span class="hs-special">'</span><span class="hs-identifier hs-type">True</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-219"></a><span>         </span><span class="hs-glyph">=&gt;</span><span> </span><a href="TorXakis.Compiler.MapsTo.html#PairMapsTo"><span class="hs-identifier hs-type">PairMapsTo</span></a><span> </span><a href="#local-6989586621679081886"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-6989586621679081887"><span class="hs-identifier hs-type">v</span></a><span> </span><a href="#local-6989586621679081884"><span class="hs-identifier hs-type">m0</span></a><span> </span><a href="#local-6989586621679081885"><span class="hs-identifier hs-type">m1</span></a><span> </span><span class="hs-special">'</span><span class="hs-identifier hs-type">False</span><span> </span><span class="hs-special">'</span><span class="hs-identifier hs-type">False</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-220"></a><span>    </span><a name="local-8214565720323855205"><a href="TorXakis.Compiler.MapsTo.html#lookupPair"><span class="hs-identifier">lookupPair</span></a></a><span>          </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">undefined</span><span>
</span><a name="line-221"></a><span>    </span><a name="local-8214565720323855206"><a href="TorXakis.Compiler.MapsTo.html#innerMapPair"><span class="hs-identifier">innerMapPair</span></a></a><span>        </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">undefined</span><span>
</span><a name="line-222"></a><span>    </span><a name="local-8214565720323855207"><a href="TorXakis.Compiler.MapsTo.html#addMapPair"><span class="hs-identifier">addMapPair</span></a></a><span>          </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">undefined</span><span>
</span><a name="line-223"></a><span>    </span><a name="local-8214565720323855208"><a href="TorXakis.Compiler.MapsTo.html#replaceInnerMapPair"><span class="hs-identifier">replaceInnerMapPair</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span>  </span><span class="hs-identifier hs-var">undefined</span><span>
</span><a name="line-224"></a><span>
</span><a name="line-225"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-type">TypeError</span><span> </span><span class="hs-special">(</span><span>     </span><span class="hs-special">'</span><span class="hs-identifier hs-type">Text</span><span> </span><span class="hs-string">&quot;Map is not unique: \&quot;&quot;</span><span>
</span><a name="line-226"></a><span>                      </span><span class="hs-special">'</span><span class="hs-operator">:&lt;&gt;:</span><span> </span><span class="hs-special">'</span><span class="hs-identifier hs-type">ShowType</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679081866"><span class="hs-identifier hs-type">m0</span></a><span> </span><span class="hs-operator">:&amp;</span><span> </span><a href="#local-6989586621679081867"><span class="hs-identifier hs-type">m1</span></a><span class="hs-special">)</span><span>
</span><a name="line-227"></a><span>                      </span><span class="hs-special">'</span><span class="hs-operator">:&lt;&gt;:</span><span> </span><span class="hs-special">'</span><span class="hs-identifier hs-type">Text</span><span> </span><span class="hs-string">&quot;\&quot; contains more than a map from &quot;</span><span>
</span><a name="line-228"></a><span>                      </span><span class="hs-special">'</span><span class="hs-operator">:&lt;&gt;:</span><span> </span><span class="hs-special">'</span><span class="hs-identifier hs-type">ShowType</span><span> </span><a href="#local-6989586621679081868"><span class="hs-identifier hs-type">k</span></a><span>
</span><a name="line-229"></a><span>                      </span><span class="hs-special">'</span><span class="hs-operator">:&lt;&gt;:</span><span> </span><span class="hs-special">'</span><span class="hs-identifier hs-type">Text</span><span> </span><span class="hs-string">&quot; to &quot;</span><span>
</span><a name="line-230"></a><span>                      </span><span class="hs-special">'</span><span class="hs-operator">:&lt;&gt;:</span><span> </span><span class="hs-special">'</span><span class="hs-identifier hs-type">ShowType</span><span> </span><a href="#local-6989586621679081869"><span class="hs-identifier hs-type">v</span></a><span>
</span><a name="line-231"></a><span>                     </span><span class="hs-special">)</span><span>
</span><a name="line-232"></a><span>         </span><span class="hs-special">,</span><span> </span><a href="TorXakis.Compiler.MapsTo.html#In"><span class="hs-identifier hs-type">In</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679081868"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679081869"><span class="hs-identifier hs-type">v</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="TorXakis.Compiler.MapsTo.html#Contents"><span class="hs-identifier hs-type">Contents</span></a><span> </span><a href="#local-6989586621679081866"><span class="hs-identifier hs-type">m0</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">~</span><span> </span><span class="hs-special">'</span><span class="hs-identifier hs-type">True</span><span>
</span><a name="line-233"></a><span>         </span><span class="hs-special">,</span><span> </span><a href="TorXakis.Compiler.MapsTo.html#In"><span class="hs-identifier hs-type">In</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679081868"><span class="hs-identifier hs-type">k</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679081869"><span class="hs-identifier hs-type">v</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="TorXakis.Compiler.MapsTo.html#Contents"><span class="hs-identifier hs-type">Contents</span></a><span> </span><a href="#local-6989586621679081867"><span class="hs-identifier hs-type">m1</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">~</span><span> </span><span class="hs-special">'</span><span class="hs-identifier hs-type">True</span><span>
</span><a name="line-234"></a><span>         </span><span class="hs-special">)</span><span>
</span><a name="line-235"></a><span>         </span><span class="hs-glyph">=&gt;</span><span> </span><a href="TorXakis.Compiler.MapsTo.html#PairMapsTo"><span class="hs-identifier hs-type">PairMapsTo</span></a><span> </span><a href="#local-6989586621679081868"><span class="hs-identifier hs-type">k</span></a><span> </span><a href="#local-6989586621679081869"><span class="hs-identifier hs-type">v</span></a><span> </span><a href="#local-6989586621679081866"><span class="hs-identifier hs-type">m0</span></a><span> </span><a href="#local-6989586621679081867"><span class="hs-identifier hs-type">m1</span></a><span> </span><span class="hs-special">'</span><span class="hs-identifier hs-type">True</span><span> </span><span class="hs-special">'</span><span class="hs-identifier hs-type">True</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-236"></a><span>    </span><a name="local-8214565720323855205"><a href="TorXakis.Compiler.MapsTo.html#lookupPair"><span class="hs-identifier">lookupPair</span></a></a><span>          </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">undefined</span><span>
</span><a name="line-237"></a><span>    </span><a name="local-8214565720323855206"><a href="TorXakis.Compiler.MapsTo.html#innerMapPair"><span class="hs-identifier">innerMapPair</span></a></a><span>        </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">undefined</span><span>
</span><a name="line-238"></a><span>    </span><a name="local-8214565720323855207"><a href="TorXakis.Compiler.MapsTo.html#addMapPair"><span class="hs-identifier">addMapPair</span></a></a><span>          </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">undefined</span><span>
</span><a name="line-239"></a><span>    </span><a name="local-8214565720323855208"><a href="TorXakis.Compiler.MapsTo.html#replaceInnerMapPair"><span class="hs-identifier">replaceInnerMapPair</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span>  </span><span class="hs-identifier hs-var">undefined</span><span>
</span><a name="line-240"></a></pre></body></html>